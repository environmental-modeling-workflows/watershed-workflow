
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Complete Workflow for generating ATS input for Coweeta &#8212; Watershed Workflow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/custom_theme.css" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/coweeta_ats';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/environmental-modeling-workflows/watershed-workflow/master/docs/source/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v2.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="../_static/main.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Installation and Setup" href="../install.html" />
    <link rel="prev" title="Mixed-Element Mesh for the Coweeta Watershed" href="coweeta_stream_aligned_mesh.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Watershed Workflow</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../concepts.html">
    Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Documentation
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../gallery.html">
    Gallery
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../intro.html">
    Introduction
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../concepts.html">
    Concepts
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../gallery.html">
    Gallery
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><!-- This will display the version of the docs -->
Version dev</div>
        <div class="sidebar-primary-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="toy_problem_stream_aligned_mesh.html">Mixed-element Meshing - Toy Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison_of_soil_structure.html">Soil Structural Data Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_AORC_met_data.html">AORC Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_MODIS_LAI.html">Working with MODIS for Land Cover and LAI data</a></li>
<li class="toctree-l1"><a class="reference internal" href="coweeta_stream_aligned_mesh.html">Mixed-Element Mesh for the Coweeta Watershed</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Complete Workflow for generating ATS input for Coweeta</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#input-parameters-and-other-source-data">Input: Parameters and other source data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basin-geometry">Basin Geometry</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-watershed">the Watershed</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-rivers">the Rivers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mesh-geometry">Mesh Geometry</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#surface-properties">Surface properties</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nlcd-for-lulc">NLCD for LULC</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modis-lai">MODIS LAI</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#crosswalk-of-lai-to-nlcd-lc">Crosswalk of LAI to NLCD LC</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subsurface-soil-geologic-structure">Subsurface Soil, Geologic Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nrcs-soils">NRCS Soils</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#depth-to-bedrock-from-soilgrids">Depth to Bedrock from SoilGrids</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#glhymps-geology">GLHYMPs Geology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#combine-to-form-a-complete-subsurface-dataset">Combine to form a complete subsurface dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extrude-the-2d-mesh-to-make-a-3d-mesh">Extrude the 2D Mesh to make a 3D mesh</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#meteorological-forcing-dataset">Meteorological forcing dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#write-ats-input-files">Write ATS input files</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#completion-and-summary">Completion and Summary</a></li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../examples.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Complete Workflow for generating ATS input for Coweeta</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="complete-workflow-for-generating-ats-input-for-coweeta">
<h1>Complete Workflow for generating ATS input for Coweeta<a class="headerlink" href="#complete-workflow-for-generating-ats-input-for-coweeta" title="Link to this heading">#</a></h1>
<p>This workflow provides a complete working example to develop a simulation campaign for integrated hydrology within ATS.</p>
<p>It uses the following datasets:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NHD</span> <span class="pre">Plus</span></code> for hydrography.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3DEP</span></code> for elevation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NLCD</span></code> for land cover/transpiration/rooting depths</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MODIS</span></code> for LAI</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GLYHMPS</span></code> geology data for structural formations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Pelletier</span></code> for depth to bedrock and soil texture information</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SSURGO</span></code> for soil data, where available, in the top 2m.</p></li>
</ul>
<p>Given some basic inputs (in the next cell) including a NAME, this workflow creates the following files, all of which will reside in output_data:</p>
<ul class="simple">
<li><p>Mesh file: <code class="docutils literal notranslate"><span class="pre">Coweeta.exo</span></code>, includes all labeled sets</p></li>
<li><p>Forcing: DayMet data – daily raster of precip, RH, incoming radiation, etc.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_daymet_2010_2011.h5</span></code>, the DayMet data on this watershed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_daymet_CyclicSteadystate.h5</span></code>, a “typical year” of DayMet, smoothed for spinup purposes, then looped certain number of years</p></li>
</ul>
</li>
<li><p>Forcing: LAI data – every 4 days, time series by land cover type of LAI.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_LAI_MODIS_transient.h5</span></code>, the LAI, interpolated and smoothed from the raw MODIS data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_LAI_MODIS_CyclicSteadystate.h5</span></code>, a “typical year” of LAI, smoothed for spinup purposes then looped 10 years</p></li>
</ul>
</li>
<li><p>ATS Input files for three runs, intended to be run sequentially:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_steadystate.xml</span></code> the steady-state solution based on uniform application of mean rainfall rate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_cyclic_steadystate.xml</span></code> the cyclic steady state based on typical years</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Coweeta_transient.xml</span></code> the forward model, run from 2010 – 2011</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># these can be turned on for development work</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## FIX ME -- why is this broken without importing netcdf first?</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">netCDF4</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># setting up logging first or else it gets preempted by another package</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.ui</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">ui</span><span class="o">.</span><span class="n">setup_logging</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">cm</span> <span class="k">as</span> <span class="n">pcm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shapely</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">gpd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cftime</span><span class="o">,</span><span class="w"> </span><span class="nn">datetime</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="kc">None</span>


<span class="c1">## provide paths to relevant packages for mesh and input file generation </span>
<span class="c1"># Set paths to relevant packages for mesh and input file generation</span>
<span class="c1"># Update these paths to match your local installation</span>
<span class="c1">#</span>
<span class="c1">#sys.path.append(&#39;/path/to/seacas/lib&#39;)</span>
<span class="c1">#%set_env AMANZI_SRC_DIR=/path/to/amanzi</span>
<span class="c1">#%set_env ATS_SRC_DIR=/path/to/amanzi/src/physics/ats</span>
<span class="c1">#sys.path.append(&#39;/path/to/amanzi/tools/amanzi_xml&#39;)</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow</span> 
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.config</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.sources</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.plot</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.mesh</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.regions</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.meteorology</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.land_cover_properties</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.resampling</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.condition</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.io</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">watershed_workflow.sources.standard_names</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">names</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ats_input_spec</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ats_input_spec.public</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ats_input_spec.io</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">amanzi_xml.utils.io</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">aio</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">amanzi_xml.utils.search</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">asearch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">amanzi_xml.utils.errors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">aerrors</span>

<span class="c1"># set the default figure size for notebooks</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="input-parameters-and-other-source-data">
<h2>Input: Parameters and other source data<a class="headerlink" href="#input-parameters-and-other-source-data" title="Link to this heading">#</a></h2>
<p>Note, this section will need to be modified for other runs of this workflow in other regions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Force Watershed Workflow to pull data from this directory rather than a shared data directory.</span>
<span class="c1"># This picks up the Coweeta-specific datasets set up here to avoid large file downloads for </span>
<span class="c1"># demonstration purposes.</span>
<span class="c1">#</span>
<span class="k">def</span><span class="w"> </span><span class="nf">splitPathFull</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Splits an absolute path into a list of components such that</span>
<span class="sd">    os.path.join(*splitPathFull(path)) == path</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">head</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="n">path</span><span class="p">:</span>  <span class="c1"># root on Unix or drive letter with backslash on Windows (e.g., C:\)</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">head</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">tail</span> <span class="o">==</span> <span class="n">path</span><span class="p">:</span>  <span class="c1"># just a single file or directory</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">parts</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="n">head</span>
    <span class="k">return</span> <span class="n">parts</span>

<span class="n">cwd</span> <span class="o">=</span> <span class="n">splitPathFull</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

<span class="c1"># REMOVE THIS PORTION OF THE CELL for general use outside of Coweeta -- this is just locating </span>
<span class="c1"># the working directory within the WW directory structure</span>
<span class="k">if</span> <span class="n">cwd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Coweeta&#39;</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">elif</span> <span class="n">cwd</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;examples&#39;</span><span class="p">:</span>
    <span class="n">cwd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Coweeta&#39;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">cwd</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">&#39;examples&#39;</span><span class="p">,</span><span class="s1">&#39;Coweeta&#39;</span><span class="p">])</span>
<span class="c1"># END REMOVE THIS PORTION</span>

<span class="c1"># Note, this directory is where downloaded data will be put as well</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">cwd</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;input_data&#39;</span><span class="p">,]))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">toInput</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">cwd</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;output_data&#39;</span><span class="p">,]))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">toOutput</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="n">work_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="o">*</span><span class="n">cwd</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">toWorkingDir</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
       
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the data directory to the local space to get the locally downloaded files</span>
<span class="c1"># REMOVE THIS CELL for general use outside fo Coweeta</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setDataDirectory</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Parameters cell -- this provides all parameters that can be changed via pipelining to generate a new watershed. </span>
<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Coweeta&#39;</span>
<span class="n">coweeta_shapefile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;input_data&#39;</span><span class="p">,</span> <span class="s1">&#39;coweeta_basin.shp&#39;</span><span class="p">)</span>

<span class="c1"># Geometric parameters</span>
<span class="c1"># -- parameters to clean and reduce the river network prior to meshing</span>
<span class="n">simplify</span> <span class="o">=</span> <span class="mi">60</span>                   <span class="c1"># length scale to target average edge </span>
<span class="n">ignore_small_rivers</span> <span class="o">=</span> <span class="mi">2</span>         <span class="c1"># remove rivers with fewer than this number of reaches -- important for NHDPlus HR </span>
<span class="n">prune_by_area_fraction</span> <span class="o">=</span> <span class="mf">0.01</span>   <span class="c1"># prune any reaches whose contributing area is less than this fraction of the domain</span>

<span class="c1"># -- mesh triangle refinement control</span>
<span class="n">refine_d0</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">refine_d1</span> <span class="o">=</span> <span class="mi">600</span>

<span class="c1">#refine_L0 = 75</span>
<span class="c1">#refine_L1 = 200</span>

<span class="n">refine_L0</span> <span class="o">=</span> <span class="mi">125</span>
<span class="n">refine_L1</span> <span class="o">=</span> <span class="mi">300</span>

<span class="n">refine_A0</span> <span class="o">=</span> <span class="n">refine_L0</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">refine_A1</span> <span class="o">=</span> <span class="n">refine_L1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>

<span class="c1"># Simulation control</span>
<span class="c1"># - note that we use the NoLeap calendar, same as DayMet.  Simulations are typically run over the &quot;water year&quot;</span>
<span class="c1">#   which starts August 1.</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeNoLeap</span><span class="p">(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">end</span> <span class="o">=</span> <span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeNoLeap</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nyears_cyclic_steadystate</span> <span class="o">=</span> <span class="mi">4</span>   <span class="c1"># how many years to run spinup</span>

<span class="c1"># Global Soil Properties</span>
<span class="n">min_porosity</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># minimum porosity considered &quot;too small&quot;</span>
<span class="n">max_permeability</span> <span class="o">=</span> <span class="mf">1.e-10</span> <span class="c1"># max value considered &quot;too permeable&quot;</span>
<span class="n">max_vg_alpha</span> <span class="o">=</span> <span class="mf">1.e-3</span> <span class="c1"># max value of van Genuchten&#39;s alpha -- our correlation is not valid for some soils</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># a dictionary of output_filenames -- will include all filenames generated</span>
<span class="n">output_filenames</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that, by default, we tend to work in the DayMet CRS because this allows us to avoid</span>
<span class="c1"># reprojecting meteorological forcing datasets.</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">default_crs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the shape and crs of the shape</span>
<span class="n">coweeta_source</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">ManagerShapefile</span><span class="p">(</span><span class="n">coweeta_shapefile</span><span class="p">)</span>
<span class="n">coweeta</span> <span class="o">=</span> <span class="n">coweeta_source</span><span class="o">.</span><span class="n">getShapes</span><span class="p">(</span><span class="n">out_crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">coweeta</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;AREA&#39;</span> <span class="p">:</span> <span class="n">names</span><span class="o">.</span><span class="n">AREA</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,176 - root - INFO: fixing column: geometry
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up a dictionary of source objects</span>
<span class="c1">#</span>
<span class="c1"># Data sources, also called managers, deal with downloading and parsing data files from a variety of online APIs.</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">getDefaultSources</span><span class="p">()</span>
<span class="n">sources</span><span class="p">[</span><span class="s1">&#39;hydrography&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">hydrography_sources</span><span class="p">[</span><span class="s1">&#39;NHDPlus HR&#39;</span><span class="p">]</span>

<span class="c1">#</span>
<span class="c1"># This demo uses a few datasets that have been clipped out of larger, national</span>
<span class="c1"># datasets and are distributed with the code.  This is simply to save download</span>
<span class="c1"># time for this simple problem and to lower the barrier for trying out</span>
<span class="c1"># Watershed Workflow.  A more typical workflow would delete these lines (as </span>
<span class="c1"># these files would not exist for other watersheds).</span>
<span class="c1">#</span>
<span class="c1"># The default versions of these download large raster and shapefile files that</span>
<span class="c1"># are defined over a very large region (globally or the entire US).</span>
<span class="c1">#</span>
<span class="c1"># DELETE THIS SECTION for non-Coweeta runs</span>
<span class="n">dtb_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;soil_structure&#39;</span><span class="p">,</span> <span class="s1">&#39;DTB&#39;</span><span class="p">,</span> <span class="s1">&#39;DTB.tif&#39;</span><span class="p">)</span>
<span class="n">geo_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;soil_structure&#39;</span><span class="p">,</span> <span class="s1">&#39;GLHYMPS&#39;</span><span class="p">,</span> <span class="s1">&#39;GLHYMPS.shp&#39;</span><span class="p">)</span>

<span class="c1"># GLHYMPs is a several-GB download, so we have sliced it and included the slice here</span>
<span class="n">sources</span><span class="p">[</span><span class="s1">&#39;geologic structure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">ManagerGLHYMPS</span><span class="p">(</span><span class="n">geo_file</span><span class="p">)</span>

<span class="c1"># The Pelletier DTB map is not particularly accurate at Coweeta -- the SoilGrids map seems to be better.</span>
<span class="c1"># Here we will use a clipped version of that map.</span>
<span class="n">sources</span><span class="p">[</span><span class="s1">&#39;depth to bedrock&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">ManagerRaster</span><span class="p">(</span><span class="n">dtb_file</span><span class="p">)</span>

<span class="c1"># END DELETE THIS SECTION</span>

<span class="c1"># log the sources that will be used here</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">sources</span><span class="o">.</span><span class="n">logSources</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,193 - root - INFO: Using sources:
2025-08-29 17:27:33,194 - root - INFO: --------------
2025-08-29 17:27:33,194 - root - INFO: HUC: WBD
2025-08-29 17:27:33,194 - root - INFO: hydrography: NHDPlus HR
2025-08-29 17:27:33,194 - root - INFO: DEM: 3DEP
2025-08-29 17:27:33,194 - root - INFO: soil structure: National Resources Conservation Service Soil Survey (NRCS Soils)
2025-08-29 17:27:33,195 - root - INFO: geologic structure: shapefile: &quot;GLHYMPS.shp&quot;
2025-08-29 17:27:33,195 - root - INFO: land cover: NLCD 2021 L48
2025-08-29 17:27:33,195 - root - INFO: LAI: MODIS
2025-08-29 17:27:33,195 - root - INFO: depth to bedrock: raster: &quot;DTB.tif&quot;
2025-08-29 17:27:33,195 - root - INFO: meteorology: AORC v1.1
</pre></div>
</div>
</div>
</div>
</section>
<section id="basin-geometry">
<h2>Basin Geometry<a class="headerlink" href="#basin-geometry" title="Link to this heading">#</a></h2>
<p>In this section, we choose the basin, the streams to be included in the stream-aligned mesh, and make sure that all are resolved discretely at appropriate length scales for this work.</p>
<section id="the-watershed">
<h3>the Watershed<a class="headerlink" href="#the-watershed" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construct and plot the WW object used for storing watersheds</span>
<span class="n">watershed</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">split_hucs</span><span class="o">.</span><span class="n">SplitHUCs</span><span class="p">(</span><span class="n">coweeta</span><span class="p">)</span>
<span class="n">watershed</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,207 - root - INFO: Removing holes on 1 polygons
2025-08-29 17:27:33,207 - root - INFO:   -- removed interior
2025-08-29 17:27:33,207 - root - INFO:   -- union
2025-08-29 17:27:33,208 - root - INFO: Parsing 1 components for holes
2025-08-29 17:27:33,208 - root - INFO:   -- complete
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="../_images/a43187047d477a49305c23ccc94f03ab231be9ba68353da354c86de6e8276286.png" src="../_images/a43187047d477a49305c23ccc94f03ab231be9ba68353da354c86de6e8276286.png" />
</div>
</div>
</section>
<section id="the-rivers">
<h3>the Rivers<a class="headerlink" href="#the-rivers" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download/collect the river network within that shape&#39;s bounds</span>
<span class="n">reaches</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;hydrography&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getShapesByGeometry</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">out_crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">rivers</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">river_tree</span><span class="o">.</span><span class="n">createRivers</span><span class="p">(</span><span class="n">reaches</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;hydroseq&#39;</span><span class="p">)</span>

<span class="n">watershed_orig</span><span class="p">,</span> <span class="n">rivers_orig</span> <span class="o">=</span> <span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,369 - root - INFO: fixing column: catchment
2025-08-29 17:27:33,394 - root - INFO: fixing column: geometry
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the rivers and watershed</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">rivs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ws</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">river</span> <span class="ow">in</span> <span class="n">rivs</span><span class="p">:</span>
        <span class="n">river</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plot</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/88a0cb2e6d64dabf5fb4c92635d35c05e45e45d06ba907f9652d62c9e080616a.png" src="../_images/88a0cb2e6d64dabf5fb4c92635d35c05e45e45d06ba907f9652d62c9e080616a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># keeping the originals for plotting comparisons</span>
<span class="k">def</span><span class="w"> </span><span class="nf">createCopy</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To compare before/after, we often want to create copies.  Note in real workflows most things are done in-place without copies.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">watershed</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(),</span> <span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">rivers</span><span class="p">]</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span> <span class="o">=</span> <span class="n">createCopy</span><span class="p">(</span><span class="n">watershed_orig</span><span class="p">,</span> <span class="n">rivers_orig</span><span class="p">)</span>

<span class="c1"># simplifying -- this sets the discrete length scale of both the watershed boundary and the rivers</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span><span class="p">,</span> <span class="n">refine_L0</span><span class="p">,</span> <span class="n">refine_L1</span><span class="p">,</span> <span class="n">refine_d0</span><span class="p">,</span> <span class="n">refine_d1</span><span class="p">)</span>

<span class="c1"># simplify may remove reaches from the rivers object</span>
<span class="c1"># -- this call removes any reaches from the dataframe as well, signaling we are all done removing reaches</span>
<span class="c1">#</span>
<span class="c1"># ETC: NOTE -- can this be moved into the simplify call?</span>
<span class="k">for</span> <span class="n">river</span> <span class="ow">in</span> <span class="n">rivers</span><span class="p">:</span>
    <span class="n">river</span><span class="o">.</span><span class="n">resetDataFrame</span><span class="p">()</span>

<span class="c1"># Now that the river network is set, find the watershed boundary outlets</span>
<span class="k">for</span> <span class="n">river</span> <span class="ow">in</span> <span class="n">rivers</span><span class="p">:</span>
    <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">hydrography</span><span class="o">.</span><span class="n">findOutletsByCrossings</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">river</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,537 - root - INFO: 
2025-08-29 17:27:33,538 - root - INFO: Simplifying
2025-08-29 17:27:33,538 - root - INFO: ------------------------------
2025-08-29 17:27:33,538 - root - INFO: EPSG:5070
2025-08-29 17:27:33,538 - root - INFO: Presimplify to remove colinear, coincident points.
2025-08-29 17:27:33,541 - root - INFO: EPSG:5070
2025-08-29 17:27:33,541 - root - INFO: Pruning leaf reaches &lt; 125
2025-08-29 17:27:33,541 - root - INFO: EPSG:5070
2025-08-29 17:27:33,541 - root - INFO: Merging internal reaches &lt; 125
2025-08-29 17:27:33,542 - root - INFO: EPSG:5070
2025-08-29 17:27:33,543 - root - INFO:   reach: min seg length: 	    4.7213180356 	min geom length: 	  165.1231825964
2025-08-29 17:27:33,543 - root - INFO:   reach: med seg length: 	    5.7469025717 	med geom length: 	  987.4061283623
2025-08-29 17:27:33,544 - root - INFO:   reach: max seg length: 	   28.5938776319 	max geom length: 	 4068.7144554535
2025-08-29 17:27:33,544 - root - INFO: 
2025-08-29 17:27:33,544 - root - INFO:   HUC  : min seg length: 	    6.0930862643 	min geom length: 	17512.5502326232
2025-08-29 17:27:33,544 - root - INFO:   HUC  : med seg length: 	   20.1756923959 	med geom length: 	17512.5502326232
2025-08-29 17:27:33,544 - root - INFO:   HUC  : max seg length: 	  424.3827967365 	max geom length: 	17512.5502326232
2025-08-29 17:27:33,544 - root - INFO: 
2025-08-29 17:27:33,544 - root - INFO: Snapping discrete points to make rivers and HUCs discretely consistent.
2025-08-29 17:27:33,545 - root - INFO:  -- snapping HUC triple junctions to reaches
2025-08-29 17:27:33,546 - root - INFO:   reach: min seg length: 	    4.7213180356 	min geom length: 	  165.1231825964
2025-08-29 17:27:33,546 - root - INFO:   reach: med seg length: 	    5.7469025717 	med geom length: 	  987.4061283623
2025-08-29 17:27:33,546 - root - INFO:   reach: max seg length: 	   28.5938776319 	max geom length: 	 4068.7144554535
2025-08-29 17:27:33,546 - root - INFO: 
2025-08-29 17:27:33,547 - root - INFO:   HUC  : min seg length: 	    6.0930862643 	min geom length: 	17512.5502326232
2025-08-29 17:27:33,547 - root - INFO:   HUC  : med seg length: 	   20.1756923959 	med geom length: 	17512.5502326232
2025-08-29 17:27:33,547 - root - INFO:   HUC  : max seg length: 	  424.3827967365 	max geom length: 	17512.5502326232
2025-08-29 17:27:33,547 - root - INFO: 
2025-08-29 17:27:33,547 - root - INFO: EPSG:5070
2025-08-29 17:27:33,547 - root - INFO:  -- snapping reach endpoints to HUC boundaries
2025-08-29 17:27:33,555 - root - INFO:   reach: min seg length: 	    4.7213180356 	min geom length: 	  165.1231825964
2025-08-29 17:27:33,555 - root - INFO:   reach: med seg length: 	    5.7469025717 	med geom length: 	  987.4061283623
2025-08-29 17:27:33,556 - root - INFO:   reach: max seg length: 	   28.5938776319 	max geom length: 	 4068.7144554535
2025-08-29 17:27:33,556 - root - INFO: 
2025-08-29 17:27:33,556 - root - INFO:   HUC  : min seg length: 	    6.0930862643 	min geom length: 	17512.5502326232
2025-08-29 17:27:33,556 - root - INFO:   HUC  : med seg length: 	   20.1756923959 	med geom length: 	17512.5502326232
2025-08-29 17:27:33,556 - root - INFO:   HUC  : max seg length: 	  424.3827967365 	max geom length: 	17512.5502326232
2025-08-29 17:27:33,556 - root - INFO: 
2025-08-29 17:27:33,557 - root - INFO: EPSG:5070
2025-08-29 17:27:33,557 - root - INFO:  -- cutting reaches at HUC boundaries
2025-08-29 17:27:33,557 - root - INFO: intersection found
2025-08-29 17:27:33,557 - root - INFO:   - cutting reach at external boundary of HUCs:
2025-08-29 17:27:33,558 - root - INFO:       split HUC boundary ls into 2 pieces
2025-08-29 17:27:33,558 - root - INFO:       split reach ls into 2 pieces
2025-08-29 17:27:33,560 - root - INFO:   reach: min seg length: 	    2.0814263569 	min geom length: 	  165.1231825964
2025-08-29 17:27:33,560 - root - INFO:   reach: med seg length: 	    5.7506498560 	med geom length: 	  944.9293512284
2025-08-29 17:27:33,561 - root - INFO:   reach: max seg length: 	   28.5938776319 	max geom length: 	 4068.7144554535
2025-08-29 17:27:33,561 - root - INFO: 
2025-08-29 17:27:33,562 - root - INFO:   HUC  : min seg length: 	    6.0930862643 	min geom length: 	 4627.5195485168
2025-08-29 17:27:33,562 - root - INFO:   HUC  : med seg length: 	   20.1371178909 	med geom length: 	 8756.2751163116
2025-08-29 17:27:33,562 - root - INFO:   HUC  : max seg length: 	  424.3827967365 	max geom length: 	12885.0306841065
2025-08-29 17:27:33,562 - root - INFO: 
2025-08-29 17:27:33,563 - root - INFO: EPSG:5070
2025-08-29 17:27:33,563 - root - INFO: 
2025-08-29 17:27:33,563 - root - INFO: Simplification Diagnostics
2025-08-29 17:27:33,564 - root - INFO: ------------------------------
2025-08-29 17:27:33,564 - root - INFO:   reach: min seg length: 	    2.0814263569 	min geom length: 	  165.1231825964
2025-08-29 17:27:33,564 - root - INFO:   reach: med seg length: 	    5.7506498560 	med geom length: 	  944.9293512284
2025-08-29 17:27:33,564 - root - INFO:   reach: max seg length: 	   28.5938776319 	max geom length: 	 4068.7144554535
2025-08-29 17:27:33,565 - root - INFO: 
2025-08-29 17:27:33,565 - root - INFO:   HUC  : min seg length: 	    6.0930862643 	min geom length: 	 4627.5195485168
2025-08-29 17:27:33,565 - root - INFO:   HUC  : med seg length: 	   20.1371178909 	med geom length: 	 8756.2751163116
2025-08-29 17:27:33,565 - root - INFO:   HUC  : max seg length: 	  424.3827967365 	max geom length: 	12885.0306841065
2025-08-29 17:27:33,565 - root - INFO: 
2025-08-29 17:27:33,565 - root - INFO: EPSG:5070
2025-08-29 17:27:33,566 - root - INFO: 
2025-08-29 17:27:33,566 - root - INFO: Resampling HUC and river
2025-08-29 17:27:33,566 - root - INFO: ------------------------------
2025-08-29 17:27:33,566 - root - INFO:  -- resampling HUCs based on distance function (200, 125, 600, 300)
2025-08-29 17:27:33,632 - root - INFO: EPSG:5070
2025-08-29 17:27:33,632 - root - INFO:  -- resampling reaches based on uniform target 125
2025-08-29 17:27:33,638 - root - INFO: EPSG:5070
2025-08-29 17:27:33,638 - root - INFO: 
2025-08-29 17:27:33,638 - root - INFO: Resampling Diagnostics
2025-08-29 17:27:33,638 - root - INFO: ------------------------------
2025-08-29 17:27:33,639 - root - INFO:   reach: min seg length: 	   80.6788358181 	min geom length: 	  162.6365417198
2025-08-29 17:27:33,639 - root - INFO:   reach: med seg length: 	  116.9716913444 	med geom length: 	  933.8039522688
2025-08-29 17:27:33,639 - root - INFO:   reach: max seg length: 	  124.2213863088 	max geom length: 	 4016.8050558108
2025-08-29 17:27:33,639 - root - INFO: 
2025-08-29 17:27:33,639 - root - INFO:   HUC  : min seg length: 	  123.6155631726 	min geom length: 	 4318.0632729232
2025-08-29 17:27:33,640 - root - INFO:   HUC  : med seg length: 	  225.3314175350 	med geom length: 	 8192.0964914255
2025-08-29 17:27:33,640 - root - INFO:   HUC  : max seg length: 	  299.1244344516 	max geom length: 	12066.1297099279
2025-08-29 17:27:33,640 - root - INFO: 
2025-08-29 17:27:33,640 - root - INFO: EPSG:5070
2025-08-29 17:27:33,640 - root - INFO: 
2025-08-29 17:27:33,640 - root - INFO: Clean up sharp angles, both internally and at junctions.
2025-08-29 17:27:33,641 - root - INFO: ------------------------------
2025-08-29 17:27:33,642 - root - INFO: SSA1: EPSG:5070
2025-08-29 17:27:33,644 - root - INFO: SSA2: EPSG:5070
2025-08-29 17:27:33,647 - root - INFO: SSA3: EPSG:5070
2025-08-29 17:27:33,658 - root - INFO: SSA4: EPSG:5070
2025-08-29 17:27:33,658 - root - INFO: Cleaned up 0 sharp angles.
2025-08-29 17:27:33,659 - root - INFO:   reach: min seg length: 	   80.6788358181 	min geom length: 	  162.6365417198
2025-08-29 17:27:33,659 - root - INFO:   reach: med seg length: 	  116.9716913444 	med geom length: 	  933.8039522688
2025-08-29 17:27:33,659 - root - INFO:   reach: max seg length: 	  124.2213863088 	max geom length: 	 4016.8050558108
2025-08-29 17:27:33,659 - root - INFO: 
2025-08-29 17:27:33,660 - root - INFO:   HUC  : min seg length: 	  123.6155631726 	min geom length: 	 4318.0632729232
2025-08-29 17:27:33,660 - root - INFO:   HUC  : med seg length: 	  225.3314175350 	med geom length: 	 8192.0964914255
2025-08-29 17:27:33,660 - root - INFO:   HUC  : max seg length: 	  299.1244344516 	max geom length: 	12066.1297099279
2025-08-29 17:27:33,660 - root - INFO: 
2025-08-29 17:27:33,660 - root - INFO: EPSG:5070
2025-08-29 17:27:33,671 - root - INFO: Crossings by Polygon:
2025-08-29 17:27:33,672 - root - INFO:   Polygon 0
2025-08-29 17:27:33,672 - root - INFO:     crossing: [1134002.89761532 1408719.29292113]
2025-08-29 17:27:33,672 - root - INFO: Constructing outlet list
2025-08-29 17:27:33,672 - root - INFO: Iteration = 0
2025-08-29 17:27:33,672 - root - INFO: -----------------
2025-08-29 17:27:33,673 - root - INFO:  poly outlet 0 : 0, [1134002.89761532 1408719.29292113]
2025-08-29 17:27:33,673 - root - INFO: last outlet is 0 in polygon 0 at {crossings_clusters_centroids[last_outlet]}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adb0fcc28223392b90900db27a15f4b489e3fddbdd5108310f8c2e7744a790e7.png" src="../_images/adb0fcc28223392b90900db27a15f4b489e3fddbdd5108310f8c2e7744a790e7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this generates a zoomable map, showing different reaches and watersheds, </span>
<span class="c1"># with discrete points.  Problem areas are clickable to get IDs for manual</span>
<span class="c1"># modifications.</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">watershed</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">river</span> <span class="ow">in</span> <span class="n">rivers_orig</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">river</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; raw&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">river</span> <span class="ow">in</span> <span class="n">rivers</span><span class="p">:</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">explore</span><span class="p">(</span><span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
    
<span class="n">m</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">makeMap</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    
    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;
    
            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,
                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;
            &lt;style&gt;
                #map_f692b53c90bdb78aae5d189c6aa914a5 {
                    position: relative;
                    width: 100.0%;
                    height: 100.0%;
                    left: 0.0%;
                    top: 0.0%;
                }
                .leaflet-container { font-size: 1rem; }
            &lt;/style&gt;

            &lt;style&gt;html, body {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }
            &lt;/style&gt;

            &lt;style&gt;#map {
                position:absolute;
                top:0;
                bottom:0;
                right:0;
                left:0;
                }
            &lt;/style&gt;

            &lt;script&gt;
                L_NO_TOUCH = false;
                L_DISABLE_3D = false;
            &lt;/script&gt;

        
    
                    &lt;style&gt;
                        .foliumpopup {
                            margin: auto;
                        }
                       .foliumpopup table{
                            margin: auto;
                        }
                        .foliumpopup tr{
                            text-align: left;
                        }
                        .foliumpopup th{
                            padding: 2px; padding-right: 8px;
                        }
                    &lt;/style&gt;
            
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js&quot;&gt;&lt;/script&gt;
    
                    &lt;style&gt;
                        .foliumpopup {
                            margin: auto;
                        }
                       .foliumpopup table{
                            margin: auto;
                        }
                        .foliumpopup tr{
                            text-align: left;
                        }
                        .foliumpopup th{
                            padding: 2px; padding-right: 8px;
                        }
                    &lt;/style&gt;
            
    
                    &lt;style&gt;
                        .foliumpopup {
                            margin: auto;
                        }
                       .foliumpopup table{
                            margin: auto;
                        }
                        .foliumpopup tr{
                            text-align: left;
                        }
                        .foliumpopup th{
                            padding: 2px; padding-right: 8px;
                        }
                    &lt;/style&gt;
            
    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.min.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet.fullscreen@3.0.0/Control.FullScreen.css&quot;/&gt;
    &lt;script src=&quot;https://cdn.jsdelivr.net/gh/ljagis/leaflet-measure@2.1.7/dist/leaflet-measure.min.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/ljagis/leaflet-measure@2.1.7/dist/leaflet-measure.min.css&quot;/&gt;
&lt;/head&gt;
&lt;body&gt;
    
    
            &lt;div class=&quot;folium-map&quot; id=&quot;map_f692b53c90bdb78aae5d189c6aa914a5&quot; &gt;&lt;/div&gt;
        
&lt;/body&gt;
&lt;script&gt;
    
    
            var map_f692b53c90bdb78aae5d189c6aa914a5 = L.map(
                &quot;map_f692b53c90bdb78aae5d189c6aa914a5&quot;,
                {
                    center: [35.05087875522585, -83.45003957388043],
                    crs: L.CRS.EPSG3857,
                    ...{
  &quot;zoom&quot;: 10,
  &quot;zoomControl&quot;: true,
  &quot;preferCanvas&quot;: false,
}

                }
            );
            L.control.scale().addTo(map_f692b53c90bdb78aae5d189c6aa914a5);

            

        
    
            var tile_layer_c6ae7c72e84be2e9f572419c29ff14dc = L.tileLayer(
                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,
                {
  &quot;minZoom&quot;: 0,
  &quot;maxZoom&quot;: 19,
  &quot;maxNativeZoom&quot;: 19,
  &quot;noWrap&quot;: false,
  &quot;attribution&quot;: &quot;\u0026copy; \u003ca href=\&quot;https://www.openstreetmap.org/copyright\&quot;\u003eOpenStreetMap\u003c/a\u003e contributors&quot;,
  &quot;subdomains&quot;: &quot;abc&quot;,
  &quot;detectRetina&quot;: false,
  &quot;tms&quot;: false,
  &quot;opacity&quot;: 1,
}

            );
        
    
            tile_layer_c6ae7c72e84be2e9f572419c29ff14dc.addTo(map_f692b53c90bdb78aae5d189c6aa914a5);
        
    
            map_f692b53c90bdb78aae5d189c6aa914a5.fitBounds(
                [[35.028031495653195, -83.47797106402601], [35.0737260147985, -83.42210808373486]],
                {}
            );
        
    
        function geo_json_0465dbf9808d845d75e1e5952452a03d_styler(feature) {
            switch(feature.id) {
                default:
                    return {&quot;color&quot;: [0.7843137254901961, 0.35294117647058826, 0.3254901960784314, 1.0], &quot;fillColor&quot;: [0.7843137254901961, 0.35294117647058826, 0.3254901960784314, 1.0], &quot;fillOpacity&quot;: 0.2, &quot;weight&quot;: 5};
            }
        }
        function geo_json_0465dbf9808d845d75e1e5952452a03d_highlighter(feature) {
            switch(feature.id) {
                default:
                    return {&quot;fillOpacity&quot;: 0.4};
            }
        }
        function geo_json_0465dbf9808d845d75e1e5952452a03d_pointToLayer(feature, latlng) {
            var opts = {
  &quot;stroke&quot;: true,
  &quot;color&quot;: &quot;#3388ff&quot;,
  &quot;weight&quot;: 3,
  &quot;opacity&quot;: 1.0,
  &quot;lineCap&quot;: &quot;round&quot;,
  &quot;lineJoin&quot;: &quot;round&quot;,
  &quot;dashArray&quot;: null,
  &quot;dashOffset&quot;: null,
  &quot;fill&quot;: true,
  &quot;fillColor&quot;: &quot;#3388ff&quot;,
  &quot;fillOpacity&quot;: 0.2,
  &quot;fillRule&quot;: &quot;evenodd&quot;,
  &quot;bubblingMouseEvents&quot;: true,
  &quot;radius&quot;: 2,
};
            
            let style = geo_json_0465dbf9808d845d75e1e5952452a03d_styler(feature)
            Object.assign(opts, style)
            
            return new L.CircleMarker(latlng, opts)
        }

        function geo_json_0465dbf9808d845d75e1e5952452a03d_onEachFeature(feature, layer) {

            layer.on({
                mouseout: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                            geo_json_0465dbf9808d845d75e1e5952452a03d.resetStyle(e.target);
                    }
                },
                mouseover: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                        const highlightStyle = geo_json_0465dbf9808d845d75e1e5952452a03d_highlighter(e.target.feature)
                        e.target.setStyle(highlightStyle);
                    }
                },
            });
        };
        var geo_json_0465dbf9808d845d75e1e5952452a03d = L.geoJson(null, {
                onEachFeature: geo_json_0465dbf9808d845d75e1e5952452a03d_onEachFeature,
            
                style: geo_json_0465dbf9808d845d75e1e5952452a03d_styler,
                pointToLayer: geo_json_0465dbf9808d845d75e1e5952452a03d_pointToLayer,
            ...{
}
        });

        function geo_json_0465dbf9808d845d75e1e5952452a03d_add (data) {
            geo_json_0465dbf9808d845d75e1e5952452a03d
                .addData(data);
        }
            geo_json_0465dbf9808d845d75e1e5952452a03d_add({&quot;bbox&quot;: [-83.47797106402601, 35.028031495653195, -83.42210808373486, 35.0737260147985], &quot;features&quot;: [{&quot;bbox&quot;: [-83.47797106402601, 35.028031495653195, -83.42210808373486, 35.0737260147985], &quot;geometry&quot;: {&quot;coordinates&quot;: [[[-83.46030935625463, 35.06899659383923], [-83.45873477821958, 35.07058617190142], [-83.45640056290932, 35.07125122396911], [-83.45442396862882, 35.07199385015111], [-83.45214618185788, 35.071907716611854], [-83.44964255612898, 35.07221160364894], [-83.44693439167459, 35.0727018576571], [-83.44524823463043, 35.07354073570377], [-83.44352945166722, 35.07356793177409], [-83.44196565644738, 35.0737260147985], [-83.44047326390124, 35.073163148141106], [-83.43995056060498, 35.07173551300939], [-83.43885987237661, 35.07043429829424], [-83.43615934855582, 35.070122351956734], [-83.43298463196683, 35.07008940378879], [-83.4300814114316, 35.06911338949841], [-83.42751507349794, 35.06833027487111], [-83.4277720579936, 35.06568298507503], [-83.42758120830047, 35.06363515044866], [-83.4259894726823, 35.062762236779584], [-83.42546394509661, 35.06173903613863], [-83.42540831271198, 35.06063518003814], [-83.42559379877319, 35.05953137930234], [-83.42635452151626, 35.058603404033995], [-83.42657812728781, 35.057432048126], [-83.42537992007657, 35.05594786480073], [-83.42283425398088, 35.05424146546617], [-83.42210808373486, 35.05214446442705], [-83.4249723654775, 35.050984111192655], [-83.42589988798215, 35.04918847190446], [-83.427088546381, 35.047768162342614], [-83.42810445101156, 35.046727664677675], [-83.4290085890977, 35.04573181127048], [-83.43018726755801, 35.044611631876556], [-83.43232794280512, 35.04450766936552], [-83.43462098472281, 35.04304385655797], [-83.43575221975387, 35.040570027692425], [-83.43835680141392, 35.039072679622734], [-83.44067719708369, 35.03733528997121], [-83.44285490185834, 35.03588383505482], [-83.44601404433512, 35.03538361601932], [-83.44836101092307, 35.03444109724583], [-83.45020023650805, 35.033128138964], [-83.45281931955591, 35.03258238202409], [-83.45576193932803, 35.0318231816332], [-83.45746568683528, 35.03018656052642], [-83.45900645015861, 35.028031495653195], [-83.46011814261085, 35.029138588668786], [-83.46176700123164, 35.03047961647479], [-83.46380051296961, 35.03117878318941], [-83.46565060598205, 35.03155383764322], [-83.46696935144854, 35.03201079212538], [-83.4680772846556, 35.03267477795327], [-83.46871892883196, 35.03366341923965], [-83.46911780064643, 35.034785546536014], [-83.4709686486081, 35.03558244814126], [-83.47254093527344, 35.03714428308239], [-83.47332446530156, 35.0397222845008], [-83.47257185004302, 35.04228564246398], [-83.47137399121351, 35.04476373194073], [-83.47184903705102, 35.04714209915964], [-83.47271257898124, 35.04929854827035], [-83.47488740227742, 35.05061632900747], [-83.47730354470629, 35.052137674827215], [-83.47715226785974, 35.05475828264652], [-83.47797106402601, 35.056747153348695], [-83.47792938566029, 35.05876086480531], [-83.47651039414572, 35.06038039744312], [-83.47445531855591, 35.06068453981891], [-83.47248884644905, 35.061203796469144], [-83.47010226523162, 35.06197798149737], [-83.46756682766865, 35.063690193498125], [-83.46566741482563, 35.065800753023886], [-83.4629862928678, 35.06629684791199], [-83.46181037348019, 35.067682032023924], [-83.46030935625463, 35.06899659383923]]], &quot;type&quot;: &quot;Polygon&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;BASIN_CODE&quot;: 1, &quot;CWTBASINNA&quot;: 2, &quot;CWTBASIN_1&quot;: 1, &quot;ID&quot;: 0, &quot;LABEL&quot;: &quot;Coweeta Hydrologic Lab&quot;, &quot;PERIMETER&quot;: 17521.768, &quot;SPOT&quot;: -9999, &quot;__folium_color&quot;: [0.7843137254901961, 0.35294117647058826, 0.3254901960784314, 1.0], &quot;area&quot;: 16260198.383, &quot;name&quot;: &quot;0&quot;, &quot;outlet&quot;: &quot;POINT (1134002.897615319 1408719.2929211326)&quot;}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
    geo_json_0465dbf9808d845d75e1e5952452a03d.bindPopup(
    function(layer){
    let div = L.DomUtil.create(&#x27;div&#x27;);
    
    let handleObject = feature =&gt; {
        if (feature === null) {
            return &#x27;&#x27;;
        } else if (typeof(feature)==&#x27;object&#x27;) {
            return JSON.stringify(feature);
        } else {
            return feature;
        }
    }
    let fields = [&quot;ID&quot;, &quot;name&quot;, &quot;area&quot;, &quot;PERIMETER&quot;, &quot;CWTBASINNA&quot;, &quot;CWTBASIN_1&quot;, &quot;BASIN_CODE&quot;, &quot;SPOT&quot;];
    let aliases = [&quot;ID&quot;, &quot;name&quot;, &quot;area&quot;, &quot;PERIMETER&quot;, &quot;CWTBASINNA&quot;, &quot;CWTBASIN_1&quot;, &quot;BASIN_CODE&quot;, &quot;SPOT&quot;];
    let table = &#x27;&lt;table&gt;&#x27; +
        String(
        fields.map(
        (v,i)=&gt;
        `&lt;tr&gt;
            &lt;th&gt;${aliases[i].toLocaleString()}&lt;/th&gt;
            
            &lt;td&gt;${handleObject(layer.feature.properties[v]).toLocaleString()}&lt;/td&gt;
        &lt;/tr&gt;`).join(&#x27;&#x27;))
    +&#x27;&lt;/table&gt;&#x27;;
    div.innerHTML=table;
    
    return div
    }
    ,{
  &quot;className&quot;: &quot;foliumpopup&quot;,
});
                     
    
            geo_json_0465dbf9808d845d75e1e5952452a03d.addTo(map_f692b53c90bdb78aae5d189c6aa914a5);
        
    
    var color_map_21735aeb0b95b159eef3113bd50313af = {};

    
    color_map_21735aeb0b95b159eef3113bd50313af.color = d3.scale.threshold()
              .domain([0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])
              .range([&#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;, &#x27;#c85a53ff&#x27;]);
    

    color_map_21735aeb0b95b159eef3113bd50313af.x = d3.scale.linear()
              .domain([0.0, 0.0])
              .range([0, 450 - 50]);

    color_map_21735aeb0b95b159eef3113bd50313af.legend = L.control({position: &#x27;topright&#x27;});
    color_map_21735aeb0b95b159eef3113bd50313af.legend.onAdd = function (map) {var div = L.DomUtil.create(&#x27;div&#x27;, &#x27;legend&#x27;); return div};
    color_map_21735aeb0b95b159eef3113bd50313af.legend.addTo(map_f692b53c90bdb78aae5d189c6aa914a5);

    color_map_21735aeb0b95b159eef3113bd50313af.xAxis = d3.svg.axis()
        .scale(color_map_21735aeb0b95b159eef3113bd50313af.x)
        .orient(&quot;top&quot;)
        .tickSize(1)
        .tickValues([0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, 0.0, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;, &#x27;&#x27;]);

    color_map_21735aeb0b95b159eef3113bd50313af.svg = d3.select(&quot;.legend.leaflet-control&quot;).append(&quot;svg&quot;)
        .attr(&quot;id&quot;, &#x27;legend&#x27;)
        .attr(&quot;width&quot;, 450)
        .attr(&quot;height&quot;, 40);

    color_map_21735aeb0b95b159eef3113bd50313af.g = color_map_21735aeb0b95b159eef3113bd50313af.svg.append(&quot;g&quot;)
        .attr(&quot;class&quot;, &quot;key&quot;)
        .attr(&quot;fill&quot;, &quot;black&quot;)
        .attr(&quot;transform&quot;, &quot;translate(25,16)&quot;);

    color_map_21735aeb0b95b159eef3113bd50313af.g.selectAll(&quot;rect&quot;)
        .data(color_map_21735aeb0b95b159eef3113bd50313af.color.range().map(function(d, i) {
          return {
            x0: i ? color_map_21735aeb0b95b159eef3113bd50313af.x(color_map_21735aeb0b95b159eef3113bd50313af.color.domain()[i - 1]) : color_map_21735aeb0b95b159eef3113bd50313af.x.range()[0],
            x1: i &lt; color_map_21735aeb0b95b159eef3113bd50313af.color.domain().length ? color_map_21735aeb0b95b159eef3113bd50313af.x(color_map_21735aeb0b95b159eef3113bd50313af.color.domain()[i]) : color_map_21735aeb0b95b159eef3113bd50313af.x.range()[1],
            z: d
          };
        }))
      .enter().append(&quot;rect&quot;)
        .attr(&quot;height&quot;, 40 - 30)
        .attr(&quot;x&quot;, function(d) { return d.x0; })
        .attr(&quot;width&quot;, function(d) { return d.x1 - d.x0; })
        .style(&quot;fill&quot;, function(d) { return d.z; });

    color_map_21735aeb0b95b159eef3113bd50313af.g.call(color_map_21735aeb0b95b159eef3113bd50313af.xAxis).append(&quot;text&quot;)
        .attr(&quot;class&quot;, &quot;caption&quot;)
        .attr(&quot;y&quot;, 21)
        .attr(&quot;fill&quot;, &quot;black&quot;)
        .text(&quot;ID&quot;);
    
        function geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_styler(feature) {
            switch(feature.id) {
                default:
                    return {&quot;color&quot;: &quot;black&quot;, &quot;fillColor&quot;: &quot;black&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
            }
        }
        function geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_highlighter(feature) {
            switch(feature.id) {
                default:
                    return {&quot;fillOpacity&quot;: 0.75};
            }
        }
        function geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_pointToLayer(feature, latlng) {
            var opts = {
  &quot;stroke&quot;: true,
  &quot;color&quot;: &quot;#3388ff&quot;,
  &quot;weight&quot;: 3,
  &quot;opacity&quot;: 1.0,
  &quot;lineCap&quot;: &quot;round&quot;,
  &quot;lineJoin&quot;: &quot;round&quot;,
  &quot;dashArray&quot;: null,
  &quot;dashOffset&quot;: null,
  &quot;fill&quot;: true,
  &quot;fillColor&quot;: &quot;#3388ff&quot;,
  &quot;fillOpacity&quot;: 0.2,
  &quot;fillRule&quot;: &quot;evenodd&quot;,
  &quot;bubblingMouseEvents&quot;: true,
  &quot;radius&quot;: 2,
};
            
            let style = geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_styler(feature)
            Object.assign(opts, style)
            
            return new L.CircleMarker(latlng, opts)
        }

        function geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_onEachFeature(feature, layer) {

            layer.on({
                mouseout: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                            geo_json_59c10e85b0fdcf8f6c77b62af36c96b4.resetStyle(e.target);
                    }
                },
                mouseover: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                        const highlightStyle = geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_highlighter(e.target.feature)
                        e.target.setStyle(highlightStyle);
                    }
                },
            });
        };
        var geo_json_59c10e85b0fdcf8f6c77b62af36c96b4 = L.geoJson(null, {
                onEachFeature: geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_onEachFeature,
            
                style: geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_styler,
                pointToLayer: geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_pointToLayer,
            ...{
}
        });

        function geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_add (data) {
            geo_json_59c10e85b0fdcf8f6c77b62af36c96b4
                .addData(data);
        }
            geo_json_59c10e85b0fdcf8f6c77b62af36c96b4_add({&quot;bbox&quot;: [-83.473102981185, 35.03353921194884, -83.40420631407535, 35.07145587901515], &quot;features&quot;: [{&quot;bbox&quot;: [-83.42887071363768, 35.05727421187112, -83.40420631407535, 35.06408421185174], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.42887071363768, 35.05976361184979], [-83.42879651369353, 35.05978007931617], [-83.42872958112001, 35.05978261175414], [-83.42866738087143, 35.0597712790202], [-83.42860411432261, 35.05976461188361], [-83.428545580997, 35.05974827897756], [-83.42848511359858, 35.05973587929074], [-83.42842351432293, 35.05972561202806], [-83.42836791399674, 35.05970321199321], [-83.4283061808721, 35.059693211647385], [-83.4282503811199, 35.05967121235291], [-83.42818918069624, 35.05966061198212], [-83.42813338094403, 35.05963841193653], [-83.42807738086755, 35.05961701191334], [-83.42801811361836, 35.05960227903496], [-83.4279549809185, 35.05959287869832], [-83.42789411376981, 35.05960507913506], [-83.42783338136839, 35.05961741192754], [-83.42778258074075, 35.059649012310174], [-83.42772751401384, 35.05967201164552], [-83.42768078095783, 35.059711679196745], [-83.42762898140359, 35.05974147874626], [-83.42758231392459, 35.05978101170046], [-83.42752698129634, 35.05980361172059], [-83.42747118064582, 35.0598254793574], [-83.42741551384432, 35.059847211689785], [-83.42735858131654, 35.05986687924337], [-83.42730358106496, 35.05989021235165], [-83.42724838138739, 35.059913079261925], [-83.42716671374828, 35.05996881190579], [-83.42711998069224, 35.06000847931287], [-83.42706911358928, 35.06003981188883], [-83.42701791410965, 35.060070879003725], [-83.42696258058312, 35.06009347894368], [-83.42691051422925, 35.06012247906569], [-83.42685691355287, 35.06014847909016], [-83.42679858055158, 35.06016527884146], [-83.4267385138018, 35.06017861231338], [-83.42667691362782, 35.060189011875885], [-83.42660991368068, 35.06018821185301], [-83.42654238103256, 35.06018721182442], [-83.42647611411067, 35.060188211853045], [-83.42641518138495, 35.06019961217801], [-83.4263493806887, 35.060201812240535], [-83.42629271406226, 35.06022181207097], [-83.42623178133654, 35.06023341166161], [-83.42617698140926, 35.06025681231413], [-83.42612198115768, 35.06028041223], [-83.42607011422979, 35.06030981229649], [-83.42601631412744, 35.06033547916418], [-83.42596111355154, 35.0603582121226], [-83.42590618067362, 35.06038181200921], [-83.42585138074634, 35.06040541188902], [-83.42579638139306, 35.06042881175683], [-83.42574118081717, 35.06045187925659], [-83.42569098116245, 35.06048467934619], [-83.42563871358597, 35.06051327931931], [-83.42558758058168, 35.06054441169681], [-83.42553671437703, 35.060575611711066], [-83.4254855139991, 35.06060661170879], [-83.42542978072225, 35.06062847913049], [-83.42537211427089, 35.060646478810526], [-83.42531271407105, 35.06066101223127], [-83.42525118127071, 35.06067161173681], [-83.42519071387234, 35.06068401201688], [-83.4251239807248, 35.06068527895712], [-83.42505691430232, 35.06068587897057], [-83.4249895810802, 35.060685612052794], [-83.42492278055903, 35.06068441202581], [-83.42486231405894, 35.060671811741344], [-83.42479518116114, 35.060672811764015], [-83.42473351361349, 35.06066227917184], [-83.4246731809624, 35.060649811975225], [-83.42460538061633, 35.0606516120165], [-83.42454498059158, 35.06063907864028], [-83.42447811359509, 35.06063921173158], [-83.42441071389761, 35.06064047867252], [-83.42434398075011, 35.060640611763816], [-83.42428318097507, 35.06062687909335], [-83.42422198055138, 35.06064067867705], [-83.42415478117825, 35.06063947864951], [-83.42409398140319, 35.06065167892978], [-83.42403271360587, 35.060662279171844], [-83.42397098137953, 35.06067247866824], [-83.42391471360509, 35.060693279136636], [-83.42385531430352, 35.06070787872696], [-83.42379898095207, 35.06072841226872], [-83.42374298087559, 35.060750012004945], [-83.4236907141974, 35.06077867879831], [-83.42363518124486, 35.06080087926926], [-83.42358418119123, 35.06083201227233], [-83.42353311376395, 35.06086321217677], [-83.423482181084, 35.060894412069125], [-83.42343118103035, 35.06092587886672], [-83.42337618077876, 35.06094887931295], [-83.42332111405186, 35.060972079021205], [-83.42326411415044, 35.06099147865178], [-83.42320758137298, 35.061012012122255], [-83.42314731429889, 35.06102467926723], [-83.42308598092457, 35.06103541181618], [-83.42302498082518, 35.06104721203012], [-83.4229643140008, 35.06105887915172], [-83.42290298062645, 35.06106967934444], [-83.42283551355536, 35.061068411674896], [-83.42277438140363, 35.06107967878643], [-83.42271331393064, 35.06109081207052], [-83.42265751417844, 35.06111301172117], [-83.42260218065188, 35.061135612107925], [-83.42254351437562, 35.06115161164265], [-83.42249078057348, 35.06117927901395], [-83.42244158074368, 35.06121427884657], [-83.42239031389045, 35.0612448793308], [-83.42235351440483, 35.06128727924743], [-83.42230518055096, 35.06132567908359], [-83.42225818069528, 35.06136467891014], [-83.42223018110619, 35.06141001189285], [-83.42218238085164, 35.061448479319225], [-83.42214571431666, 35.06149101222007], [-83.42209811438639, 35.0615296119628], [-83.42206131400246, 35.06157187864181], [-83.4220129810469, 35.06161041216915], [-83.42196598119125, 35.061649278770034], [-83.4219301141569, 35.06169247922013], [-83.42188198062735, 35.061730878865724], [-83.42183011369947, 35.061760879150725], [-83.42178358096776, 35.06180067877644], [-83.42173238058982, 35.061831879045975], [-83.42168031423596, 35.06186101163971], [-83.42163011368294, 35.06189341189541], [-83.42157498137901, 35.06191647898136], [-83.42152398132538, 35.061948079209344], [-83.42146891370014, 35.06197101172019], [-83.42141811397084, 35.06200261192704], [-83.42136291429325, 35.06202547898098], [-83.42130778109099, 35.06204847911743], [-83.42125698136168, 35.062080079294375], [-83.4212015813598, 35.062102678678094], [-83.42114591365996, 35.062124611875895], [-83.42109011390778, 35.06214627889011], [-83.42103731363031, 35.06217387901226], [-83.42098211395275, 35.062197079107776], [-83.42092311440152, 35.06221221225473], [-83.42087231377387, 35.062243879280345], [-83.42081698114563, 35.06226681170794], [-83.42076178056972, 35.062289611775846], [-83.42070611376822, 35.06231161183534], [-83.4206475813409, 35.06232787878737], [-83.42059451426383, 35.06235487884687], [-83.4205425143853, 35.062384278901526], [-83.42048331361144, 35.06239927892538], [-83.42042771418356, 35.06242147895556], [-83.42036931380862, 35.062438078974196], [-83.42031058105702, 35.062453878988805], [-83.42025098143118, 35.062468212087595], [-83.42019411358213, 35.062487812098034], [-83.42013218103149, 35.06249747901323], [-83.4200713138828, 35.06250901210395], [-83.42001058058305, 35.06252141210488], [-83.4199431144103, 35.06252261210495], [-83.41988198136025, 35.06250947901582], [-83.41982058061227, 35.0624992121019], [-83.4197599811615, 35.06248561209708], [-83.41969238113975, 35.06248561209704], [-83.41963078096576, 35.06249707901304], [-83.4195701141414, 35.06250921210404], [-83.4195129812893, 35.062528212104674], [-83.41945378141376, 35.06254321210197], [-83.41940298078612, 35.062574812087476], [-83.419350380833, 35.06260421206294], [-83.41930331360368, 35.06264381201318], [-83.41926758131662, 35.062686678849396], [-83.41922871390923, 35.06272827875459], [-83.41918351427738, 35.06276807864403], [-83.41913638057274, 35.06280747925079], [-83.41908838089218, 35.062845879107186], [-83.41903638101364, 35.06287561207181], [-83.41898538096002, 35.06290681193048], [-83.41893451385704, 35.06293827868761], [-83.41887951360546, 35.062961279302264], [-83.41882851355183, 35.06299281221443], [-83.4187731809236, 35.06301547899217], [-83.418718180672, 35.06303881193588], [-83.4186673809427, 35.06307027864217], [-83.41861231421576, 35.063093279219544], [-83.41856111383784, 35.063124078997994], [-83.41851111360913, 35.063157678743025], [-83.41845898077992, 35.06318647924879], [-83.41840538100186, 35.06321261211991], [-83.41835331374969, 35.06324161186922], [-83.41829831439642, 35.06326507930585], [-83.41824411364543, 35.06328947908], [-83.41819238056654, 35.06331961187911], [-83.41813891373914, 35.063345812354015], [-83.41808218063738, 35.06336607905865], [-83.41802698095978, 35.06338901190638], [-83.41797191423288, 35.063412011658684], [-83.4179155144061, 35.063432412168844], [-83.41786251380432, 35.06345947877408], [-83.41780711380244, 35.063482412330856], [-83.41775231387514, 35.063505878962985], [-83.41769698124692, 35.06352867868485], [-83.41764638094358, 35.06356067901903], [-83.41759078061739, 35.063582811822464], [-83.41753971408843, 35.06361401214623], [-83.41748871403482, 35.06364521172265], [-83.41743778135483, 35.06367641202244], [-83.4173867813012, 35.06370781230748], [-83.41733651427286, 35.063740078743876], [-83.41728651404415, 35.06377347897373], [-83.41723758101399, 35.06380887915843], [-83.4171865135867, 35.063839811752935], [-83.41713958110468, 35.06387927875309], [-83.41708811392711, 35.063909412069826], [-83.4170371138735, 35.063940412272125], [-83.41698611381987, 35.06397181172031], [-83.41693498081558, 35.064002811898916], [-83.41687998056399, 35.06402641220248], [-83.41682431376246, 35.064048211797704], [-83.41676298128644, 35.06405887924458], [-83.41670298101198, 35.06407247898734], [-83.41664131436268, 35.064082811878535], [-83.41657451384152, 35.06408387876988], [-83.41650731357007, 35.06408421185174], [-83.41643998124626, 35.06408381185945], [-83.41637331367575, 35.06408281187857], [-83.41631258127435, 35.06407047902533], [-83.41624618140182, 35.06406981212619], [-83.41617898113034, 35.06407061211092], [-83.41611171438355, 35.064071612092], [-83.41604478091173, 35.06407181208823], [-83.41598411408735, 35.06405987922576], [-83.41591758126414, 35.06405947923331], [-83.41584991386873, 35.064061012292576], [-83.41578951384398, 35.06404841179393], [-83.41572811399432, 35.06403801198786], [-83.415669780993, 35.06402121229822], [-83.41561618121496, 35.063994812043696], [-83.41556338093748, 35.06396687871959], [-83.41551218055956, 35.06393587926262], [-83.41546418087898, 35.063897879176864], [-83.4154163141491, 35.06385921217265], [-83.41536911396909, 35.06382021206711], [-83.41532231443774, 35.06378087885991], [-83.41528571437814, 35.06373827877076], [-83.41523971434738, 35.063698679351475], [-83.4151923138431, 35.063659412261195], [-83.41514411383821, 35.06362107896305], [-83.41509251370996, 35.0635906117207], [-83.41503758083202, 35.06356721202386], [-83.41497691400764, 35.0635552121767], [-83.41491558063328, 35.06354407922872], [-83.41484851421082, 35.0635450123052], [-83.41478691403682, 35.06353241172692], [-83.41472578098679, 35.06354481230774], [-83.41466511416242, 35.06355687906733], [-83.41460131401429, 35.063562812080086], [-83.4145373144402, 35.06356901200078], [-83.41446998121808, 35.06356981199049], [-83.41440271357297, 35.0635692119982], [-83.41433731442366, 35.0635654789578], [-83.41428051394824, 35.06354561229771], [-83.41422471419607, 35.06352387874396], [-83.4141723136689, 35.06349527909017], [-83.41412558061286, 35.06345541190897], [-83.41407418080897, 35.06342481225332], [-83.41396518102901, 35.06336927902541], [-83.41390891415286, 35.06334867923679], [-83.41384831380383, 35.06333521172513], [-83.41378058083137, 35.0633352786362], [-83.41372031375728, 35.063348879234724], [-83.41365491370965, 35.06335181229322], [-83.41359211428478, 35.063359679124545], [-83.41353651395856, 35.0633816788957], [-83.41347538090854, 35.06339321186163], [-83.41341198140906, 35.063399678704045], [-83.41334738086202, 35.06340527864358], [-83.41328031443956, 35.06340607863495], [-83.41321298121743, 35.06340541173043], [-83.4131479809201, 35.063401211775776], [-83.41308978086946, 35.06338407887038], [-83.41302951379538, 35.06337101209559], [-83.41297151406904, 35.063353479188], [-83.41291271394381, 35.06333767934752], [-83.41285151441843, 35.06332661181039], [-83.41279018104412, 35.06331567882919], [-83.41272798079552, 35.06332547873328], [-83.4126689812443, 35.06334061167107], [-83.41261211429355, 35.06336021220735], [-83.41255498144147, 35.06337961200572], [-83.4124999811899, 35.06340267867173], [-83.41244498093832, 35.06342587915324], [-83.41238951356279, 35.0634484119887], [-83.41232851436173, 35.06345981185848], [-83.41226698066306, 35.06347027864932], [-83.41219991424059, 35.06347241171268], [-83.41213871381692, 35.063459411863015], [-83.41207211362006, 35.06345907877869], [-83.41200518104657, 35.06345927877635], [-83.41194378119688, 35.063448678897466], [-83.4118831143725, 35.06343661212185], [-83.41181611442535, 35.06343721211514], [-83.41175431392706, 35.06342701222895], [-83.4116985806502, 35.06340507864575], [-83.41163551442568, 35.06339801181018], [-83.41157631365182, 35.06338281197203], [-83.41151718114993, 35.06336761213095], [-83.4114589810993, 35.06335041230748], [-83.41140391437239, 35.06332727871555], [-83.41134431384823, 35.06331301194336], [-83.41128691419652, 35.06329441212157], [-83.41122551434684, 35.063284012219455], [-83.4111645142475, 35.06327241232696], [-83.41109711365172, 35.06327341231778], [-83.41103558085139, 35.06326141169211], [-83.41097451427669, 35.06327301232146], [-83.41091338122666, 35.06328421221754], [-83.41085718082586, 35.06330527892978], [-83.41080211409893, 35.063328278705654], [-83.41074711384736, 35.06335147920835], [-83.41069978071671, 35.06339001189573], [-83.41065318061135, 35.06342987910886], [-83.4106015140078, 35.063459878769464], [-83.41055091370447, 35.06349181221965], [-83.41049578140051, 35.06351487885398], [-83.41043638120068, 35.06352947867498], [-83.41038171422407, 35.0635208787807], [-83.4103259809472, 35.06349861213856], [-83.41028931441225, 35.06345547881993], [-83.41025038142786, 35.06341381163905], [-83.41022838078824, 35.06336641214341], [-83.4102013136504, 35.06332067878045], [-83.41017478101016, 35.06327481230485], [-83.41014698084707, 35.063229478887166], [-83.41012771378085, 35.063181079292605], [-83.41010751426337, 35.06313307893105], [-83.41008031417489, 35.063087479260005], [-83.41006158070795, 35.0630390119346], [-83.41004051431622, 35.062991279135076], [-83.41000391425659, 35.0629488786328], [-83.40997638089314, 35.06290321194736], [-83.40994698083051, 35.06285841214465], [-83.40990031424985, 35.06281947920786], [-83.40985298111919, 35.06278067934025], [-83.40981671433454, 35.062737478730746], [-83.40976611403121, 35.06270341190202], [-83.40971678125076, 35.06266881197186], [-83.4096655143975, 35.0626378120219], [-83.40961851364351, 35.062598478980284], [-83.40956718121326, 35.062567679003614], [-83.40951511396106, 35.06253861210309], [-83.40946058083341, 35.06251421210463], [-83.40940911365583, 35.06248361209618], [-83.40935431372858, 35.062460012081864], [-83.40929898110032, 35.06243687897293], [-83.40924731359844, 35.06240707893664], [-83.40919131442027, 35.062385611991985], [-83.40913818086783, 35.06235827885372], [-83.4090829138166, 35.06233541189308], [-83.40902798093867, 35.0623120118364], [-83.40897291421176, 35.06228867868497], [-83.40891771363587, 35.06226601170544], [-83.40886258133195, 35.062242812364836], [-83.40881118062968, 35.062212079166], [-83.40875991377642, 35.06218101213056], [-83.40870898109644, 35.0621496119936], [-83.40865811399347, 35.062118078755645], [-83.40860691361554, 35.062087011684454], [-83.40855531438564, 35.062056612252356], [-83.40850438080733, 35.062025278979725], [-83.40844911375613, 35.06200227883669], [-83.40839758100151, 35.06197167863638], [-83.40834931362299, 35.06193387910843], [-83.40830191401703, 35.06189461190465], [-83.40826171440803, 35.061853012309946], [-83.40821838057705, 35.061812878883224], [-83.40817071417146, 35.06177427927439], [-83.40814151443314, 35.06172941193971], [-83.40811418139401, 35.06168367913034], [-83.40808771433079, 35.06163787864753], [-83.40807451358768, 35.06158747882177], [-83.4080579809932, 35.06153821206687], [-83.4080481138981, 35.06148661216435], [-83.40803391422843, 35.061436479160605], [-83.40803418102806, 35.061381479146476], [-83.40802098118327, 35.061331079162485], [-83.40800718126387, 35.06128101224068], [-83.40798071420066, 35.06123521226724], [-83.40796278113265, 35.061186279128734], [-83.4079249809238, 35.061143412239986], [-83.40787331432024, 35.061113011721154], [-83.40781771399404, 35.061090678979916], [-83.4077625807918, 35.061067279301795], [-83.40770391361723, 35.06105127901526], [-83.40764471374167, 35.06103621183073], [-83.40758958143775, 35.06101327905739], [-83.40753451381252, 35.06098987935708], [-83.40747971388524, 35.06096607890714], [-83.40742431388337, 35.06094347920874], [-83.40737578060349, 35.06090561229161], [-83.40732891369848, 35.060866012233575], [-83.4072913811876, 35.06082381210228], [-83.4072633807002, 35.06077841188091], [-83.4072343812862, 35.06073341164306], [-83.40721771394442, 35.06068421202126], [-83.40718998115497, 35.06063867936638], [-83.40717771376146, 35.060588012005724], [-83.40714998097201, 35.06054247929703], [-83.40712198138291, 35.06049721201077], [-83.40709351377156, 35.06045201234821], [-83.40705611421133, 35.06040981200296], [-83.40702638087373, 35.06036507921599], [-83.40699911430991, 35.06031961182602], [-83.40696011395185, 35.06027787907222], [-83.40692271439165, 35.06023581172889], [-83.40689471390424, 35.06019041191586], [-83.40685631362076, 35.060148479090174], [-83.40682831403167, 35.060103212320776], [-83.4068001141183, 35.06005801170476], [-83.40677158092993, 35.06001281179902], [-83.40673471407067, 35.059970411955774], [-83.4067143807042, 35.05992247882632], [-83.40668511359225, 35.059877478851995], [-83.40666731437322, 35.059828611813714], [-83.40664098115897, 35.05978281176086], [-83.40661918084366, 35.05973521235621], [-83.40660078065171, 35.059686479060936], [-83.40657251426295, 35.059641278949464], [-83.40654751414858, 35.059595011863], [-83.40651531403725, 35.0595510117446], [-83.40646878130553, 35.05951201178697], [-83.40642158112556, 35.05947327873249], [-83.40637391382164, 35.0594344787452], [-83.40632618094072, 35.05939601184056], [-83.40627831421078, 35.05935741182439], [-83.40623058132984, 35.05931867869646], [-83.40618351410055, 35.05927987863577], [-83.4061365807202, 35.05924101164229], [-83.40610671443196, 35.059196278950274], [-83.40606998142167, 35.05915387868302], [-83.40604171413462, 35.05910867901205], [-83.40601351422123, 35.0590632793076], [-83.4059955811532, 35.059014478696604], [-83.40596658084091, 35.05896947895717], [-83.40594598067479, 35.05892167906954], [-83.40590891438954, 35.0588794117538], [-83.40588071357782, 35.058834078836675], [-83.40585238071377, 35.0587888120739], [-83.40582458144897, 35.05874341219158], [-83.40578611379188, 35.05870167936742], [-83.40575798125212, 35.058656278701314], [-83.40573058083933, 35.05861081183037], [-83.40570358107514, 35.05856507874467], [-83.4056819137105, 35.05851747936542], [-83.40566358089218, 35.058468879173525], [-83.40563778127725, 35.05842281216806], [-83.40561551383796, 35.058375411980656], [-83.40559718101963, 35.058326879354645], [-83.40557811427773, 35.05827841214442], [-83.40556931438121, 35.05822647928197], [-83.40554258141667, 35.05818067906572], [-83.40552978132219, 35.058130079301066], [-83.40550311393466, 35.0580526787779], [-83.4054757808955, 35.058007012295], [-83.4054555140044, 35.05795901183272], [-83.4054269143407, 35.05791387915122], [-83.40539838115231, 35.05786867879389], [-83.40536971411498, 35.05782367915825], [-83.40533291373104, 35.057781211997856], [-83.40529518089585, 35.05773927867023], [-83.40525711388737, 35.05769721222498], [-83.40521098090595, 35.05765767899711], [-83.40516378072599, 35.05761841194263], [-83.40511578104541, 35.05758001183355], [-83.40506451419215, 35.057548479036676], [-83.4050127137396, 35.05751881178313], [-83.40495778086165, 35.05749541181668], [-83.40490278061007, 35.05747167873459], [-83.4048473806082, 35.057449411913275], [-83.4047921809306, 35.05742641195185], [-83.40473711420368, 35.05740307887478], [-83.40467991397797, 35.05738367912697], [-83.40462331382687, 35.05736361168526], [-83.40456391362702, 35.0573492122449], [-83.40450751380021, 35.05732821164722], [-83.40444578067557, 35.0573184786746], [-83.40438451377659, 35.0573076118049], [-83.40432398080114, 35.05729501173466], [-83.40420631407535, 35.05727421187112]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400358462&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 2.93320001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400055396, &quot;drainage_area_sqkm&quot;: 18.7276, &quot;hydroseq&quot;: 25000400060844, &quot;length&quot;: 2.82476951, &quot;name&quot;: &quot;Coweeta Creek&quot;, &quot;new_preorder_index&quot;: 0, &quot;nhdplusid&quot;: 25000400358462, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400064695}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43243331437519, 35.05538681214582, -83.42887071363768, 35.05976361184979], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43243331437519, 35.05538681214582], [-83.43233511414158, 35.055422479225214], [-83.43228038068966, 35.05544607906778], [-83.43222978128465, 35.05547807889318], [-83.43217758108179, 35.05550767923528], [-83.4321297808272, 35.055546478882455], [-83.43208571397093, 35.055586878647034], [-83.43205658070798, 35.0556320118794], [-83.43201818132283, 35.05567367935517], [-83.43198051406465, 35.05571587920693], [-83.43195231415126, 35.05576101163271], [-83.43191451394242, 35.055803012158165], [-83.4318867137793, 35.05584847912192], [-83.43186798121069, 35.05589687865131], [-83.43184758136891, 35.05594487885516], [-83.43182038128045, 35.05599047883876], [-83.43179338061793, 35.056036211895766], [-83.43178118059805, 35.05608687913968], [-83.43175438115817, 35.05613261214264], [-83.4317269807454, 35.056178212021464], [-83.43169718093245, 35.05622287871461], [-83.43167978056542, 35.056271878803344], [-83.43165111442637, 35.05631687929414], [-83.431622780664, 35.056362079039836], [-83.4315947810749, 35.05640747877552], [-83.43155498121625, 35.05644887892394], [-83.43151031428539, 35.0564884120016], [-83.4314629137811, 35.056527278834814], [-83.43142638109514, 35.05656981209328], [-83.43137991394042, 35.05660927893116], [-83.4313325808098, 35.056648411902415], [-83.4312849808795, 35.05668707864515], [-83.43123718062492, 35.05672521224344], [-83.43118511427105, 35.056754879050004], [-83.43113711369216, 35.056793478825874], [-83.4310913139857, 35.05683347868102], [-83.43105378057652, 35.05687561175233], [-83.43101678076661, 35.05691787863461], [-83.43096891403668, 35.056956412152466], [-83.43094098092293, 35.057001679195785], [-83.43090278096378, 35.057043612166886], [-83.43087491432536, 35.05708901225901], [-83.43084718063758, 35.057134479242045], [-83.43081911367484, 35.057179812367465], [-83.43079071433546, 35.05722487927405], [-83.43076898139378, 35.057272411755385], [-83.43074211368196, 35.05731821174588], [-83.43071511391778, 35.05736381169783], [-83.43068791382929, 35.057409479275755], [-83.43067558085876, 35.057460078751646], [-83.43066238101397, 35.057510412003325], [-83.43064758126967, 35.05756027901921], [-83.43064971387015, 35.057615878702165], [-83.43063411372692, 35.05766547872607], [-83.43063258120104, 35.0577206121336], [-83.43063338070164, 35.057776011695836], [-83.43063991414871, 35.05782921182931], [-83.43064838077026, 35.057881211859986], [-83.43066211421434, 35.05793141175644], [-83.43067658068365, 35.057981412346166], [-83.43069078125167, 35.05803147908538], [-83.43069251410188, 35.05808687917198], [-83.43067598060905, 35.05813681201581], [-83.43067358120892, 35.058190811956784], [-83.4306503813184, 35.0582378122303], [-83.43062411368118, 35.05828367932969], [-83.43059731424131, 35.058329411837725], [-83.43056051385739, 35.058371811797784], [-83.43052298134648, 35.05841387936614], [-83.43047431421766, 35.05845127903326], [-83.43042371391434, 35.05848301222668], [-83.43037698085831, 35.058523078904535], [-83.43032558105438, 35.05855327890732], [-83.43027451362711, 35.05858421202249], [-83.43022358094713, 35.05861561206016], [-83.43017258089351, 35.05864701208568], [-83.43011758064195, 35.05867021171266], [-83.43006631378866, 35.058700879329976], [-83.4300117141857, 35.058725012073324], [-83.4299605811814, 35.05875607895317], [-83.42990558092981, 35.0587792116344], [-83.4298505142029, 35.05880227886493], [-83.42979511420101, 35.05882467914691], [-83.42973651440009, 35.05884107915251], [-83.42968171357447, 35.0588646787423], [-83.42962618062194, 35.05888721210144], [-83.4295751805683, 35.0589182789195], [-83.42952418141302, 35.058949478819926], [-83.42947751393399, 35.058989412174874], [-83.42942511430516, 35.0590186788769], [-83.42938298062339, 35.05906007917197], [-83.42934271364078, 35.05910121178782], [-83.42931371422678, 35.05914627910447], [-83.42928571373938, 35.059191611848256], [-83.42924971375436, 35.05923421210402], [-83.42922338143845, 35.05928007864379], [-83.42919638077593, 35.059325678970794], [-83.42917151361225, 35.05937207930326], [-83.42914378082278, 35.05941761192924], [-83.4291165807343, 35.059463079086285], [-83.4290901136711, 35.05950907932591], [-83.42906411373183, 35.059555011890076], [-83.4290309811692, 35.05959867890617], [-83.42899698083401, 35.05964187897063], [-83.42896598087187, 35.059686212139844], [-83.42891871421656, 35.059725012007455], [-83.42887071363768, 35.05976361184979]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;1&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400528468&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.28919999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400060844, &quot;drainage_area_sqkm&quot;: 7.3074, &quot;hydroseq&quot;: 25000400079665, &quot;length&quot;: 0.61879195, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 1, &quot;nhdplusid&quot;: 25000400528468, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400098811}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43243331437519, 35.04767261202763, -83.42994998106106, 35.05538681214582], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43037331393532, 35.04767261202763], [-83.43035838124035, 35.04773761205547], [-83.43037431376025, 35.04778721219576], [-83.43037291418503, 35.04784267880181], [-83.43038691442872, 35.04789281206203], [-83.43040131442272, 35.047942679067525], [-83.43040638092094, 35.047996012100256], [-83.43041318116765, 35.0480486118801], [-83.430427314362, 35.04809867882571], [-83.43044198115564, 35.048148611893666], [-83.43045451355216, 35.048199211959826], [-83.4304549142008, 35.04825401199318], [-83.4304539808512, 35.0483092120594], [-83.4304693141948, 35.04835901188728], [-83.43046818141922, 35.04841421188257], [-83.43046731364664, 35.04846947876379], [-83.43048278083921, 35.04851907919512], [-83.43048098061539, 35.04857461222734], [-83.43049478143308, 35.048624811961496], [-83.43050851397886, 35.04867507932339], [-83.43052178119729, 35.04872547902955], [-83.43053498104209, 35.04877587870472], [-83.43054971431103, 35.04882567898349], [-83.43056918080325, 35.04887401207491], [-83.4305889140951, 35.04892207891704], [-83.4305885808201, 35.04897721234435], [-83.43060318113844, 35.04902721179803], [-83.43061758113244, 35.04907707884634], [-83.43063091392789, 35.049127479039875], [-83.430629580828, 35.04918287928393], [-83.43064298099709, 35.04923327867677], [-83.43065811401638, 35.04928307867666], [-83.43065978128953, 35.04933781179574], [-83.43066058079015, 35.04939307878742], [-83.43065998071552, 35.04944841192882], [-83.43065831434068, 35.04950301182757], [-83.43064478122092, 35.04955327864893], [-83.43063178080213, 35.04960367928408], [-83.43061311381052, 35.04965227886906], [-83.43059351436766, 35.049700412175376], [-83.43057571425031, 35.0497492786563], [-83.43055131421056, 35.04979581165614], [-83.43052798136937, 35.04984267924014], [-83.43049938080735, 35.04988781197024], [-83.43048178101431, 35.049936679074435], [-83.43045338077658, 35.04998187867451], [-83.43043251381089, 35.0500296117254], [-83.4304055140467, 35.05007527899246], [-83.43037811363388, 35.05012087931202], [-83.43035011404478, 35.050166211918565], [-83.43032178118074, 35.05021147904893], [-83.43029338094304, 35.05025661231058], [-83.4302731140519, 35.050304612152644], [-83.43023631366798, 35.05034687875894], [-83.43020791432859, 35.05039221197547], [-83.43017978089053, 35.05043747898061], [-83.43015211367806, 35.05048287906845], [-83.43011391371894, 35.05052481170995], [-83.43008598060517, 35.050570078641556], [-83.43005871404135, 35.05061561176336], [-83.43003931402448, 35.05066401218785], [-83.4300197136833, 35.05071207871201], [-83.42999251359481, 35.050757678675964], [-83.42998011414895, 35.05080841170394], [-83.42995351413505, 35.050854079270884], [-83.42995091441063, 35.05090841201565], [-83.42994998106106, 35.05096367868004], [-83.42995038081135, 35.05101887912112], [-83.42995218103519, 35.0510738118404], [-83.42996738142811, 35.05112361218889], [-83.42998131429816, 35.051173678720474], [-83.42998991387039, 35.05122567931245], [-83.43000631441254, 35.05127501185685], [-83.43001998138125, 35.05132527905838], [-83.43004718057144, 35.05137101178649], [-83.43006091401548, 35.05142121200806], [-83.4300749807345, 35.051471279092645], [-83.43009438075138, 35.05151947898319], [-83.43010298122195, 35.05157147935494], [-83.43011571394275, 35.05162207877133], [-83.43011611369306, 35.05167687871442], [-83.43011571394275, 35.05173187864705], [-83.43011491444216, 35.05178707930434], [-83.43011431436754, 35.051842279189025], [-83.4301141814169, 35.05189721208984], [-83.43011511386814, 35.05195181182234], [-83.43012911411186, 35.052002011687], [-83.43014231395664, 35.052052412281775], [-83.43015518142477, 35.05210287903039], [-83.43018138079003, 35.052148879004115], [-83.43019558135805, 35.05219901182738], [-83.43021918099888, 35.05224567874259], [-83.43023631366798, 35.052294879036744], [-83.4302563811331, 35.0523428791517], [-83.43027611442496, 35.0523910792632], [-83.43029398101764, 35.05244001178966], [-83.43031771360913, 35.05248681167174], [-83.43033191417715, 35.05253687883841], [-83.43034318084743, 35.05258787917616], [-83.4303707142109, 35.05263341190832], [-83.43039811372536, 35.05267887916609], [-83.43041831414116, 35.052727012159494], [-83.43043738088308, 35.052775278964056], [-83.43046511367254, 35.05282087924692], [-83.43049331358591, 35.05286607872162], [-83.43052158087296, 35.05291141201052], [-83.43055891395785, 35.05295361181895], [-83.4305889140951, 35.05299821188557], [-83.430625913905, 35.05304061167241], [-83.43065438061805, 35.05308581176086], [-83.43069271442617, 35.053127612168595], [-83.43073998108147, 35.05316641221117], [-83.43078671413751, 35.053205279154746], [-83.43082378132107, 35.053247478811365], [-83.430871713628, 35.05328601185511], [-83.43095998118949, 35.05336847922889], [-83.43103091396095, 35.053449211767834], [-83.43107898101519, 35.05348781163548], [-83.43111731392499, 35.05352967875659], [-83.43115518060917, 35.05357161203991], [-83.43119231426806, 35.05361381224257], [-83.4312299141526, 35.05365601168812], [-83.43126798116107, 35.053697678701305], [-83.43130711357148, 35.053739278774245], [-83.43134778120272, 35.05378041186436], [-83.43139198100963, 35.053820211703446], [-83.4314291137702, 35.053862411777565], [-83.43146618095379, 35.05390467874886], [-83.4315043144376, 35.05394661183965], [-83.43154191432212, 35.05398867874633], [-83.43159078087695, 35.05402687905282], [-83.43162718061225, 35.054069412142944], [-83.43167511381752, 35.054108011717496], [-83.4317231143964, 35.05414641198867], [-83.43175958060705, 35.0541888788333], [-83.431807114062, 35.05422767910699], [-83.43185551439119, 35.05426587930169], [-83.43190251424684, 35.05430481190512], [-83.43194031355738, 35.05434681170887], [-83.4319781137662, 35.05438887914486], [-83.4320161807747, 35.05443081198698], [-83.43205431425852, 35.054472811725944], [-83.43208131402268, 35.05451827869495], [-83.43212018143008, 35.05456001218652], [-83.43215211384347, 35.05460401205302], [-83.43217711395785, 35.0546504121272], [-83.43220498059628, 35.054695812079174], [-83.43222398086284, 35.054744212291766], [-83.43225271437554, 35.054789412172624], [-83.43227178111742, 35.05483767922895], [-83.43229898120592, 35.05488341219621], [-83.43231271375167, 35.054933678647465], [-83.43232471434554, 35.05498441202275], [-83.43233878106459, 35.05503447912891], [-83.4323563143823, 35.0550834791954], [-83.43238031377342, 35.055130279033314], [-83.43239331419223, 35.05518067916824], [-83.43240551421212, 35.055231411654695], [-83.43241471385893, 35.05528327876899], [-83.43241911380719, 35.055336679073484], [-83.43243331437519, 35.05538681214582]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;2&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400488802&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.6488, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400079665, &quot;drainage_area_sqkm&quot;: 0.6488, &quot;hydroseq&quot;: 25000400181333, &quot;length&quot;: 0.9449289300000001, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 2, &quot;nhdplusid&quot;: 25000400488802, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43474011436295, 35.053870011847884, -83.43243331437519, 35.05539827932355], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43474011436295, 35.053870011847884], [-83.43466078144526, 35.05392467865099], [-83.43460558086937, 35.05394767886338], [-83.43455431401613, 35.05397847915048], [-83.43450338133613, 35.05400967873222], [-83.43445518133127, 35.05404761208937], [-83.43440778082696, 35.05408667863425], [-83.43436178079621, 35.05412641214077], [-83.43432431386235, 35.05416861205675], [-83.43428771380272, 35.054211078889814], [-83.43424131402166, 35.05425087925438], [-83.4341929810661, 35.05428901178427], [-83.43414131356424, 35.054319011862155], [-83.43409471435719, 35.05435881217412], [-83.4340431807043, 35.05438901224636], [-83.43399631379928, 35.05442847866751], [-83.43394138092134, 35.054452011878915], [-83.43389438106567, 35.05449101204739], [-83.43384158078823, 35.0545184787146], [-83.43379158055951, 35.0545518790402], [-83.43373718128085, 35.05457627921218], [-83.43368191422964, 35.05459901230338], [-83.43362711430233, 35.05462247928275], [-83.43357231437507, 35.05464607935652], [-83.4335175144478, 35.05467001180834], [-83.43345791392366, 35.05468447863926], [-83.43340298104572, 35.05470781175779], [-83.43334818111842, 35.0547312117878], [-83.43329631419056, 35.054760811665226], [-83.43324211433789, 35.05478561181269], [-83.43319538128186, 35.05482547881527], [-83.43314291427937, 35.054854679356325], [-83.43309918069808, 35.05489561186599], [-83.43305938083941, 35.054936812026874], [-83.43302131383093, 35.05497867914041], [-83.43299338071718, 35.05502407890988], [-83.43296638095299, 35.055069811772796], [-83.43293638081578, 35.05511447907221], [-83.43289978075616, 35.05515687923094], [-83.43286278094622, 35.05519947865032], [-83.43281591404123, 35.055238879232775], [-83.43276791436065, 35.0552772789721], [-83.4327161139081, 35.05530727868696], [-83.43266531417878, 35.05533921164922], [-83.43261051425151, 35.05536261223364], [-83.432550981101, 35.0553770789419], [-83.43249478070018, 35.05539827932355], [-83.43243331437519, 35.05538681214582]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;3&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400456886&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.12059999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400079665, &quot;drainage_area_sqkm&quot;: 6.36940001, &quot;hydroseq&quot;: 25000400098811, &quot;length&quot;: 0.27669397, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 3, &quot;nhdplusid&quot;: 25000400456886, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400129735}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45039378100823, 35.04417447904634, -83.43474011436295, 35.053870011847884], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45039378100823, 35.04417447904634], [-83.45029318137452, 35.04418501229414], [-83.45023251365181, 35.04419687892801], [-83.45017078142548, 35.04420707900999], [-83.45011551437426, 35.04422987897235], [-83.4500597810974, 35.0442518118226], [-83.45000498117011, 35.0442754119513], [-83.44995391374285, 35.04430627913529], [-83.44989871406527, 35.04432941223242], [-83.44984798081128, 35.04436101191185], [-83.44978878093573, 35.0443758791869], [-83.44973171366068, 35.044395279082956], [-83.44966431396323, 35.04439387877216], [-83.44960391393847, 35.04440667867092], [-83.44953631391671, 35.04440487900701], [-83.4494757809413, 35.04441887917011], [-83.44941431371798, 35.04440581230229], [-83.44934798121908, 35.044405012124756], [-83.44928091389828, 35.04440587922889], [-83.44921358067616, 35.044407011833], [-83.44914691400399, 35.04440667867089], [-83.44908638102855, 35.04439427886096], [-83.44901871363317, 35.0443960792605], [-83.44895818065774, 35.04438347866902], [-83.44889331420939, 35.04438861216191], [-83.44882971438558, 35.0443952121563], [-83.44876918141016, 35.04440727880401], [-83.44870498061343, 35.0444124792219], [-83.44864178143825, 35.044419411641115], [-83.44858358138762, 35.044436411730686], [-83.44852018098982, 35.04444307864786], [-83.44846191356554, 35.044459878688386], [-83.44840178123877, 35.044473278709376], [-83.44834011369112, 35.0444834118303], [-83.448280313741, 35.04449721193574], [-83.44822331383956, 35.04451641175891], [-83.44816711433707, 35.044537478900494], [-83.44811218056081, 35.04456067885858], [-83.44806131435617, 35.04459201221364], [-83.44800611378028, 35.044615212156316], [-83.4479581140997, 35.04465261225921], [-83.44791031384511, 35.04469127879793], [-83.44786311366514, 35.04473041233181], [-83.4478167138841, 35.04476987900759], [-83.44778011382446, 35.04481247869669], [-83.44774158059036, 35.044854211999635], [-83.44770391423049, 35.044896212250684], [-83.44767711389231, 35.04494201182748], [-83.4476393810571, 35.04498401203336], [-83.44760131404863, 35.04502601221766], [-83.44755538139152, 35.045065878836155], [-83.44750711401299, 35.04510407890339], [-83.44745578068438, 35.04513487884827], [-83.44740451383115, 35.0451656118556], [-83.44734898087859, 35.04518781215849], [-83.44728731422927, 35.045197879000305], [-83.44722598085492, 35.04520867908452], [-83.44716498075556, 35.04521987925203], [-83.44710431393116, 35.04523227893675], [-83.44703691423372, 35.04523101175667], [-83.44697251401101, 35.04523581203751], [-83.4469097136878, 35.045244079228006], [-83.44684271374065, 35.04524507870415], [-83.44677551436752, 35.0452452787464], [-83.44670838057138, 35.045244479312636], [-83.4466425142981, 35.045242411963514], [-83.44658071379985, 35.04523227893671], [-83.4465249814213, 35.04521041180473], [-83.44646358067332, 35.04519967864676], [-83.4464071808465, 35.04517901176087], [-83.44634731442102, 35.04516547873909], [-83.4462807806995, 35.045165078654065], [-83.44621938084984, 35.04515467864915], [-83.44615171435274, 35.04515627898939], [-83.44608818100427, 35.04514841187521], [-83.44602918055473, 35.04515721227607], [-83.4459707810781, 35.04514947901395], [-83.44590758100462, 35.04515661214846], [-83.445845714031, 35.04516647895159], [-83.44578578113017, 35.045179811930794], [-83.44572891417943, 35.04519927929729], [-83.44567331385323, 35.0452214788556], [-83.44561758057638, 35.045243479101025], [-83.44556231442347, 35.04526601180601], [-83.44550331397393, 35.04528147904303], [-83.44544871437095, 35.04530527891625], [-83.44539371411938, 35.045328878740555], [-83.44533878124143, 35.04535241236765], [-83.44528418074015, 35.04537641226233], [-83.44522851393863, 35.045398211688656], [-83.44517251386212, 35.045419678686564], [-83.44511718123388, 35.045442012036546], [-83.44506131410806, 35.04546367906468], [-83.44500551435586, 35.045485479203165], [-83.44494998140331, 35.04550767868369], [-83.44489431370349, 35.045529811967995], [-83.44483891370159, 35.045552412255034], [-83.44478111429957, 35.0455698121919], [-83.4447263143723, 35.04559381202267], [-83.44466618114718, 35.04560667865908], [-83.44460491424817, 35.04561761180512], [-83.44454931392198, 35.04563987891069], [-83.44448858062225, 35.04565167914311], [-83.44442751404756, 35.04566287925], [-83.4443651808483, 35.04567187890122], [-83.44429858065145, 35.04567241209945], [-83.44423818062671, 35.04568541183914], [-83.44417138100386, 35.04568667901214], [-83.4441039813064, 35.045686612086584], [-83.4440373137359, 35.045685278723504], [-83.44397678076048, 35.04567267906632], [-83.44390958138733, 35.04567347923137], [-83.44384231374222, 35.04567461181798], [-83.44378191371747, 35.04566201215919], [-83.44371478081965, 35.04566281232431], [-83.44364758144651, 35.04566367867961], [-83.44358718142176, 35.04565101209355], [-83.4435195814, 35.04565287865558], [-83.44345898105092, 35.04564067907612], [-83.44339231437877, 35.04564047903482], [-83.44332478083233, 35.04564201170449], [-83.44325838095978, 35.04564147924151], [-83.44319771413538, 35.04562867880077], [-83.44313011411361, 35.04562801175105], [-83.44306338096611, 35.045629879048995], [-83.44300278061705, 35.04564227867145], [-83.4429351805953, 35.04564067907608], [-83.44287478057052, 35.04565347877952], [-83.44280718144708, 35.04565181225878], [-83.4427471811726, 35.04566507896868], [-83.44267978057687, 35.04566381179529], [-83.44260498055809, 35.045681811832246], [-83.44254578068256, 35.04569681198257], [-83.44248698055732, 35.045712479179166], [-83.44243258127865, 35.04573687905027], [-83.44237698095246, 35.045759079197886], [-83.44232611384949, 35.045790479018756], [-83.44227438077058, 35.04582067931767], [-83.44222631371638, 35.04585927911349], [-83.44218658123137, 35.045901211922455], [-83.44214231405078, 35.04594107884925], [-83.44210591431548, 35.045983611737675], [-83.44207778087741, 35.04602867893939], [-83.44203958091826, 35.046070811701576], [-83.44201178075517, 35.04611607889531], [-83.44197431382129, 35.046158212347954], [-83.44193638066182, 35.04620021192855], [-83.44189878077727, 35.04624221222295], [-83.44186131384339, 35.04628447872517], [-83.44181418103706, 35.046324012310706], [-83.44176238058452, 35.04635367921853], [-83.44171358140335, 35.04638921198032], [-83.44166358117464, 35.0464226788783], [-83.44160918099765, 35.04644701234778], [-83.4415579141444, 35.04647767867196], [-83.44150231381819, 35.046499679314444], [-83.44144471384219, 35.04651807924556], [-83.44138491389202, 35.04653201212159], [-83.4413267138414, 35.04654847931448], [-83.44126871411507, 35.04656581211444], [-83.44120698099043, 35.04657627886447], [-83.44114591441574, 35.04658741191977], [-83.44108698133985, 35.046602811981714], [-83.44102851359126, 35.04661941227454], [-83.4409679141405, 35.0466314793291], [-83.4409105135905, 35.04665007926937], [-83.4408557136632, 35.04667347866637], [-83.44080051398562, 35.046696678753264], [-83.44074551373404, 35.04671987883362], [-83.44069458105407, 35.04675121209593], [-83.4406427141262, 35.04678107888718], [-83.44059458059664, 35.04681961204001], [-83.44054831376624, 35.04685941232947], [-83.44051218083058, 35.046902079324326], [-83.44046418115, 35.046940611684605], [-83.44041638089543, 35.046979211686704], [-83.44038031443507, 35.04702201173246], [-83.44033411408002, 35.04706147877193], [-83.44028651414973, 35.04710061190585], [-83.44023838062019, 35.047138611719305], [-83.4401867140166, 35.04716847910426], [-83.44013891376203, 35.04720667892368], [-83.44009131383176, 35.047245478837404], [-83.44004418102543, 35.04728481192052], [-83.43999778124437, 35.04732421190887], [-83.43996171388571, 35.04736687866088], [-83.43991318060587, 35.04740521223575], [-83.43987958091928, 35.047448679093264], [-83.43983911361238, 35.04748981167442], [-83.43981298072245, 35.04753581203996], [-83.43978251435958, 35.047580212086885], [-83.43975378084689, 35.04762521221914], [-83.4397341140304, 35.04767347909705], [-83.43970691394189, 35.04771901236278], [-83.43967898082815, 35.047764478679326], [-83.43964071439363, 35.04780641198104], [-83.4396131810302, 35.047851812060486], [-83.43957478074675, 35.04789367912909], [-83.43954691410833, 35.04793901223631], [-83.43950118087722, 35.047978678868446], [-83.43945398069724, 35.04801807925754], [-83.43940598101668, 35.048056211756005], [-83.43935451383908, 35.048086611987934], [-83.43930358115912, 35.04811807930854], [-83.43925271405615, 35.04814927892284], [-83.43920138072755, 35.048180079190374], [-83.43914638137427, 35.04820327884942], [-83.43909118079839, 35.04822621227876], [-83.4390363143958, 35.04824947884811], [-83.4389787808951, 35.048267879120544], [-83.43892271434326, 35.04828921225289], [-83.4388633141434, 35.04830381185475], [-83.43880638071734, 35.04832347924691], [-83.43875071391582, 35.04834507932292], [-83.43869898083693, 35.04837501171924], [-83.43864498130856, 35.04840041170338], [-83.43858918065806, 35.04842201175902], [-83.43853791380481, 35.04845247877808], [-83.43848351362782, 35.04847687930155], [-83.43843138079862, 35.04850621228206], [-83.4383833137444, 35.04854407906597], [-83.43833571381411, 35.048583079114074], [-83.43828931403306, 35.048622679245625], [-83.43825251364915, 35.04866507909778], [-83.43822758090842, 35.048711478869144], [-83.43820511404316, 35.048758678749024], [-83.4381863141009, 35.04880721191373], [-83.43817311425612, 35.048857479163296], [-83.43815991441134, 35.048907878757], [-83.43814711431685, 35.04895841216527], [-83.43812111437758, 35.0490044117038], [-83.43809378133844, 35.049050078808584], [-83.4380651807764, 35.049095078866486], [-83.43802698081727, 35.04913701222052], [-83.43798898118244, 35.04917901174034], [-83.43795118097358, 35.049221011973984], [-83.43791331428942, 35.04926301218595], [-83.43787711398014, 35.04930621183525], [-83.43782431370265, 35.049335212111274], [-83.43777671377238, 35.049374278704065], [-83.4377411809113, 35.04941747902995], [-83.43770231440223, 35.04945907907696], [-83.43766738071746, 35.04950207932596], [-83.43762771380946, 35.04954347929808], [-83.4375997806957, 35.04958881222515], [-83.43756158073657, 35.04963067913879], [-83.43753371409814, 35.049676078939676], [-83.43750758120821, 35.04972201188718], [-83.43748551409327, 35.049769411949754], [-83.4374683140505, 35.04981841223367], [-83.43745438118046, 35.04986847882994], [-83.43744151371232, 35.049918879270564], [-83.43742971434105, 35.04996981211485], [-83.43741538082239, 35.05001981169632], [-83.4374021809776, 35.05007007893506], [-83.43738378078564, 35.050118678977846], [-83.43736198136864, 35.05016621191857], [-83.43733618085534, 35.0502122791695], [-83.43730871396723, 35.050257811755365], [-83.43728218132702, 35.050303612002935], [-83.4372521811898, 35.050348278967675], [-83.43720431356155, 35.05038687883024], [-83.43716631392671, 35.05042867914854], [-83.43713678091343, 35.05047347915279], [-83.43710071355477, 35.05051621191674], [-83.43707018071657, 35.05056067873593], [-83.4370291807087, 35.050601678848494], [-83.43698898109973, 35.05064281204802], [-83.43695111441556, 35.0506848122643], [-83.43690331416097, 35.050723411967795], [-83.43685518063143, 35.05076187928099], [-83.43680858142437, 35.050801012112814], [-83.43677638131302, 35.05084487869114], [-83.43674238097782, 35.05088821208172], [-83.4367145143394, 35.050933478811814], [-83.4366857143514, 35.050978679331095], [-83.43666951413356, 35.051027878917765], [-83.43665718116303, 35.051078611777804], [-83.43664438106856, 35.05112907912826], [-83.43662071405406, 35.051175812105136], [-83.4365929812646, 35.05122141181026], [-83.43655438065686, 35.05126307933025], [-83.43651691372298, 35.05130521233406], [-83.43648071431198, 35.05134841163854], [-83.43642831378483, 35.051377678873045], [-83.43638158072879, 35.051417479147695], [-83.43633471382378, 35.051456611665344], [-83.43628278131891, 35.05148641202137], [-83.43623478074002, 35.0515246789483], [-83.43618738113405, 35.05156387907074], [-83.436141180779, 35.051603412307095], [-83.43610371384511, 35.051645678976826], [-83.43607038095818, 35.05168921196903], [-83.4360387144461, 35.05173327883204], [-83.43600978060911, 35.05177827888239], [-83.43599111361752, 35.05182681172356], [-83.43596378057836, 35.05187241180062], [-83.43595131375885, 35.05192301176596], [-83.4359251143936, 35.05196901184095], [-83.43590718132559, 35.05201767914496], [-83.43588531363662, 35.05206501169031], [-83.43584918070096, 35.0521076789074], [-83.43583138058358, 35.052156479233886], [-83.43580371426945, 35.05220181218137], [-83.43576538135966, 35.05224367922628], [-83.43573778062255, 35.052289279070564], [-83.43571098118268, 35.052335011994195], [-83.43568171407071, 35.05237987934355], [-83.4356439138619, 35.05242187866653], [-83.435606381351, 35.05246401180797], [-83.43556558076912, 35.05250501170038], [-83.43552498140984, 35.05254601230768], [-83.4354827138791, 35.052586612110176], [-83.4354453807942, 35.05262867898219], [-83.43540738115938, 35.05267067891265], [-83.43537918124596, 35.05271587920578], [-83.43534238086204, 35.0527582791392], [-83.43530371377896, 35.052800012059365], [-83.43527651369047, 35.05284561232837], [-83.43523778103037, 35.052887279019714], [-83.43520991439193, 35.05293261229687], [-83.43518151415421, 35.05297781170973], [-83.43516391436118, 35.0530268122749], [-83.43513971374745, 35.053073411797705], [-83.43511578083161, 35.053120078948645], [-83.43509811366492, 35.05316887867016], [-83.43507858069738, 35.05321721213298], [-83.43505858060591, 35.05326507933782], [-83.43504678123465, 35.0533160123015], [-83.43502131399634, 35.053362212349676], [-83.43500291380437, 35.05341067880119], [-83.43498578113528, 35.05345987912877], [-83.43496618079409, 35.05350787929435], [-83.43492758108465, 35.05354967875059], [-83.43490998129158, 35.05359861205363], [-83.43487258083306, 35.053640679139626], [-83.43484591434385, 35.05368647896087], [-83.43482011383058, 35.053732611880555], [-83.43478791371922, 35.05377647909031], [-83.43475318125708, 35.053819611639454], [-83.43474011436295, 35.053870011847884]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;4&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400431661&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 2.11090002, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400098811, &quot;drainage_area_sqkm&quot;: 3.93380001, &quot;hydroseq&quot;: 25000400129735, &quot;length&quot;: 1.9703628199999998, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 4, &quot;nhdplusid&quot;: 25000400431661, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400194442}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45167778077305, 35.0370720793672, -83.45039378100823, 35.04417447904634], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45152458118619, 35.0370720793672], [-83.45153731390702, 35.037141411967205], [-83.45155091440044, 35.03719167904002], [-83.45156458136918, 35.03724187914936], [-83.45157858071455, 35.03729201229546], [-83.45159278128259, 35.03734207921392], [-83.45160591375371, 35.03739247929243], [-83.45160458065384, 35.03744787866866], [-83.45161998137105, 35.03749761230133], [-83.45162178069657, 35.03755241215829], [-83.45162258109548, 35.037607679032774], [-83.45162218134517, 35.03766287893773], [-83.45162071439634, 35.037717678683954], [-83.45160558137705, 35.037767479084415], [-83.45160671415263, 35.037822678881376], [-83.45160731422723, 35.03787767931628], [-83.451591714084, 35.037927478883745], [-83.45159058130844, 35.03798261164076], [-83.4515915137597, 35.0380380120879], [-83.45160411442819, 35.03808901191669], [-83.45160738070257, 35.03814267868615], [-83.45161231425013, 35.03819601223285], [-83.45162151389694, 35.03824781220084], [-83.45162038112137, 35.03830307934049], [-83.45163558061599, 35.038352811717125], [-83.4516337139168, 35.03840841197227], [-83.45164931406002, 35.03845801189289], [-83.45164771416052, 35.038513478949106], [-83.45166151407992, 35.03856367898203], [-83.45166198120384, 35.03861841192815], [-83.45166198120384, 35.038673411827425], [-83.45167558079895, 35.03872367869323], [-83.45167638119786, 35.03877881164869], [-83.45167711422312, 35.03883387910664], [-83.45167771429773, 35.03888887886088], [-83.45167778077305, 35.03894381164695], [-83.45167718069845, 35.03899827882089], [-83.45166211415452, 35.03904807917644], [-83.45166411380434, 35.03910347890121], [-83.45164898078505, 35.03915327919258], [-83.45163611421525, 35.03920381201568], [-83.45162451426998, 35.03925461179536], [-83.45161098115022, 35.039304879039136], [-83.45158271386319, 35.039350211764166], [-83.4515699137687, 35.03940067900577], [-83.45155691424821, 35.03945107928548], [-83.45154331375483, 35.0395012118117], [-83.45152978063507, 35.03955147890371], [-83.45153091430896, 35.0396066789665], [-83.45151511384142, 35.03965667900725], [-83.45151538064106, 35.03971241223616], [-83.45153131405925, 35.039762212156404], [-83.45153118110859, 35.03981707889602], [-83.4515317811832, 35.0398718786685], [-83.45154438095338, 35.039922478712946], [-83.451559381022, 35.039972279240594], [-83.45155798144678, 35.04002767907425], [-83.45157171399254, 35.040078012037114], [-83.45157311356775, 35.04013247919045], [-83.45157411429096, 35.04018721182131], [-83.45157478084093, 35.040242012080995], [-83.45157538091551, 35.04029701235836], [-83.45157591361648, 35.04035207879307], [-83.4515761139408, 35.040407078996346], [-83.45157618131442, 35.04046221228678], [-83.4515761139408, 35.040517211680374], [-83.45157591361648, 35.0405722117725], [-83.45157538091551, 35.040627078703615], [-83.45157478084093, 35.040681811738665], [-83.45157391396666, 35.04073647927837], [-83.45155978077229, 35.04078641169809], [-83.45155738137217, 35.04084047900852], [-83.45153318075842, 35.04088707886449], [-83.45152878081015, 35.04094041209079], [-83.45150891366933, 35.04098847918832], [-83.45149498079928, 35.041038612242126], [-83.4514713137848, 35.04108547896687], [-83.45145398079138, 35.041134479311665], [-83.45144198109583, 35.041185079309734], [-83.45141391413308, 35.0412306117792], [-83.45140211386351, 35.04128127864677], [-83.45138791419382, 35.04133141225645], [-83.45136891392725, 35.041379679175755], [-83.45136051378103, 35.041431611718984], [-83.45134898120939, 35.0414826793005], [-83.45133531424067, 35.04153281205113], [-83.4513221143959, 35.041583211751075], [-83.45132318069615, 35.04163841191217], [-83.4513097140517, 35.04168861223155], [-83.45129658068225, 35.04173901183548], [-83.45128311403784, 35.04178921209302], [-83.45126691381998, 35.041838612117076], [-83.45124731437713, 35.04188667868616], [-83.45122898066049, 35.04193547923552], [-83.45120218122062, 35.04198121207259], [-83.45118998120074, 35.04203201233186], [-83.45116298143657, 35.04207747887173], [-83.45115051371873, 35.04212821214263], [-83.45112458115311, 35.04217421185008], [-83.45109691394069, 35.04221967904632], [-83.45108418121987, 35.042270212179325], [-83.45105858103088, 35.04231627873515], [-83.45104318121197, 35.0423658792253], [-83.4510311806181, 35.04241667924538], [-83.4510133140254, 35.042465411814476], [-83.4509897808599, 35.04251227919174], [-83.45097778116434, 35.04256301219265], [-83.45096458131955, 35.042613411992626], [-83.45094791397777, 35.04266261220523], [-83.45092771356197, 35.04271047897645], [-83.45090998081825, 35.04275941215416], [-83.45091058089287, 35.04281441220777], [-83.45089898094761, 35.042865278876796], [-83.45088511365456, 35.042915412249975], [-83.45087138110883, 35.04296561178471], [-83.45085758118941, 35.04301581202399], [-83.45084438134464, 35.04306607916015], [-83.45083111412622, 35.04311641172215], [-83.45081798075675, 35.043166878843806], [-83.45080611401187, 35.04321767910132], [-83.45079691436503, 35.04326927878026], [-83.4507915810672, 35.04332241187547], [-83.45079351424167, 35.04337787930685], [-83.45077831384874, 35.04342747915242], [-83.45077938104733, 35.04348281192222], [-83.4507665135792, 35.043533278817605], [-83.4507519141592, 35.043583211734344], [-83.45074011388961, 35.043633879349386], [-83.45072731379513, 35.043684279224195], [-83.45070398095395, 35.043731279021074], [-83.45068598141059, 35.043780012277], [-83.4506595808227, 35.043825878671015], [-83.45063258105853, 35.04387167884787], [-83.4506097809183, 35.04391881165546], [-83.4505823814038, 35.04396421168927], [-83.45054391374671, 35.0440058792341], [-83.45051671365825, 35.04405161164768], [-83.450468581027, 35.04409007916118], [-83.45042011422248, 35.04412847899429], [-83.45039378100823, 35.04417447904634]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;5&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400383591&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.5893999900000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400129735, &quot;drainage_area_sqkm&quot;: 0.5893999900000001, &quot;hydroseq&quot;: 25000400227570, &quot;length&quot;: 0.8189864000000001, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 5, &quot;nhdplusid&quot;: 25000400383591, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46066098122498, 35.03353921194884, -83.45039378100823, 35.044187812187396], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46066098122498, 35.03353921194884], [-83.4605997808013, 35.03362181179831], [-83.46056798133854, 35.03366567877498], [-83.4605353805786, 35.03370947879273], [-83.46048691377406, 35.033748012226425], [-83.46044958068919, 35.03379007923767], [-83.46041211375528, 35.03383227936233], [-83.4603739811698, 35.03387407932483], [-83.46033631391163, 35.033916079335945], [-83.46029958090132, 35.03395847872988], [-83.46026171421717, 35.0340004786977], [-83.46021478083682, 35.03403947906872], [-83.46016691410692, 35.03407807928187], [-83.4601307137976, 35.03412061172631], [-83.46008198109175, 35.03415887869722], [-83.46004558135643, 35.03420141183509], [-83.45999758077754, 35.034240011971754], [-83.45995978056872, 35.034282011794865], [-83.45992931420585, 35.034326411689456], [-83.45989498059569, 35.03436967881667], [-83.4598563144109, 35.03441127917095], [-83.4598283139235, 35.03445681173745], [-83.45980831383201, 35.03450467890267], [-83.45979578143549, 35.034555411726885], [-83.45978218094209, 35.03460547885099], [-83.4597553806039, 35.03465141218126], [-83.45974331443301, 35.03470201178083], [-83.45971611434452, 35.03474767878986], [-83.45969771415255, 35.03479621218744], [-83.45967591383723, 35.03484367901835], [-83.45966051401831, 35.03489327889615], [-83.45963578070362, 35.0349396791341], [-83.45962278118311, 35.03499007922329], [-83.45961038083894, 35.035040811746185], [-83.45959778106877, 35.035091278707256], [-83.45958458122398, 35.035141678702836], [-83.45957098073058, 35.03519187933608], [-83.45955731376185, 35.03524207920288], [-83.4595435812161, 35.035292279038856], [-83.45953011367335, 35.03534241191], [-83.45951671440258, 35.035392811750775], [-83.45950371398378, 35.03544321229601], [-83.45949118068894, 35.035493879074764], [-83.45949198108787, 35.03554881193665], [-83.45947771404452, 35.035598812253745], [-83.45947731429422, 35.03565361191306], [-83.45947911361974, 35.035709078666365], [-83.45947891419374, 35.035763812053574], [-83.45946391412512, 35.03581347904205], [-83.45945351432908, 35.03586481198506], [-83.45945258097949, 35.035919412136415], [-83.45943971440968, 35.035969812356896], [-83.45942511409139, 35.036019679285026], [-83.45941178129593, 35.03607001177469], [-83.4593991141521, 35.03612047883567], [-83.45938851403176, 35.03617181232147], [-83.45937218086327, 35.036221212064135], [-83.45935938076877, 35.036271612098425], [-83.45934578117368, 35.03632181203754], [-83.45933318140354, 35.03637241207385], [-83.45933318140354, 35.03642721194987], [-83.45930751384091, 35.036521078644675], [-83.4592933141712, 35.03657107910247], [-83.45927958072713, 35.03662121192457], [-83.45927398062966, 35.03667421179967], [-83.45926818110618, 35.03672701231267], [-83.45925338136189, 35.036776878778724], [-83.4592543811868, 35.03683201231206], [-83.45924071421807, 35.036882078776905], [-83.45923778121866, 35.036936078796], [-83.45922791412357, 35.036987478702116], [-83.45921731400321, 35.03703881164323], [-83.45921591442801, 35.03709307928925], [-83.45920071403509, 35.03714267927266], [-83.45920078140873, 35.037197611761734], [-83.45918918056516, 35.037248478985646], [-83.45917438082084, 35.03729841206588], [-83.45917538064576, 35.0373534790505], [-83.45917651431967, 35.037408679127225], [-83.45916118097608, 35.03745827891912], [-83.45916271440026, 35.037513678986265], [-83.45916331357655, 35.037568812022464], [-83.45914871415654, 35.03761861177818], [-83.45914498075821, 35.03767207879568], [-83.45913558078709, 35.037723879095864], [-83.45911618077022, 35.037772012075585], [-83.45910791357467, 35.037824079304855], [-83.45908771405719, 35.03787207909722], [-83.45906978098917, 35.03792081217039], [-83.45905758096929, 35.03797147888394], [-83.45903031440547, 35.03801701167325], [-83.45900331374298, 35.038062679036365], [-83.4589767137291, 35.03810847876636], [-83.45895631388731, 35.03815647912713], [-83.45893771426935, 35.03820501197115], [-83.45891038123021, 35.03825061229755], [-83.45889771408639, 35.038301078747324], [-83.45888238074279, 35.03835067873303], [-83.45885698087814, 35.03839687915538], [-83.45884518060858, 35.03844787876011], [-83.45882571411634, 35.03849601204892], [-83.45880431355135, 35.0385436120646], [-83.45877818066143, 35.03858961231922], [-83.45875091409759, 35.038635079303795], [-83.45872438055906, 35.03868101184003], [-83.45869338059691, 35.038725279159586], [-83.45866638083272, 35.03877101232246], [-83.45862818087359, 35.038812878896515], [-83.45859078131336, 35.03885501170265], [-83.45855351380548, 35.03889721215365], [-83.45851251379761, 35.03893807910977], [-83.45846718121511, 35.038977611837346], [-83.45842951395692, 35.03901961216752], [-83.45839238119635, 35.039061878728944], [-83.45836471398391, 35.039107279255276], [-83.45832691377508, 35.0391492787833], [-83.45828851438993, 35.0391910789681], [-83.45825138073104, 35.03923327924558], [-83.45821391379715, 35.03927547876579], [-83.45816738106545, 35.0393144788258], [-83.45811938138489, 35.03935307875388], [-83.45807171408096, 35.039391678663556], [-83.4580331143715, 35.03943341179365], [-83.45799758061212, 35.039476279046006], [-83.457966381224, 35.03952047900408], [-83.45793991416078, 35.03956627865242], [-83.4579125811216, 35.03961201208011], [-83.45788471358489, 35.039657279175294], [-83.4578565136715, 35.03970261170478], [-83.4578331808303, 35.03974947919593], [-83.45780691409139, 35.03979541184123], [-83.45778058087717, 35.039841412126584], [-83.45775311398903, 35.039886812219706], [-83.45773431404679, 35.039935279312274], [-83.45770558143239, 35.039980279242826], [-83.45767698087037, 35.040025479203656], [-83.45764878095699, 35.04007081226441], [-83.45763138058994, 35.04011967935745], [-83.45760271355256, 35.0401648123112], [-83.45758131388588, 35.04021241209015], [-83.4575537140471, 35.0402578119772], [-83.4575371805543, 35.04030707906729], [-83.45751358091346, 35.04035387928173], [-83.45749978099407, 35.04040401198948], [-83.45748038097719, 35.04045227872113], [-83.457461113911, 35.04050061235412], [-83.45744351411794, 35.04054947919011], [-83.45741458117925, 35.04059461190645], [-83.45738598061726, 35.040639612209404], [-83.45734798098242, 35.040681611685194], [-83.4573119809974, 35.04072427896468], [-83.45726558121636, 35.04076361224571], [-83.45721851398703, 35.04080287931373], [-83.45717131380705, 35.0408418786447], [-83.45712371387681, 35.04088061171008], [-83.4570759136222, 35.040918812263314], [-83.45702418144162, 35.04094867898045], [-83.45697578111242, 35.04098487897436], [-83.45692578088371, 35.041018212021164], [-83.45687118128075, 35.041042211718185], [-83.45682031417778, 35.041073411828556], [-83.45676958092379, 35.04110507896117], [-83.45671811374622, 35.04113521185652], [-83.45667138069018, 35.041175278954974], [-83.4566301812563, 35.041209279009855], [-83.45659238104749, 35.041251278928364], [-83.45655458083863, 35.04129307877328], [-83.45651618055521, 35.04133501171962], [-83.45648851424109, 35.04138047864739], [-83.45644078136013, 35.04141921219287], [-83.45640911394973, 35.04146321178379], [-83.45636811394186, 35.04150421204982], [-83.45633831412893, 35.04154887867803], [-83.45630058129373, 35.04159087915739], [-83.45626198068598, 35.04163261189969], [-83.4562345811715, 35.04167821178414], [-83.45619631383872, 35.04172007907484], [-83.45616871399993, 35.04176547885955], [-83.45613038109012, 35.04180741229892], [-83.45610251355338, 35.04185267891312], [-83.45607551378919, 35.04189841179654], [-83.45604571397627, 35.041943012016034], [-83.45600898096599, 35.04198541165793], [-83.45598058072828, 35.042030812030724], [-83.45594278141776, 35.04207261221227], [-83.45590511415958, 35.04211481173696], [-83.45586798139898, 35.04215701197532], [-83.45583031414081, 35.042199012142056], [-83.45578271421054, 35.04223767910663], [-83.45574558055165, 35.042280011667245], [-83.4556971137471, 35.04231841235119], [-83.45565058101539, 35.042357411694184], [-83.45561358120548, 35.04239981185649], [-83.45556511440094, 35.04243807936319], [-83.45552838139066, 35.04248047874811], [-83.45548131416137, 35.0425192787003], [-83.45543331358246, 35.04255787932062], [-83.45539731359746, 35.042600478692194], [-83.4553509138164, 35.04264001185416], [-83.45530371363643, 35.04267927875579], [-83.45525611370616, 35.04271801168556], [-83.45520831434989, 35.04275621211515], [-83.455156581271, 35.04278607889606], [-83.45511011411628, 35.04282607899251], [-83.4550585813617, 35.04285647896448], [-83.45500738098376, 35.04288721209347], [-83.4549565138808, 35.04291881233079], [-83.45490978082478, 35.042958212218544], [-83.45485618104674, 35.04298407870414], [-83.45480651409298, 35.043018011814006], [-83.45475231424031, 35.043043011897495], [-83.45469751431304, 35.04306661163991], [-83.45464251406145, 35.04309021211089], [-83.45458351361192, 35.043105478976834], [-83.45452818098366, 35.04312787915168], [-83.45446651433436, 35.043138011704016], [-83.45440658143353, 35.04315161198936], [-83.45434831400927, 35.043168412295365], [-83.45428491361146, 35.04317507931603], [-83.45422211418658, 35.043183012076994], [-83.45416351438566, 35.043199212234605], [-83.45409911416293, 35.0432040118994], [-83.4540385811875, 35.04321607872304], [-83.45397211394133, 35.04321667886492], [-83.45390538079381, 35.04321687891218], [-83.45383838084665, 35.043216678864894], [-83.45377151385017, 35.043216211842704], [-83.45370438095235, 35.04321567936387], [-83.45363731363155, 35.04321541165359], [-83.45357051400872, 35.04321521234181], [-83.45350378086121, 35.04321547931659], [-83.45343751393932, 35.04321641189], [-83.4533763808893, 35.04322767925824], [-83.45331091436633, 35.04323027913708], [-83.45324778076818, 35.043237678678544], [-83.45318691361946, 35.043249012236004], [-83.45312638064406, 35.043261612267], [-83.45307071384251, 35.043283279137945], [-83.45300898071787, 35.04329361171816], [-83.45295378104029, 35.043316478862955], [-83.45289791391446, 35.04333801186443], [-83.45284391438611, 35.04336307877757], [-83.45278898060987, 35.043386679162914], [-83.45273838120484, 35.043418479253845], [-83.45268291382932, 35.04344101172668], [-83.45263098132442, 35.04347027885272], [-83.45257758097236, 35.04349661219672], [-83.45251918059743, 35.04351321164981], [-83.45246731366954, 35.0435426118691], [-83.45241191366766, 35.04356527889784], [-83.45235771381499, 35.043590011840244], [-83.4523061810604, 35.04362041226341], [-83.45225111433348, 35.04364321165402], [-83.45220038107949, 35.043675079307825], [-83.4521465136035, 35.04370047928248], [-83.45209058090063, 35.043722279156], [-83.45203531384941, 35.04374461223449], [-83.45197991384754, 35.04376741232594], [-83.45192378082037, 35.0437882119522], [-83.45186271424566, 35.04379947924162], [-83.45180318109514, 35.04381401198328], [-83.45174591439411, 35.043832611829686], [-83.45168538141868, 35.043845078651984], [-83.45163058059309, 35.04386881201674], [-83.45157311356775, 35.04388721180497], [-83.4515179812638, 35.043910211902194], [-83.45146198118731, 35.04393161236416], [-83.45140671413607, 35.04395421235788], [-83.4513521136348, 35.043978411973356], [-83.45129678100656, 35.04400101195413], [-83.45124178075498, 35.044024278991465], [-83.45118711377836, 35.044048212349516], [-83.45112831365311, 35.04406381219993], [-83.45107311397554, 35.04408667912915], [-83.4510171812727, 35.044108278854466], [-83.45096171389717, 35.0441306787543], [-83.45090038142114, 35.0441414120528], [-83.45083891419783, 35.044151879113514], [-83.45077758082348, 35.044162878645565], [-83.45071678104843, 35.04417481220941], [-83.45065318122462, 35.044181079058085], [-83.45058911427687, 35.04418721205271], [-83.45052178105475, 35.044187812187396], [-83.45045451430796, 35.04418687888972], [-83.45039378100823, 35.04417447904634]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;6&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400458981&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 1.2335, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400129735, &quot;drainage_area_sqkm&quot;: 1.2335, &quot;hydroseq&quot;: 25000400194442, &quot;length&quot;: 1.65506017, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 6, &quot;nhdplusid&quot;: 25000400458981, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46680271431347, 35.03374081189603, -83.43474011436295, 35.05390487876995], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46680271431347, 35.03374081189603], [-83.46675598125744, 35.033833879188826], [-83.46673671419123, 35.033882279258634], [-83.46670971442705, 35.033928012189904], [-83.46668258081391, 35.03397361196073], [-83.46666238129642, 35.03402147867339], [-83.46663371425907, 35.034066612053245], [-83.46660511369706, 35.034111812343234], [-83.46658771422833, 35.03416081172123], [-83.46655938136425, 35.03420601195907], [-83.46653098112654, 35.034251212171846], [-83.46650211376489, 35.03429607915634], [-83.46648378094658, 35.03434481215555], [-83.46643038059452, 35.034433079316344], [-83.46640351378099, 35.034478811939294], [-83.4663829136149, 35.034526679091755], [-83.46636438137058, 35.03457507875124], [-83.46633731423275, 35.0346208789649], [-83.4663251142129, 35.034671479318995], [-83.46629831387472, 35.03471727874304], [-83.4662855137802, 35.034767678969395], [-83.46627118115985, 35.03481767902896], [-83.46624431434635, 35.03486341217223], [-83.46623211432646, 35.03491421170815], [-83.46621891358338, 35.03496447867986], [-83.46619458091729, 35.035011078944805], [-83.46618698116995, 35.03506341199262], [-83.46616498142866, 35.035110679336746], [-83.46615311378544, 35.03516147871893], [-83.46612958061996, 35.035208278938434], [-83.46611258090152, 35.03525747919691], [-83.46608518138703, 35.03530287889478], [-83.46607311431784, 35.035353678893], [-83.46604591422931, 35.03539921166996], [-83.46602698133638, 35.03544761228372], [-83.46600591404635, 35.03549527880253], [-83.46599031390313, 35.03554501215252], [-83.465966513938, 35.03559167902027], [-83.46594171414795, 35.035638078861716], [-83.46592718120327, 35.0356880121905], [-83.46590491376402, 35.03573527917338], [-83.46588658094568, 35.03578387891811], [-83.46585971413218, 35.03582961225617], [-83.46583298116764, 35.03587541176673], [-83.46581018102741, 35.03592247931166], [-83.46579278066037, 35.03597127901005], [-83.46576458074696, 35.03601667904698], [-83.46572678143643, 35.03605867869246], [-83.46569791407477, 35.036103679286946], [-83.46566131401516, 35.036146079016945], [-83.4656129810596, 35.03618461203724], [-83.46557518085076, 35.03622661233201], [-83.4655381136672, 35.036268811933915], [-83.46550051378267, 35.03631101224961], [-83.46546258062314, 35.03635281167975], [-83.4654341139101, 35.036398012176214], [-83.46540531392213, 35.03644321191218], [-83.46538778060442, 35.03649207896825], [-83.4653685144365, 35.03654027887113], [-83.465341314348, 35.03658587865537], [-83.46532898137748, 35.036636611658665], [-83.46530218103929, 35.036682412188], [-83.4652751812751, 35.03672787876266], [-83.46524811413728, 35.03677361230804], [-83.46522178092305, 35.03681961208797], [-83.46519651400907, 35.03686581190494], [-83.46516291432248, 35.03690921228863], [-83.46512491378934, 35.03695121221096], [-83.46508851405403, 35.036993612236756], [-83.46505938079103, 35.037038679249015], [-83.46502191385716, 35.03708081223451], [-83.4649933806688, 35.03712601232825], [-83.46495558135827, 35.03716781207707], [-83.46492878102008, 35.0372136792412], [-83.46490251428118, 35.037259611840945], [-83.46487551361868, 35.03730521195939], [-83.46485151422758, 35.03735187929289], [-83.46482338078948, 35.03739721236595], [-83.4648053138725, 35.03744601191918], [-83.4647839142058, 35.0374934117497], [-83.4647571138676, 35.03753927873107], [-83.46472998115277, 35.03758481176119], [-83.46471138063652, 35.03763327874817], [-83.46468978064549, 35.037680879266446], [-83.46467418140058, 35.0377304119611], [-83.46464978136082, 35.037777012119754], [-83.46463658061774, 35.03782727880151], [-83.46461118075308, 35.037873611912666], [-83.46458398066459, 35.037919211688425], [-83.46455791424998, 35.03796507916627], [-83.46452258081494, 35.03800801191417], [-83.46448491355673, 35.03805001200724], [-83.46445038141891, 35.038093211702176], [-83.46442031390802, 35.03813767866432], [-83.46437231422745, 35.03817641227619], [-83.46434451406436, 35.03822167869564], [-83.46430698065515, 35.03826387873824], [-83.46427831361781, 35.038308878853805], [-83.46424031398296, 35.03835087879226], [-83.46421191374526, 35.03839607891896], [-83.46418458070612, 35.03844167913864], [-83.46415671406768, 35.038487079274056], [-83.4641285141543, 35.03853227932553], [-83.46410531426376, 35.03857927914413], [-83.46408058094903, 35.03862567876022], [-83.46406311410665, 35.038674612177914], [-83.46403871406692, 35.038721211798105], [-83.4640149805771, 35.03876787905846], [-83.46398651386406, 35.03881307895451], [-83.46396871374671, 35.03886201226002], [-83.46393978080805, 35.03890701204615], [-83.46391198064494, 35.0389522787964], [-83.46388338098123, 35.038997479326], [-83.46385498074353, 35.03904267909503], [-83.46382698115444, 35.03908801196549], [-83.463799313942, 35.03913347867273], [-83.46377231417783, 35.039179212342724], [-83.46374238141424, 35.039223811840046], [-83.46371478067714, 35.03926941233331], [-83.4636791139671, 35.039312011948475], [-83.46365318140147, 35.039358078701234], [-83.46361991409157, 35.0394016792889], [-83.46359198097781, 35.039447011960206], [-83.46356451408968, 35.03949247920309], [-83.46353398125149, 35.03953687920868], [-83.46349758061785, 35.03957947868449], [-83.46346958102878, 35.0396248119926], [-83.46344078104076, 35.03966981209423], [-83.46341371390294, 35.03971547926898], [-83.46337618139204, 35.03975767927559], [-83.46333771373494, 35.03979941221882], [-83.46330178112358, 35.039842079223554], [-83.46325258129379, 35.0398802787914], [-83.46321638098446, 35.03992281189333], [-83.46317438115167, 35.039963412086415], [-83.46313038077075, 35.040003212038705], [-83.46309298121051, 35.04004541189677], [-83.46305551427663, 35.040087479343676], [-83.4630177140678, 35.04012947910342], [-83.46297991385896, 35.04017147884142], [-83.46294798144557, 35.040215479104255], [-83.46291471413564, 35.04025907923437], [-83.46288698134619, 35.04030447909543], [-83.46285498066082, 35.04034861167555], [-83.46282891424623, 35.04039447926055], [-83.46279211386232, 35.04043681204083], [-83.46276371362458, 35.040481879360485], [-83.4627357140355, 35.040527412221834], [-83.46270798124604, 35.04057281193378], [-83.4626697812869, 35.04061467905556], [-83.46264191375015, 35.0406600117893], [-83.46260498131387, 35.040702412097055], [-83.46256211370853, 35.04074261179608], [-83.46251898110016, 35.04078287914034], [-83.46248258136485, 35.04082541177242], [-83.46244311388284, 35.04086681172919], [-83.46239651377748, 35.040905811765086], [-83.46236011404218, 35.04094841199809], [-83.46232191408302, 35.04099007887466], [-83.46227411382844, 35.041028811869786], [-83.46223671426822, 35.04107087881047], [-83.46219971355998, 35.04111321197566], [-83.4621621810491, 35.04115527887284], [-83.46212478059056, 35.04119747887132], [-83.4620871142307, 35.04123961191876], [-83.46204951434616, 35.0412816118217], [-83.46201618056091, 35.04132507899552], [-83.4619903135723, 35.041371079155184], [-83.46195518135985, 35.04141407924901], [-83.4619233809988, 35.04145821196519], [-83.46189691393558, 35.041504011998384], [-83.46186991417143, 35.04154967888342], [-83.4618427140829, 35.04159541193649], [-83.46182271399144, 35.04164327933303], [-83.46180378109851, 35.041691679190194], [-83.4617763806857, 35.04173727904161], [-83.46175778106776, 35.041785811965234], [-83.46173751417662, 35.041833679250196], [-83.46171051441245, 35.0418794121442], [-83.46167138110374, 35.04193307936593], [-83.46165391426136, 35.041981879152104], [-83.46162511427333, 35.04202701181258], [-83.46159618133467, 35.04207201206198], [-83.46157778114271, 35.042120678643705], [-83.46155111375516, 35.042166479040986], [-83.46152398104034, 35.04221201169895], [-83.46150238104933, 35.042259478635025], [-83.46148431413232, 35.04230827896168], [-83.4614583806684, 35.04235421163945], [-83.46143071435428, 35.04239961180726], [-83.46140838133798, 35.042447011706045], [-83.4613801814246, 35.04249221177322], [-83.4613521809372, 35.04253761186435], [-83.46132411397444, 35.04258287880953], [-83.46128611433963, 35.0426248118293], [-83.46125838065186, 35.042670211846676], [-83.46123058138707, 35.04271567876687], [-83.46119238142789, 35.042757611718564], [-83.46116418061622, 35.042802679228984], [-83.46113671372808, 35.0428482791957], [-83.46109831434293, 35.04289021207925], [-83.46107058065519, 35.04293561194926], [-83.46103318109498, 35.04297761171574], [-83.46099571416109, 35.04301981224385], [-83.46095791395226, 35.0430618119671], [-83.46091971399309, 35.043103679284286], [-83.46088151403397, 35.04314547891698], [-83.46084371382513, 35.043187479311044], [-83.46080678138884, 35.04322987904264], [-83.46076978068062, 35.04327221182458], [-83.4607227143496, 35.0433110121362], [-83.46067498057036, 35.043349879356825], [-83.46062538099028, 35.04338407928911], [-83.46057678123508, 35.04341981191847], [-83.46052571380781, 35.04345067869034], [-83.46047778060256, 35.04348861180333], [-83.46043011419695, 35.043527011919174], [-83.46038258074202, 35.04356601215621], [-83.46033558088634, 35.04360521168554], [-83.4602891811053, 35.04364461197769], [-83.46025298079597, 35.043687212253545], [-83.46020498111538, 35.04372581232202], [-83.46016718090657, 35.04376781168238], [-83.46012031400156, 35.043806811804465], [-83.46008318124096, 35.043848878785525], [-83.46003638081129, 35.04388801198752], [-83.45998811433107, 35.04392641191562], [-83.45994091415112, 35.043965278843515], [-83.45990438056681, 35.044007611979886], [-83.45985771398612, 35.044046611987504], [-83.45981051380615, 35.04408541193137], [-83.45976291387588, 35.044124078738534], [-83.45971511362129, 35.04416281171871], [-83.45966758106466, 35.044201479224704], [-83.45962038088469, 35.04424041221302], [-83.45957398110363, 35.04427941210952], [-83.459537381044, 35.04432181200976], [-83.45948978111373, 35.04436047870516], [-83.45944171405951, 35.04439907919094], [-83.45939458125319, 35.04443787896737], [-83.45935831357023, 35.04448041190295], [-83.45930971381505, 35.0445188122881], [-83.45927398062966, 35.04456207916649], [-83.45922138067651, 35.044591479008346], [-83.45917458114516, 35.044631078868704], [-83.45912791366615, 35.044670611783474], [-83.45907618058726, 35.04470041167358], [-83.45902971433087, 35.04474047922998], [-83.45897818067795, 35.04477061225524], [-83.45893031394807, 35.04480867934341], [-83.45888271401776, 35.044847278881974], [-83.4588353144118, 35.044886279224166], [-83.45878818070716, 35.044925411929235], [-83.45874151412647, 35.04496467920328], [-83.45869551409572, 35.04500407883981], [-83.45865891403608, 35.04504647909937], [-83.45861098083085, 35.045085211642316], [-83.45856411392585, 35.04512461195611], [-83.45851718144382, 35.04516381220842], [-83.45846971356589, 35.04520187911337], [-83.45841798138531, 35.045231611883764], [-83.4583713139063, 35.04527141221143], [-83.45832018090202, 35.04530221209328], [-83.45827331399703, 35.04534161230246], [-83.45822631414134, 35.04538067933448], [-83.45817491433742, 35.045410879049335], [-83.45812731440715, 35.04544927899707], [-83.45807991390284, 35.0454878789684], [-83.45803238134624, 35.04552661203746], [-83.4579851811663, 35.04556541201379], [-83.45793791361267, 35.04560441201312], [-83.45789091375697, 35.045643478919445], [-83.45784398127496, 35.045682611997236], [-83.45779718084529, 35.04572181198182], [-83.45775071369059, 35.04576107887296], [-83.45771431395526, 35.04580341181421], [-83.45766558124944, 35.04584181231283], [-83.45762951389077, 35.045884412178346], [-83.45758091413558, 35.04592267878812], [-83.45754458087559, 35.04596521168619], [-83.45749671414569, 35.04600381214924], [-83.45744958133938, 35.04604281193922], [-83.45741231383148, 35.04608487923981], [-83.45736798107389, 35.046124679151795], [-83.45732878128987, 35.04616687878969], [-83.45728031358698, 35.04620501215237], [-83.45722498095877, 35.046227479137826], [-83.45717831437807, 35.046267078940524], [-83.45712698104947, 35.046297612217565], [-83.45707598099585, 35.046328811791746], [-83.45702531421718, 35.04636047909373], [-83.45697031396561, 35.0463840793486], [-83.45691918096132, 35.046414878810914], [-83.45686458135835, 35.046439012243326], [-83.45681311418078, 35.04646927922732], [-83.45675778065421, 35.046492011633404], [-83.45670318105125, 35.04651621196788], [-83.45664791400003, 35.04653847882857], [-83.4565889144488, 35.0465542120532], [-83.45653091382415, 35.04657121169851], [-83.45647531439629, 35.0465934792797], [-83.45642018119405, 35.046616479350384], [-83.4563693805664, 35.046648078880615], [-83.4563143138395, 35.04667107893589], [-83.45626738135749, 35.046710612334294], [-83.4562163139302, 35.0467416117121], [-83.45616531387657, 35.04677261181362], [-83.45610998124835, 35.046795411795394], [-83.45605518132106, 35.04681901192459], [-83.45600238104359, 35.046846812117955], [-83.45594918101584, 35.04687327895814], [-83.45589378101396, 35.04689627895007], [-83.45584731385925, 35.04693627924028], [-83.45579538135436, 35.04696581207672], [-83.45574731430014, 35.047004212028924], [-83.4557005812441, 35.047043879114895], [-83.45566471420976, 35.04708667912681], [-83.45561871417901, 35.04712627924842], [-83.45557131367472, 35.047165611653455], [-83.45552331399416, 35.04720387913389], [-83.45547198066555, 35.047234478985075], [-83.45541438068956, 35.047252678713264], [-83.4553581138134, 35.04727347892301], [-83.45529871361356, 35.04728807870643], [-83.45524038061225, 35.04730481197294], [-83.4551751144136, 35.04730781179653], [-83.4551145814382, 35.047320278823854], [-83.45504791386769, 35.047320411936965], [-83.45498058064557, 35.04731947867496], [-83.45491338127243, 35.04731867926144], [-83.45484691402625, 35.04731921171346], [-83.45478638105084, 35.04733167873913], [-83.45471891397973, 35.047330412327085], [-83.45465491440564, 35.04733567874773], [-83.45459171433212, 35.047342879351035], [-83.4545241807857, 35.047341679127996], [-83.45445738116285, 35.047341412166546], [-83.4543969811381, 35.047354012301724], [-83.45432958144065, 35.047353012115956], [-83.45426291387015, 35.04735321215319], [-83.45420178082011, 35.04736447895085], [-83.4541405139211, 35.04737527874856], [-83.45407358134763, 35.047375011787345], [-83.45401291362491, 35.04738721184321], [-83.45394771390156, 35.04739047936043], [-83.45388951385095, 35.04740741190757], [-83.45382651410175, 35.04741461176916], [-83.45376311370394, 35.04742141229155], [-83.45370478070265, 35.047438411756445], [-83.45364538140113, 35.0474530122458], [-83.45358318115254, 35.047461879322526], [-83.45352318087808, 35.047475211927065], [-83.45346151422878, 35.047485279222336], [-83.45339851358128, 35.047492812226594], [-83.45333931370574, 35.04750801208111], [-83.45327258055822, 35.047508012081074], [-83.45321111423321, 35.0475184787105], [-83.45314978085887, 35.04752941233596], [-83.45308851395986, 35.04754047907264], [-83.45302758123414, 35.04755181203316], [-83.45296651376114, 35.04756327884009], [-83.45290558103541, 35.047574811834004], [-83.45284451356241, 35.04758621171372], [-83.45278198093715, 35.04759467870288], [-83.45272191418736, 35.04760781198466], [-83.45265558079016, 35.04760881216724], [-83.45259751369018, 35.04762567921606], [-83.4525339138664, 35.04763227894895], [-83.45247718076462, 35.04765227891633], [-83.45241591386561, 35.047662878639734], [-83.45235431369164, 35.04767321213676], [-83.45229291384196, 35.04768387878126], [-83.45223631369088, 35.04770387873598], [-83.452176714065, 35.0477180121815], [-83.452115581015, 35.04772947896509], [-83.45205431411598, 35.04774041182697], [-83.45199318106596, 35.04775147927045], [-83.45193198064227, 35.0477624790532], [-83.45187051431728, 35.04777301183839], [-83.45180371379611, 35.04777281180224], [-83.45174838116787, 35.047774278978984], [-83.45168138122072, 35.047775612307944], [-83.45161398062496, 35.04777527915956], [-83.45154818082703, 35.04777227935316], [-83.45148631385342, 35.047762612165485], [-83.4514263809526, 35.04774887880009], [-83.45136971432616, 35.04772901196873], [-83.45130858127612, 35.047717879069104], [-83.45125211407569, 35.04769727900885], [-83.4511947808993, 35.04767841234674], [-83.45113551365013, 35.04766347874879], [-83.45107978127159, 35.04764141223123], [-83.4510181810976, 35.04763141187912], [-83.45096271372206, 35.0476090791277], [-83.45090111444642, 35.04759901184763], [-83.45084498141922, 35.0475772791973], [-83.45078471434516, 35.04756487913318], [-83.45072291384687, 35.04755461181103], [-83.45066738089433, 35.04753241215131], [-83.45060638079494, 35.0475210122641], [-83.45054511389594, 35.04751027867426], [-83.45048371404627, 35.04749967893116], [-83.4504219144463, 35.04748967929705], [-83.45036111377293, 35.04747787933021], [-83.45029951359898, 35.04746767892122], [-83.45023898062352, 35.047455211916336], [-83.4501805811469, 35.04743867871747], [-83.4501171807491, 35.04743201204484], [-83.4500545807502, 35.04742361196296], [-83.44999298057623, 35.04741327916973], [-83.44993238112549, 35.047401479191734], [-83.4498711807018, 35.047390079286295], [-83.44980391395504, 35.04739127877324], [-83.44974338097958, 35.04737867864381], [-83.4496765139831, 35.047377612269635], [-83.44960911428565, 35.047377612269635], [-83.44954211433851, 35.04737881175674], [-83.44948118071447, 35.04739107873615], [-83.44941458141592, 35.047391078736155], [-83.44935191404339, 35.04739907874734], [-83.4492865813694, 35.047402011643356], [-83.44922558127006, 35.04741361231961], [-83.44916338102146, 35.047422678702155], [-83.44910018094795, 35.04742981163821], [-83.44903598104956, 35.04743481182685], [-83.44897471415054, 35.047445811652146], [-83.44891358110051, 35.04745701224842], [-83.44885258100113, 35.047468812218376], [-83.44879731394991, 35.04749107881935], [-83.44873558082527, 35.04750121230138], [-83.44868011434808, 35.047523478893616], [-83.4486209135742, 35.047538411781666], [-83.44856631397123, 35.04756241176955], [-83.448507513846, 35.047578411757485], [-83.4484521138441, 35.04760101221318], [-83.44840138059013, 35.04763261209794], [-83.4483463138632, 35.047655678800005], [-83.44829478110863, 35.047686079181034], [-83.44824818100327, 35.04772607908452], [-83.44819671382568, 35.047756011707754], [-83.44814978134367, 35.04779547912799], [-83.44810311386466, 35.04783501198225], [-83.44805158111006, 35.047865412296474], [-83.44800491363105, 35.047904678892735], [-83.4479509141027, 35.04793007902308], [-83.44790271409782, 35.04796701208415], [-83.44785138076921, 35.04799721231374], [-83.44780391378961, 35.04803567870462], [-83.44775698130758, 35.04807467899553], [-83.44771011440258, 35.0481140116792], [-83.44766318102226, 35.048153412003046], [-83.44761631411724, 35.04819261227277], [-83.44756911393728, 35.048231279342076], [-83.44751771413334, 35.04826167877341], [-83.44747078075301, 35.048301012102606], [-83.44741931357542, 35.048331079097295], [-83.44737238109342, 35.04837047931635], [-83.44732171431477, 35.048402278938], [-83.44727038098617, 35.048432879075676], [-83.4472197142075, 35.04846441171529], [-83.44716618090479, 35.04849087876678], [-83.44711298087702, 35.048517812066095], [-83.44706611397203, 35.04855721219512], [-83.44701538071803, 35.048588479300285], [-83.44696431418909, 35.04861987876893], [-83.44691331413546, 35.04865101200391], [-83.44686031443202, 35.0486780121735], [-83.44681051362932, 35.04871161197986], [-83.44675571370202, 35.04873541232471], [-83.44670458069773, 35.04876641166946], [-83.44665391391906, 35.04879827879545], [-83.4465989136675, 35.048821278980725], [-83.44654798098752, 35.04885287912879], [-83.44649278130991, 35.04887601167375], [-83.44642518128815, 35.04890927899037], [-83.4463745136112, 35.04894101221478], [-83.44631931393363, 35.048964012359924], [-83.44626818092932, 35.048994879243104], [-83.44621318067774, 35.0490186787699], [-83.4461631139737, 35.04905127900661], [-83.44611538109275, 35.04908901169228], [-83.44606351416492, 35.049118812176786], [-83.44601538063533, 35.04915707874222], [-83.44596871405466, 35.049196811705386], [-83.44593258111897, 35.04923947895016], [-83.44589458058581, 35.04928141223006], [-83.4458561812007, 35.049323279301255], [-83.44581838099184, 35.0493652787253], [-83.44579158065365, 35.04941101181544], [-83.44575318126853, 35.04945281189776], [-83.4457247810308, 35.04949801176562], [-83.44569631431777, 35.049543212343956], [-83.44566818087971, 35.04958841216172], [-83.44564031424127, 35.04963381198618], [-83.44561298120213, 35.04967941181684], [-83.44558611438863, 35.04972507927966], [-83.44557398084407, 35.049775879135794], [-83.44554678075558, 35.04982141196495], [-83.44553471368637, 35.04987207865236], [-83.44550818104612, 35.049918012225014], [-83.44549458055275, 35.049968278790935], [-83.4454709809119, 35.05001507935402], [-83.44544258067421, 35.050060278910806], [-83.44542518120547, 35.05010921209826], [-83.44539638121745, 35.0501544123384], [-83.44536871400501, 35.05019961181799], [-83.4453309137962, 35.050241612262205], [-83.44529391398625, 35.05028401200936], [-83.44526391384903, 35.05032867898479], [-83.44522611364019, 35.0503706117055], [-83.4451989135517, 35.050416278781896], [-83.44516091391688, 35.05045807908512], [-83.44511311366229, 35.050496812003566], [-83.445076181226, 35.050539079245894], [-83.44503851396783, 35.05058121188785], [-83.4449927807367, 35.05062101181519], [-83.4449453137571, 35.050660079263785], [-83.44489711375222, 35.05069781194162], [-83.44484618107224, 35.05072927899166], [-83.44479191384593, 35.050754011971264], [-83.44473971364307, 35.05078267933243], [-83.444686113865, 35.050808811761286], [-83.44463651428492, 35.050842879140575], [-83.44458298098219, 35.050869279235336], [-83.44452791425527, 35.05089207880893], [-83.444473114328, 35.050915612304046], [-83.44441391355416, 35.05093067914984], [-83.44435818117562, 35.050952879356664], [-83.44429971432534, 35.050969078708825], [-83.4442453806237, 35.0509938123511], [-83.44419058069641, 35.0510172788957], [-83.44413018067168, 35.05103007922743], [-83.44406871434666, 35.05104047921969], [-83.44400938062215, 35.05105541220018], [-83.44395211392109, 35.05107401186844], [-83.44389018137046, 35.05108387869221], [-83.4438329137711, 35.051102612196296], [-83.44377371389557, 35.05111747897963], [-83.44371471434434, 35.05113307895089], [-83.44365998089238, 35.05115701169674], [-83.4436051809651, 35.05118047892988], [-83.44355078078814, 35.051205078666094], [-83.44349871443427, 35.05123407900327], [-83.44344818060627, 35.05126607900846], [-83.44339531385349, 35.05129367913147], [-83.44334551394907, 35.051327211676316], [-83.44329058107114, 35.051350811966856], [-83.44323978134183, 35.051382411871785], [-83.44318891423886, 35.05141361170986], [-83.44313391398728, 35.05143721197554], [-83.44307878078504, 35.05145987901974], [-83.44302358110747, 35.05148301229716], [-83.44296878118017, 35.051506611807405], [-83.44291078055554, 35.051524211973614], [-83.4428505808551, 35.0515370122259], [-83.44279391422864, 35.051557011972534], [-83.44273718112687, 35.051577078634985], [-83.4426779138777, 35.05159167911989], [-83.44262311395042, 35.05161547936082], [-83.44256598109834, 35.051634478954945], [-83.44251031429683, 35.05165627891722], [-83.44245878064392, 35.05168667928005], [-83.44240278056742, 35.051708212281284], [-83.44235191436277, 35.051739478915664], [-83.4423009807845, 35.051770679352806], [-83.44225411387949, 35.05181007864805], [-83.44220311382585, 35.051841279058216], [-83.44215178139557, 35.05187167935214], [-83.44210431441594, 35.05191021230962], [-83.44204971391467, 35.05193387935216], [-83.44199858091038, 35.05196507897972], [-83.44194771380742, 35.051996479356426], [-83.44189271355584, 35.052019811772176], [-83.4418377806779, 35.052043011811364], [-83.44178678062426, 35.05207447907848], [-83.44173131414703, 35.05209681207965], [-83.44167671364578, 35.05212067909362], [-83.4416217142925, 35.052144079129576], [-83.44157058128822, 35.05217487936145], [-83.44152411413351, 35.05221501164246], [-83.44147151418035, 35.05224427930178], [-83.44143538124469, 35.05228761194985], [-83.44138711386616, 35.05232607926172], [-83.4413511812548, 35.05236881179183], [-83.441301981425, 35.05240687901587], [-83.44126611439066, 35.052449479134395], [-83.4412173807865, 35.05248781179466], [-83.44118138080148, 35.052530478790935], [-83.4411335814452, 35.052569012172896], [-83.44109591418703, 35.05261121215833], [-83.44105371402992, 35.05265161190427], [-83.44101038109726, 35.052691879261445], [-83.44097418078793, 35.05273441231154], [-83.4409253142331, 35.052772678653646], [-83.44088958104774, 35.05281541168545], [-83.44084311389302, 35.05285507889074], [-83.44079491388815, 35.05289347901566], [-83.4407429140096, 35.052923078823895], [-83.4406961809536, 35.05296267905739], [-83.44064918109792, 35.053001812305425], [-83.44059771392035, 35.05303187904037], [-83.44055058111401, 35.053070879151655], [-83.44050378068435, 35.05311041165862], [-83.440456981153, 35.05314967867469], [-83.4404095806487, 35.05318821176457], [-83.44035818084478, 35.05321867921189], [-83.44031151426408, 35.053258211647254], [-83.4402603812598, 35.053289412239586], [-83.44020911440653, 35.05331987891378], [-83.44015798140224, 35.053350811805345], [-83.44010698134862, 35.05338227930394], [-83.4400519137234, 35.05340527893377], [-83.44000111399407, 35.053437011882046], [-83.43994211444286, 35.05345221210115], [-83.43988471389282, 35.05347061193676], [-83.4398227813422, 35.05348047920637], [-83.43976178124282, 35.05349187899716], [-83.43970111441844, 35.053504011955596], [-83.43963958071977, 35.05351427926524], [-83.43957338117156, 35.05351627875051], [-83.43950598057577, 35.05351687881669], [-83.43943878120264, 35.05351627875048], [-83.43937251428075, 35.053514479287315], [-83.4393109141068, 35.053504078874695], [-83.43925051408203, 35.053491678975035], [-83.43919198075642, 35.05347521171125], [-83.43913291383154, 35.053459879128766], [-83.43907038120629, 35.05345161203443], [-83.43900711375915, 35.05344481201419], [-83.43894398105931, 35.05343607869001], [-83.43887658136184, 35.05343581174856], [-83.43880978084069, 35.05343767886799], [-83.43874891369198, 35.05344947870929], [-83.43868798096628, 35.053460879239765], [-83.43862691439156, 35.053471878989015], [-83.43856498094262, 35.05348181170684], [-83.43850871406647, 35.05350227867595], [-83.43844871379206, 35.05351607872848], [-83.43838191416918, 35.05351781200781], [-83.43831451357342, 35.05351781200779], [-83.4382479142749, 35.053516011809286], [-83.43818658090053, 35.053505012066026], [-83.43813111442333, 35.05348281181755], [-83.43807611417174, 35.05345927906221], [-83.43802091359585, 35.05343641181535], [-83.43797351398989, 35.05339781192329], [-83.43792658060957, 35.05335807879762], [-83.43787518080562, 35.05332747903453], [-83.43781978080372, 35.05330487869265], [-83.43776478055214, 35.053281478989334], [-83.4377073144251, 35.053263212214404], [-83.43764531360252, 35.05325347875724], [-83.43758818075044, 35.05323427878168], [-83.4375287814489, 35.05321967932584], [-83.43746778134954, 35.05320827876169], [-83.43740311432718, 35.05320421212123], [-83.43733911385476, 35.053198879159645], [-83.43727838055503, 35.05318681233989], [-83.43721478073122, 35.05318047926279], [-83.43715011370887, 35.05317647880506], [-83.4370889141835, 35.05316541209656], [-83.43702211366235, 35.05316301182161], [-83.43695538141316, 35.053165479015945], [-83.43689451426445, 35.05317701195426], [-83.43682718104233, 35.05317627878218], [-83.43676591414334, 35.05318707928219], [-83.4367047810933, 35.05319841219454], [-83.43664351419429, 35.05320901193347], [-83.43658638134221, 35.053228411937724], [-83.43652678081806, 35.05324261208202], [-83.43647151376685, 35.05326541172842], [-83.43641338108986, 35.05328261220575], [-83.43635858116258, 35.05330621193139], [-83.4363039806613, 35.05333021169514], [-83.43625251438203, 35.053360479067074], [-83.43619831363105, 35.05338541200747], [-83.43614658055216, 35.05341521165973], [-83.43609551402321, 35.053446279089016], [-83.4360427811194, 35.05347387921068], [-83.4359933809653, 35.05350827933852], [-83.4359417143617, 35.05353841207077], [-83.43589211388331, 35.05357221210566], [-83.43584431362872, 35.05360947868149], [-83.4357929138248, 35.05364007907439], [-83.43574138107022, 35.05367047869866], [-83.43569171411649, 35.05370407865736], [-83.4356419806874, 35.05373767933756], [-83.43558898098395, 35.05376481166352], [-83.43553351360842, 35.05378707875425], [-83.4354803809543, 35.05381427871804], [-83.43542411407816, 35.05383501180857], [-83.43536338077845, 35.053847012348974], [-83.43530818110085, 35.05387007876678], [-83.43524691420187, 35.053881012277394], [-83.43518578115183, 35.05389207888879], [-83.4351243139285, 35.053902679273094], [-83.43505791405595, 35.05390487876995], [-83.4349903140342, 35.05390481185112], [-83.43492451423627, 35.053901879188714], [-83.43486218103702, 35.05389261203342], [-83.43480158068795, 35.05388047913269], [-83.43474011436295, 35.053870011847884]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;7&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400492703&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 2.31500001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400098811, &quot;drainage_area_sqkm&quot;: 2.31500001, &quot;hydroseq&quot;: 25000400179591, &quot;length&quot;: 4.06871425, &quot;name&quot;: &quot;Henson Creek&quot;, &quot;new_preorder_index&quot;: 7, &quot;nhdplusid&quot;: 25000400492703, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43926918107363, 35.05976361184979, -83.42887071363768, 35.06352721179114], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43926918107363, 35.063420212304074], [-83.43920978087378, 35.06343481214207], [-83.43915951384541, 35.06346721177308], [-83.43910011364558, 35.063481812337926], [-83.43904391414307, 35.06350281208811], [-83.43898218101845, 35.06351321196245], [-83.43892171362003, 35.063526278714455], [-83.43885438129622, 35.06352721179114], [-83.43878758077508, 35.063525211815794], [-83.43872611355175, 35.063514678856386], [-83.43866818119909, 35.063497079068604], [-83.43860918074955, 35.063481479253625], [-83.43854831360083, 35.06347021173827], [-83.43848698112481, 35.063459411863086], [-83.43842578070114, 35.063448011993295], [-83.43836418142547, 35.06343781210841], [-83.43830291362814, 35.06342681223116], [-83.43824318105165, 35.0634128792963], [-83.4381847806767, 35.06339607874272], [-83.43812151412787, 35.06338947881311], [-83.43805831405439, 35.0633820788915], [-83.43799718100436, 35.06337101209563], [-83.43793031400787, 35.06337127900461], [-83.43786318111005, 35.06337241208105], [-83.4377959808386, 35.063373078985926], [-83.43772938064174, 35.06337261207895], [-83.43766891414165, 35.06336027911844], [-83.43760131411989, 35.06336207909989], [-83.43754031402054, 35.0633504792185], [-83.43747311374906, 35.063351279210416], [-83.43741198069904, 35.06334021167515], [-83.43735071380003, 35.06332947869382], [-83.43728951427468, 35.063318278803926], [-83.4372335806735, 35.06329641210265], [-83.43717251409879, 35.06328547911752], [-83.43711718057224, 35.063262479329566], [-83.43706071427012, 35.06324207877688], [-83.43699971417074, 35.06322901197938], [-83.43693158144802, 35.06321367902267], [-83.4366905814236, 35.0630482787871], [-83.43663698074721, 35.06302207895196], [-83.4365871808428, 35.06298841223977], [-83.43653298099017, 35.062963279291424], [-83.43647758098825, 35.06294067867531], [-83.43642278106098, 35.06291687879407], [-83.4363637141361, 35.0629016788663], [-83.43630818118356, 35.062879212056096], [-83.43624711371055, 35.062867879016785], [-83.43618291381215, 35.06286307903701], [-83.43611858096307, 35.06285801214628], [-83.43605731406407, 35.06284727910156], [-83.4359901137926, 35.06284781218768], [-83.43592918106687, 35.06283647914397], [-83.43586798064321, 35.06282521227487], [-83.43580698144216, 35.06281387922801], [-83.43574591396914, 35.06280261235594], [-83.4356843811688, 35.06279201165644], [-83.43562278099482, 35.06278181168961], [-83.43556171442013, 35.06277061172459], [-83.43550611409393, 35.06274827870144], [-83.43544451391996, 35.06273827872863], [-83.4353887806431, 35.062716211872484], [-83.43532731431812, 35.06270547880918], [-83.43527098096662, 35.06268487885302], [-83.43521051356822, 35.062672411965295], [-83.4351491810922, 35.06266141198493], [-83.435093580766, 35.06263921201994], [-83.43503198059203, 35.06262887894591], [-83.43497658059013, 35.062606278972574], [-83.43492071436262, 35.0625848120803], [-83.43487198075846, 35.062547479012515], [-83.43482478057851, 35.06250807901558], [-83.43478878059348, 35.062465078997285], [-83.43475071358499, 35.0624232789577], [-83.4347117806006, 35.06238167889709], [-83.43468458141041, 35.06233601189446], [-83.43465298137366, 35.06229187869397], [-83.43461738113896, 35.06224907929777], [-83.43458878057693, 35.062204012223255], [-83.43456018091324, 35.06215881203504], [-83.43453198099986, 35.0621134787328], [-83.43451898058105, 35.06206307920073], [-83.43449198081687, 35.06201741201977], [-83.43446431360442, 35.06197187863772], [-83.43443771359054, 35.061926012139736], [-83.43441051440038, 35.06188047870667], [-83.43438398086182, 35.0618346790696], [-83.43435658134734, 35.06178901176087], [-83.4343335144075, 35.06174187897148], [-83.43430431377085, 35.06169701235427], [-83.43426771371122, 35.061654678827544], [-83.43422978055172, 35.06161261219365], [-83.43419178091689, 35.061570679363165], [-83.43415371390842, 35.061528878865644], [-83.43411591369959, 35.06148681216696], [-83.4340777811141, 35.06144447926655], [-83.4340261136122, 35.061414478865316], [-83.43397951440515, 35.061374479048425], [-83.43392758100195, 35.061344811714505], [-83.43387698069863, 35.061312678892165], [-83.43382578121901, 35.06128181225285], [-83.43377078096741, 35.06125827880389], [-83.43371011414303, 35.061246011701385], [-83.43364898109297, 35.06123481226095], [-83.43358138107122, 35.06123661228929], [-83.43352031359821, 35.0612228789838], [-83.4334597806228, 35.06123681229246], [-83.43339278067565, 35.06123827922728], [-83.43332538097818, 35.06123821231451], [-83.43325878078134, 35.06123647919897], [-83.43320078105505, 35.06121907892325], [-83.43314178060548, 35.06120347867291], [-83.43308031428049, 35.061193012326825], [-83.43302771432732, 35.061164678772656], [-83.43297231432545, 35.06114241222308], [-83.43292118132115, 35.06111101168666], [-83.4328703142182, 35.06107961187345], [-83.43281871408995, 35.06104921206618], [-83.43276791436065, 35.06101747913487], [-83.43272058123, 35.06097861223318], [-83.43266891372814, 35.0609488116646], [-83.43262198124611, 35.06090921236276], [-83.43257091381882, 35.06087787864979], [-83.43251671396617, 35.06085287887795], [-83.43246451376332, 35.06082401210643], [-83.43241151405988, 35.06079681227165], [-83.43235451415846, 35.06077701185097], [-83.43229498100796, 35.06076261227737], [-83.4322365141577, 35.060746011918084], [-83.43217111411005, 35.06074367877905], [-83.43211038081034, 35.06073141233454], [-83.43204338086319, 35.060732079260966], [-83.43197598116573, 35.060733079282834], [-83.43191571409163, 35.06072047900586], [-83.43184838086951, 35.060721679032284], [-83.43178691364619, 35.06071101188468], [-83.43172611387114, 35.06069947927519], [-83.43166478139511, 35.06068861212023], [-83.43160351359779, 35.060677611872585], [-83.43154738057063, 35.060656079030494], [-83.43149198056875, 35.06063361233757], [-83.43143618081656, 35.060612078748534], [-83.43138338143743, 35.060584011910905], [-83.43132778111121, 35.0605618121163], [-83.4312771808079, 35.06052981207723], [-83.43122591395463, 35.06049867895891], [-83.43117471357671, 35.06046767892028], [-83.43112351409708, 35.06043687887494], [-83.43107218076848, 35.06040607881807], [-83.43102118071486, 35.06037481182551], [-83.43096191436399, 35.06035987907853], [-83.43091111373636, 35.0603282120575], [-83.43085151411051, 35.06031381166941], [-83.43079418093414, 35.06029487880227], [-83.43073798143165, 35.060274012054165], [-83.43067778083288, 35.060260811689645], [-83.43061611418358, 35.06025101215301], [-83.43055458138325, 35.06024021185194], [-83.43049378070987, 35.06022847917033], [-83.43043198110989, 35.06021847888884], [-83.43037138076082, 35.06020661164144], [-83.43031018123547, 35.06019521205274], [-83.43024271416436, 35.060196812098376], [-83.43018211381529, 35.06018461175007], [-83.43012058101498, 35.060174079094956], [-83.43005358106784, 35.060174679112265], [-83.42999291424341, 35.06016267876638], [-83.42992551364765, 35.060164211898936], [-83.42986478124627, 35.06015207919481], [-83.42980358082256, 35.060140811955264], [-83.42974231392355, 35.06012987928277], [-83.42968118087353, 35.06011887895979], [-83.42961971365023, 35.060108078641264], [-83.42955831380054, 35.06009761215472], [-83.42949591412595, 35.06008881189294], [-83.4294359138515, 35.06007547914171], [-83.42937458137548, 35.06006467881738], [-83.42931438077672, 35.06005161224673], [-83.42925958084945, 35.06002781225857], [-83.42920458059787, 35.06000427918341], [-83.42914918059597, 35.05998147921256], [-83.42909858119097, 35.059949678952385], [-83.4290455805892, 35.05992021184239], [-83.42900991387916, 35.059876878832576], [-83.42896318082313, 35.05983787903056], [-83.42887071363768, 35.05976361184979]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;8&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400461115&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.9560000000000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400060844, &quot;drainage_area_sqkm&quot;: 8.486999990000001, &quot;hydroseq&quot;: 25000400064695, &quot;length&quot;: 1.0921758000000001, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 8, &quot;nhdplusid&quot;: 25000400461115, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400070770}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44262238092514, 35.06102981171405, -83.43926918107363, 35.063420212304074], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44262238092514, 35.06102981171405], [-83.44252871359048, 35.06104127883458], [-83.44246131389302, 35.061040011899834], [-83.44239918101808, 35.06104927897921], [-83.44233998114255, 35.06106421233535], [-83.4422839136924, 35.0610854788886], [-83.44222658141433, 35.06110407921365], [-83.44216718121449, 35.06111867873049], [-83.44211631411153, 35.06115041235787], [-83.44206111443395, 35.06117301199897], [-83.44200991405602, 35.06120387867932], [-83.44196318099999, 35.06124401167014], [-83.44191151439642, 35.06127381213095], [-83.44186371414183, 35.06131207888327], [-83.44181611421155, 35.06135087871343], [-83.44176898140523, 35.06139021235624], [-83.44172278105017, 35.06142961215734], [-83.44168658074086, 35.061472211980586], [-83.44163838073595, 35.061510678642364], [-83.44160251370161, 35.06155407916817], [-83.44154978079781, 35.06158381186799], [-83.44149498087053, 35.06160741213564], [-83.44144018094325, 35.06163101166111], [-83.44138491389202, 35.06165361190445], [-83.44133371441242, 35.061684412226036], [-83.44128718078237, 35.061724611892984], [-83.4412349141042, 35.06175387908515], [-83.44118718122327, 35.06179301179666], [-83.44115178131285, 35.061836212170704], [-83.44109958111002, 35.06186641168329], [-83.44106231360215, 35.061909078926185], [-83.44102531379222, 35.06195141232098], [-83.44098211381021, 35.06199141185514], [-83.44093971422711, 35.0620318790196], [-83.44090198139193, 35.06207401234961], [-83.44081438127867, 35.06215647893638], [-83.44078218116731, 35.0622004122092], [-83.44074918065705, 35.06224407928091], [-83.44072151434293, 35.06228947868725], [-83.44068951365755, 35.06233341188847], [-83.44065491414607, 35.06237661197649], [-83.44061671418692, 35.06241841203993], [-83.4405791143024, 35.06246061208222], [-83.4405425142428, 35.06250287901462], [-83.44050338093405, 35.06254461210171], [-83.44045771417827, 35.062583878992776], [-83.44040938122271, 35.062622278954365], [-83.44037331386406, 35.062664811979], [-83.44032898110648, 35.0627046788109], [-83.44028691390004, 35.062745278709734], [-83.44024978113947, 35.06278747931842], [-83.44022191360271, 35.062833012245484], [-83.44018431371819, 35.062875012074436], [-83.44015578142813, 35.062920078778504], [-83.44011771441963, 35.06296201165115], [-83.44009051433116, 35.06300767903899], [-83.44005258117167, 35.06304961186666], [-83.44001391408857, 35.06309127923348], [-83.43998358067635, 35.06313587890996], [-83.4399377809699, 35.06317287935836], [-83.43988411381821, 35.06319887914682], [-83.43982951421525, 35.06322261203463], [-83.43977071409, 35.06323867880685], [-83.43970958103998, 35.06325001179464], [-83.43964831414097, 35.06326087934403], [-83.43958598094173, 35.063269612352656], [-83.43952538059264, 35.063281879151106], [-83.43946971379113, 35.06330401203013], [-83.43941678056301, 35.06333127867601], [-83.4393619141604, 35.063354879173694], [-83.43930858118198, 35.063381478897824], [-83.43926918107363, 35.063420212304074]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;9&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400509565&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.1507, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400064695, &quot;drainage_area_sqkm&quot;: 6.77050001, &quot;hydroseq&quot;: 25000400070770, &quot;length&quot;: 0.42071594, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 9, &quot;nhdplusid&quot;: 25000400509565, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400082835}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44867491400089, 35.056622479150626, -83.44262238092514, 35.06102981171405], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44867491400089, 35.056622479150626], [-83.44863158106821, 35.05667127898522], [-83.44858371433828, 35.05671001189828], [-83.44853218068539, 35.0567408118788], [-83.44847758108241, 35.05676501211795], [-83.44842218108053, 35.0567874791401], [-83.44836298120498, 35.05680241180502], [-83.44830438140406, 35.05681881221681], [-83.44824391400566, 35.05683101233266], [-83.44818278095563, 35.05684227929363], [-83.44812318132979, 35.05685647880948], [-83.44806631437905, 35.056876011780005], [-83.448005380755, 35.05688767876234], [-83.44794691390473, 35.05690401224061], [-83.4478879143535, 35.05691967875817], [-83.44782638065486, 35.05693001181937], [-83.44777031410302, 35.05695121179781], [-83.4477095808033, 35.05696321188031], [-83.44765458055173, 35.056986411985754], [-83.44759751417499, 35.057005811827985], [-83.44753718062555, 35.057018411942934], [-83.44748198094797, 35.0570414120193], [-83.44742471424694, 35.057060011794974], [-83.44737011374563, 35.05708441195279], [-83.44731458079309, 35.057106478860455], [-83.44726371369013, 35.05713787873095], [-83.44720871433687, 35.057161011870704], [-83.44715331433497, 35.05718407882301], [-83.44710238075668, 35.057215011721546], [-83.44705151365372, 35.05724647920181], [-83.44700051360009, 35.0572780121153], [-83.44694731357234, 35.057304612348645], [-83.44689811374253, 35.057339079249445], [-83.44685138068652, 35.05737907883729], [-83.44679898105767, 35.057408412297185], [-83.4467533143019, 35.05744847876707], [-83.44671498139209, 35.05749027914761], [-83.4466671811375, 35.057529011672166], [-83.44664051374998, 35.05757467915766], [-83.44660311418976, 35.057617611894635], [-83.44655118078654, 35.05764787914803], [-83.4465001142576, 35.057678478762895], [-83.4464445139314, 35.05770067934142], [-83.44638631388077, 35.05771801198066], [-83.44632751375553, 35.057733412149936], [-83.44626831388, 35.057748479208534], [-83.44621078127764, 35.057767211919135], [-83.44614911373002, 35.05777701175392], [-83.44609178055362, 35.05779581210895], [-83.44603258067808, 35.05781081224041], [-83.44597771427547, 35.057834079020694], [-83.44592118059971, 35.05785467873008], [-83.44586411422296, 35.057873679078575], [-83.44580911397136, 35.057897212032444], [-83.44575398076913, 35.05792027877689], [-83.44569478089359, 35.05793521196999], [-83.44563691411794, 35.05795301223259], [-83.4455813811654, 35.05797521200115], [-83.4455259811635, 35.057997811785796], [-83.44546718103825, 35.058013411913336], [-83.44540931426258, 35.05803087905236], [-83.44535338066146, 35.058052611862486], [-83.44529798065953, 35.0580750123501], [-83.44523891373468, 35.05809027935661], [-83.44518638115517, 35.058118478676306], [-83.44513311375378, 35.05814527864655], [-83.4450817813235, 35.058176078821], [-83.44503371426927, 35.058214478649774], [-83.4449875139142, 35.05825441236426], [-83.44496751382272, 35.05830241191751], [-83.44493231423662, 35.05834527882723], [-83.4449003809249, 35.05838927886011], [-83.44486571403976, 35.05843227881916], [-83.44483798125033, 35.05847787888436], [-83.44480611441391, 35.0585218788458], [-83.4447805807003, 35.05856801197501], [-83.44476758117982, 35.05861841219402], [-83.44473958069243, 35.058663812145895], [-83.44471458057805, 35.05871021211911], [-83.44469711373567, 35.058759012176665], [-83.44466871439627, 35.05880421204116], [-83.44464011383425, 35.05884941188071], [-83.44460731364829, 35.05889301235939], [-83.44457491411096, 35.05893701209708], [-83.4445371139021, 35.058979011724276], [-83.44449898131661, 35.059020812056644], [-83.44445338103615, 35.059060612282806], [-83.44440598143018, 35.05909981172913], [-83.4443579808513, 35.059138011850514], [-83.44430631424774, 35.05916807926745], [-83.4442551138698, 35.0591990790643], [-83.44420838081376, 35.0592384791875], [-83.44415751371082, 35.05927001206703], [-83.44410638070651, 35.059301211832924], [-83.44405271355483, 35.05932687901773], [-83.44400031392598, 35.05935521173909], [-83.44394698094756, 35.059382212046415], [-83.44389438099441, 35.05941001163996], [-83.44383878066822, 35.05943227866204], [-83.44378831421388, 35.059464412224436], [-83.44373711383594, 35.059495078808105], [-83.44368558108135, 35.059525679201364], [-83.44363778082676, 35.05956367911627], [-83.4435901808965, 35.059602479042105], [-83.44354311366719, 35.05964187897063], [-83.44349711363643, 35.05968141197306], [-83.44345918137526, 35.05972341195266], [-83.4434217809167, 35.05976547882462], [-83.44339398075361, 35.059810878873954], [-83.44335551399482, 35.05985267878048], [-83.44333791420178, 35.05990147889048], [-83.4433093810134, 35.059946678857855], [-83.44328718094779, 35.05999407886833], [-83.44327251415415, 35.06004381201032], [-83.44324771436409, 35.06009027884842], [-83.4432239808743, 35.060137078758096], [-83.44320838073108, 35.06018661180732], [-83.44318678074006, 35.0602342116841], [-83.44316838144641, 35.060282679204036], [-83.44314071423399, 35.06032807896571], [-83.44311558116897, 35.06037447872851], [-83.44309291397938, 35.06042167922075], [-83.44306418136503, 35.06046667889515], [-83.4430365141526, 35.06051221164599], [-83.44300858103884, 35.06055747892402], [-83.44297998137513, 35.06060267926347], [-83.4429525135887, 35.060648211938606], [-83.4429147807535, 35.060690212156125], [-83.4428865808401, 35.060735479335385], [-83.44284911390625, 35.060777478772756], [-83.44281138107102, 35.06081967892799], [-83.44277391413715, 35.06086181214825], [-83.44273611392832, 35.06090381225597], [-83.44269838109311, 35.060945812342], [-83.44264891356538, 35.06098381233124], [-83.44262238092514, 35.06102981171405]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;10&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400397871&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.40089999000000004, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400070770, &quot;drainage_area_sqkm&quot;: 1.7986, &quot;hydroseq&quot;: 25000400134610, &quot;length&quot;: 0.77518619, &quot;name&quot;: &quot;Cunningham Creek&quot;, &quot;new_preorder_index&quot;: 10, &quot;nhdplusid&quot;: 25000400397871, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400210321}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45804278114228, 35.04877607873832, -83.44850871399521, 35.056622479150626], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45804278114228, 35.04877607873832], [-83.45797051437262, 35.04882381175849], [-83.4579241810669, 35.04886381184031], [-83.45787251356501, 35.04889381170494], [-83.45782578140731, 35.04893361171911], [-83.45777451365572, 35.04896421165767], [-83.4577275811737, 35.04900327916341], [-83.45767958059481, 35.04904047869501], [-83.45762958126441, 35.049073812132015], [-83.45757851383713, 35.04910461205097], [-83.45752331415957, 35.049127612149945], [-83.45747318098022, 35.04916047929863], [-83.45742151437662, 35.04919027902162], [-83.45736651412503, 35.04921347912913], [-83.45731118059848, 35.049236279164965], [-83.4572563806712, 35.049259879324325], [-83.45720118099362, 35.04928287864427], [-83.45715051421496, 35.0493144116912], [-83.45709518068843, 35.04933721169882], [-83.45704018133513, 35.04936047868717], [-83.4569833143844, 35.049380412044265], [-83.45692838060816, 35.04940341206564], [-83.45686731403345, 35.04941501172217], [-83.45680878070786, 35.049431212114754], [-83.45674998058261, 35.049447011704636], [-83.45668278120948, 35.04944621231194], [-83.45662238118472, 35.04945901215446], [-83.45655498058893, 35.04945747882094], [-83.45649038094022, 35.049461878789394], [-83.45642778094134, 35.049470678725605], [-83.45636078099419, 35.04947181199495], [-83.45629358072273, 35.04947201202689], [-83.45622651430024, 35.049471478853505], [-83.45615991410338, 35.04947027866168], [-83.45609938112798, 35.04945787888494], [-83.45603211438119, 35.04945907907696], [-83.45597051420721, 35.04944847885127], [-83.45590938115717, 35.04943767932763], [-83.45584811425815, 35.04942667903509], [-83.45578718063415, 35.04941501172222], [-83.45572831403356, 35.04939941215828], [-83.45566978070795, 35.04938307864976], [-83.45560931420789, 35.04937081196943], [-83.45554798083354, 35.049359879325856], [-83.45548671393456, 35.04934881210022], [-83.4554251811342, 35.04933847881518], [-83.4553581138134, 35.04933927894429], [-83.45529718108769, 35.04932627905076], [-83.45523638131262, 35.04933967900893], [-83.4551687139172, 35.04933801182802], [-83.45510818094179, 35.049350811687454], [-83.45504711436709, 35.049361678880565], [-83.45498558066845, 35.04937227911748], [-83.45492391401915, 35.049382611662864], [-83.45486371431869, 35.04939541225073], [-83.45480171439442, 35.04940467918089], [-83.45474611406823, 35.04942687906714], [-83.45469078143998, 35.04944961212097], [-83.45463511374014, 35.049471611963], [-83.45458158133574, 35.04949767935972], [-83.45453031358414, 35.04952847911879], [-83.45447878082955, 35.04955881188035], [-83.45443051434934, 35.049597078975054], [-83.45438431399428, 35.049636811724255], [-83.45434738065968, 35.0496792117854], [-83.45431038084978, 35.04972161182446], [-83.45426191404522, 35.04975987884287], [-83.45422431416071, 35.04980207880897], [-83.4541867807515, 35.049844078722195], [-83.45415018069188, 35.04988661178454], [-83.45410638063527, 35.049926612081265], [-83.45406418137648, 35.049967211715185], [-83.45402798106714, 35.05000947923157], [-83.45398738080956, 35.05005067891593], [-83.45394671407666, 35.050091811657566], [-83.45390611381909, 35.05013281200548], [-83.45386638133405, 35.050174079284965], [-83.45382911382619, 35.050216279037066], [-83.45379251376657, 35.050258811905536], [-83.45374378106071, 35.050297078672294], [-83.45370771370207, 35.05033961223413], [-83.45365898099621, 35.05037787896294], [-83.4536227806869, 35.050420611776985], [-83.45357658123015, 35.05045987935104], [-83.45352951400082, 35.0504992792786], [-83.45348211439486, 35.050538279128524], [-83.4534345135663, 35.05057667887196], [-83.4533865138857, 35.05061441232377], [-83.45333551383207, 35.050645611719894], [-83.4532859807273, 35.05067961224576], [-83.45323751392277, 35.05071607929045], [-83.45318618059419, 35.050746279238915], [-83.45313511406523, 35.050777211634525], [-83.45308398106094, 35.05080827933194], [-83.45303291363368, 35.05083941173275], [-83.45298578082735, 35.05087841215562], [-83.45293538084833, 35.050910479221365], [-83.45288411399507, 35.05094127918309], [-83.45283278066647, 35.05097181218374], [-83.45278171413752, 35.05100261212232], [-83.4527309144082, 35.051034679139306], [-83.45267958107961, 35.05106507899803], [-83.45262471377868, 35.05108841167997], [-83.45257351429906, 35.051119479258944], [-83.45252238129477, 35.051150412248674], [-83.45247338089098, 35.05118547888879], [-83.45242478113579, 35.051221411810246], [-83.4523733139582, 35.05125147920069], [-83.45232658090218, 35.051291078773936], [-83.45227911392256, 35.051329278871435], [-83.4522285809929, 35.05136147886657], [-83.45217738061496, 35.05139221173734], [-83.45212651441031, 35.05142361233437], [-83.45207271430795, 35.0514492790538], [-83.45201991403049, 35.05147687911491], [-83.45197291417482, 35.051516012339555], [-83.4519177809726, 35.05153927870724], [-83.45186691386962, 35.051570412300066], [-83.45181571439001, 35.051601212012926], [-83.45176658103553, 35.05163621227422], [-83.451718114231, 35.05167227883868], [-83.45166638115211, 35.051702279142454], [-83.45161611412375, 35.05173467901707], [-83.45156898131742, 35.051773412065444], [-83.45151731381556, 35.05180341233212], [-83.45147078108383, 35.051843411690044], [-83.45141911358195, 35.05187341193099], [-83.45137238142425, 35.051913011938026], [-83.45132131399696, 35.05194401228305], [-83.45127431414132, 35.05198287907301], [-83.45122291433738, 35.0520134793399], [-83.45117631423203, 35.05205321164894], [-83.45112478057911, 35.052083478758725], [-83.45107351372585, 35.0521142790135], [-83.45102658124382, 35.05215347885295], [-83.45097591356685, 35.05218501226232], [-83.45092438081227, 35.05221541169295], [-83.45087791365756, 35.05225527921486], [-83.45082618057867, 35.052285279304535], [-83.4507781808981, 35.05232327891205], [-83.45073058096781, 35.05236241173112], [-83.45068438061277, 35.05240201223643], [-83.45064891422703, 35.0524454786408], [-83.4505959809989, 35.05247501169148], [-83.45054798131832, 35.05251307886602], [-83.45050058081405, 35.052552212329495], [-83.45045451430796, 35.05259181200743], [-83.45041831399864, 35.05263447894935], [-83.45037011399376, 35.05267287917797], [-83.45032251406349, 35.05271161178144], [-83.45028631375418, 35.052754278660785], [-83.45023778137262, 35.052792611913375], [-83.45020078066439, 35.0528348117832], [-83.45015291393446, 35.05287341194131], [-83.45011538142359, 35.0529154786655], [-83.45007811391571, 35.052957679207225], [-83.45004058140482, 35.05299981207224], [-83.45000258087167, 35.05304181181173], [-83.44996478066284, 35.0530838122651], [-83.44992691397866, 35.053125811961465], [-83.44988931409414, 35.05316781163626], [-83.4498525137102, 35.05321021207038], [-83.449814581449, 35.0532522117017], [-83.44976738126904, 35.053291011685126], [-83.44972098058966, 35.05333007932731], [-83.4496835136558, 35.05337221200015], [-83.44963591372553, 35.053410878823414], [-83.44958778109428, 35.053449478709325], [-83.44954071386498, 35.05348827933432], [-83.44950458092929, 35.05353081196959], [-83.44945571437447, 35.05356907867396], [-83.44941831391593, 35.053611278878], [-83.44938058108075, 35.053653279038414], [-83.44934871424434, 35.053697278658106], [-83.44931471390917, 35.053740612005925], [-83.44928198109685, 35.05378441229248], [-83.44925598115758, 35.05383041205441], [-83.44922951409437, 35.05387627868807], [-83.44920251433018, 35.05392201219377], [-83.44917471416709, 35.05396741181538], [-83.449146580729, 35.05401261212622], [-83.44912271428854, 35.054059411842466], [-83.44909851367481, 35.05410601224676], [-83.44908098125539, 35.054154879033106], [-83.44905551401709, 35.05420107934212], [-83.44904291424692, 35.054251611681465], [-83.4490159135844, 35.054297278793825], [-83.44899531431663, 35.05434507918248], [-83.44897651437437, 35.05439361196902], [-83.44895898105665, 35.05444247931869], [-83.44892998074432, 35.05448747934693], [-83.44890151403129, 35.0545326786345], [-83.4488731137936, 35.0545778786325], [-83.44884478092952, 35.054623079340836], [-83.4488171137171, 35.05466847930798], [-83.44878938092765, 35.05471401235084], [-83.44876118101425, 35.05475927916659], [-83.44873278077654, 35.05480441212107], [-83.44870438143715, 35.05484961196865], [-83.44867578087513, 35.05489481179121], [-83.44864738063742, 35.05494001232414], [-83.44861898129801, 35.05498521209653], [-83.44860171388163, 35.055034212192595], [-83.44857758064153, 35.055080878958464], [-83.4485639136728, 35.05513101218798], [-83.44853718070826, 35.055176811908694], [-83.44853631383403, 35.05523127928988], [-83.44852531396334, 35.055282478698004], [-83.44851058069437, 35.05533241178607], [-83.44850878136887, 35.055387079080994], [-83.44850871399521, 35.05544247875561], [-83.44851051421904, 35.05549747909377], [-83.44852591403796, 35.05554721203324], [-83.44853931420705, 35.05559761191086], [-83.44855318060178, 35.05564787865786], [-83.44856651429555, 35.055698212291304], [-83.44857938086535, 35.055748678993005], [-83.44859278103444, 35.0557990787462], [-83.44860671390451, 35.05584921227013], [-83.44862058119757, 35.05589947886223], [-83.4486341143173, 35.055949812340565], [-83.44864018064042, 35.056002479062414], [-83.44864591368857, 35.05605561196377], [-83.4486607808065, 35.05610541221569], [-83.44867451425058, 35.0561556786501], [-83.44867778142326, 35.056209412233564], [-83.44868638099548, 35.056261411825005], [-83.44870011443953, 35.0563116788988], [-83.4487159813824, 35.05636127897951], [-83.44871738095762, 35.0564168118268], [-83.44871351371033, 35.05647107910144], [-83.44869311386854, 35.056519012051034], [-83.44867471367658, 35.056567678849476], [-83.44867491400089, 35.056622479150626]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;11&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400423293&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 1.0071000200000002, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400134610, &quot;drainage_area_sqkm&quot;: 1.0071000200000002, &quot;hydroseq&quot;: 25000400210321, &quot;length&quot;: 1.36168448, &quot;name&quot;: &quot;Cunningham Creek&quot;, &quot;new_preorder_index&quot;: 11, &quot;nhdplusid&quot;: 25000400423293, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45789878120223, 35.055164012226946, -83.44867491400089, 35.056622479150626], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45789878120223, 35.055164012226946], [-83.45781971418589, 35.055242278800606], [-83.45776751398303, 35.055272079246], [-83.45771618065446, 35.05530281211574], [-83.45766531355147, 35.05533401192703], [-83.45761471414647, 35.055366011796316], [-83.45756278074325, 35.055395412161594], [-83.45750711394173, 35.0554174118727], [-83.45744971429002, 35.05543601201827], [-83.45739471403843, 35.05545927873985], [-83.45733971378687, 35.05548261163698], [-83.4572805139113, 35.05549747909372], [-83.45722571398404, 35.055521078914644], [-83.45716711418312, 35.05553747884843], [-83.45711178065655, 35.055560011655], [-83.45705278110532, 35.05557541223123], [-83.45699471400535, 35.0555924791225], [-83.4569391810528, 35.055614878814396], [-83.4568777138295, 35.05562547897509], [-83.45682158080236, 35.05564641235799], [-83.45676118077758, 35.05565941198082], [-83.45669971355426, 35.05566967901955], [-83.45663838107824, 35.05568081230606], [-83.45657751392953, 35.05569227870706], [-83.45651678062981, 35.05570421205717], [-83.45644931355872, 35.055702878857595], [-83.45638878058328, 35.05571527915684], [-83.45632111408618, 35.05571367902349], [-83.45625998103617, 35.05572487922125], [-83.45619351378998, 35.055725479271224], [-83.45613011429047, 35.05573227910165], [-83.45606578144141, 35.055739078931424], [-83.4559985137963, 35.05573727878184], [-83.4559377813949, 35.05572527925455], [-83.45587078144774, 35.05572601166846], [-83.4558153140722, 35.05572661171838], [-83.45575358094756, 35.055715412256234], [-83.45569298059851, 35.05570341199034], [-83.4556253141014, 35.055705079041324], [-83.45556478112597, 35.05569261182313], [-83.45550151367884, 35.05568587890679], [-83.45543811417936, 35.05567941218867], [-83.45537991412871, 35.05566247915039], [-83.45531658110455, 35.055655611661415], [-83.45525231383252, 35.05565047887673], [-83.45519131373314, 35.05563907865191], [-83.45513051395807, 35.05562707911017], [-83.45506458120947, 35.05562547897505], [-83.45500171441095, 35.055617812150686], [-83.45494118143556, 35.05560527873715], [-83.45487618113819, 35.05560201228389], [-83.45481291369106, 35.055595079343114], [-83.45474631439252, 35.05559481167335], [-83.45468518134253, 35.05558321215913], [-83.45461838082136, 35.05558227899161], [-83.45455098112389, 35.05558207897459], [-83.45448398117674, 35.05558267902559], [-83.45441738097988, 35.05558441226105], [-83.45435691358148, 35.055596611826054], [-83.45428998100797, 35.055596678743505], [-83.45422271426118, 35.05559547864168], [-83.45415571431403, 35.05559521170725], [-83.45409491364066, 35.055607011972135], [-83.45402858114176, 35.05560787895727], [-83.45396098111999, 35.05560661193829], [-83.45389471419813, 35.05560727890647], [-83.45383371409876, 35.0556190122522], [-83.4537663144013, 35.055617612133766], [-83.45370591437656, 35.055630211727504], [-83.45363891442942, 35.05562987934656], [-83.45357711393112, 35.05563981180192], [-83.45351598088106, 35.05565127894401], [-83.45345878065538, 35.055669879036344], [-83.45339938135383, 35.055684478789594], [-83.45334058122859, 35.05570041173973], [-83.45328211437831, 35.05571681163755], [-83.4532215814029, 35.0557292788521], [-83.45316051392989, 35.05574027903104], [-83.45309858137927, 35.055750212208345], [-83.45303791365654, 35.05576247866589], [-83.45298231422868, 35.05578441209618], [-83.45292058110402, 35.055794612201865], [-83.4528653140528, 35.05581721185478], [-83.45280651392757, 35.055832879316185], [-83.45274811355263, 35.05584961230278], [-83.45269271444906, 35.055871878825045], [-83.45263178082502, 35.055883612132725], [-83.4525699138514, 35.05589341219354], [-83.45251198060042, 35.0559112121659], [-83.45245318137349, 35.055926878873905], [-83.45239251365078, 35.05593881218979], [-83.45233098085045, 35.05594941230834], [-83.45227011370174, 35.055961011770535], [-83.45220891417641, 35.05597201191837], [-83.45214758080206, 35.0559830120647], [-83.45208651422733, 35.055994279142666], [-83.45202058058045, 35.055996011634065], [-83.45195811443051, 35.05600447922212], [-83.45189911398099, 35.056019878979185], [-83.45184071360605, 35.05603627881283], [-83.45178018063062, 35.056048679061504], [-83.45171871430563, 35.05605901223293], [-83.45165738093128, 35.05607001236753], [-83.45159598108161, 35.056080878666535], [-83.4515349136086, 35.05609201189685], [-83.45147378055854, 35.05610347897553], [-83.45141291430818, 35.05611487913554], [-83.45135178125815, 35.05612627929391], [-83.45129071378513, 35.056137611798455], [-83.45122931393546, 35.05614841190684], [-83.45116778113513, 35.05615867888403], [-83.4511067136621, 35.05617021213488], [-83.45104578093638, 35.056181612285535], [-83.45098451403737, 35.05619267932053], [-83.45092358131166, 35.056204011815815], [-83.45085611424058, 35.0562026793598], [-83.45080018063939, 35.05622401189023], [-83.45073351396722, 35.056224411921086], [-83.45067371401707, 35.05623827916588], [-83.45061111401817, 35.056246479061116], [-83.45055051366913, 35.05625887927793], [-83.45048518099512, 35.05626161184041], [-83.4504219144463, 35.056268679293716], [-83.45036158089688, 35.056281411885436], [-83.45029391439978, 35.05627987867996], [-83.45023318110005, 35.05629187886112], [-83.45016591435325, 35.056291011883225], [-83.45010518105353, 35.05630307897959], [-83.45004178065574, 35.05630967874661], [-83.44997658093241, 35.05631307900525], [-83.44991611443233, 35.05632527919667], [-83.44985498138227, 35.056336479310595], [-83.44978771373718, 35.056335679249976], [-83.44972331441278, 35.056340211946186], [-83.44966031376529, 35.056347878702724], [-83.44959838121463, 35.05635727867759], [-83.44953771439026, 35.0563692788474], [-83.44947671429087, 35.05638101208354], [-83.44941351421737, 35.05638801187438], [-83.44935391369322, 35.05640261223451], [-83.4492929809675, 35.056414012352775], [-83.44923151374418, 35.05642461167433], [-83.44916998094386, 35.05643501171491], [-83.44910871404484, 35.05644581178398], [-83.44905371379326, 35.05646921205128], [-83.44899198066862, 35.05647907895851], [-83.44893651419139, 35.05650161224064], [-83.44888291441335, 35.0565276119475], [-83.4488321137857, 35.05655901204063], [-83.44878078135542, 35.05658967898017], [-83.44872578110385, 35.056613012289645], [-83.44867491400089, 35.056622479150626]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;12&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400328912&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.39059999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400134610, &quot;drainage_area_sqkm&quot;: 0.39059999, &quot;hydroseq&quot;: 25000400251500, &quot;length&quot;: 0.87135947, &quot;name&quot;: &quot;Mill Branch&quot;, &quot;new_preorder_index&quot;: 12, &quot;nhdplusid&quot;: 25000400328912, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44438518093979, 35.06100601201107, -83.44262238092514, 35.06117381201216], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44438518093979, 35.06100601201107], [-83.4442867812802, 35.06103861187441], [-83.4442313812783, 35.06106107919113], [-83.44417551415248, 35.06108267883938], [-83.44412051390088, 35.06110567924148], [-83.44405858135025, 35.06111547867545], [-83.4440021141498, 35.06113587902422], [-83.44394211387535, 35.0611494792539], [-83.44388038075071, 35.061159411773126], [-83.44381358112787, 35.06115947868604], [-83.44375318110312, 35.06117207889528], [-83.44368618115597, 35.06117381201216], [-83.4436187805602, 35.061173278915085], [-83.44355791430979, 35.06116061179314], [-83.44349111378864, 35.061160811796526], [-83.44342851378975, 35.0611524116561], [-83.44336291431614, 35.06115027926738], [-83.44330218101639, 35.061138012148625], [-83.44323998076781, 35.06112921199901], [-83.44317358089528, 35.06112841198544], [-83.44311338119482, 35.06111527867203], [-83.44305118094627, 35.06110641234237], [-83.44299171427106, 35.06109187900094], [-83.4429283812469, 35.0610850788816], [-83.44286711434789, 35.06107387868377], [-83.44280611424853, 35.061062612306806], [-83.44274531357514, 35.06105061209147], [-83.44267811420201, 35.06105181211308], [-83.44262238092514, 35.06102981171405]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;13&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400463186&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.0438, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400070770, &quot;drainage_area_sqkm&quot;: 4.82120001, &quot;hydroseq&quot;: 25000400082835, &quot;length&quot;: 0.16512304, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 13, &quot;nhdplusid&quot;: 25000400463186, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400100976}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45451978083744, 35.05964487907639, -83.44438518093979, 35.06100601201107], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45451978083744, 35.060282212279446], [-83.45444438074408, 35.06019827905188], [-83.45439851366396, 35.06015907866227], [-83.45435911355561, 35.06011767892454], [-83.4543207806458, 35.06007581223993], [-83.4542923813064, 35.06003061234404], [-83.45425511379855, 35.05998841178095], [-83.45421631376479, 35.05994681195022], [-83.45418031377979, 35.05990367896099], [-83.4541331135998, 35.05986441225143], [-83.45408458121827, 35.05982681175435], [-83.45403351379099, 35.05979547909654], [-83.45398131358816, 35.05976641194442], [-83.45392538088528, 35.059744878861984], [-83.4538693808088, 35.05972327885979], [-83.45381298098201, 35.059702811979356], [-83.45375358078215, 35.05968821220932], [-83.45369511393189, 35.05967167928098], [-83.45363178090773, 35.05966501213618], [-83.45356831403458, 35.0596582788121], [-83.45350771368551, 35.05964487907639], [-83.45344331436111, 35.05965221168743], [-83.4533799139633, 35.05965861191204], [-83.45331218099089, 35.05965701185594], [-83.4532511144162, 35.0596686122621], [-83.45318418094439, 35.0596682122481], [-83.45312391387026, 35.05968087886624], [-83.45305811407235, 35.059682878935824], [-83.45299511432314, 35.05969027919278], [-83.45293398127312, 35.059701611937946], [-83.45287358124837, 35.05971421163682], [-83.45281771412253, 35.059735879290734], [-83.45275618132221, 35.05974641200239], [-83.452700580996, 35.05976861201855], [-83.45263971384729, 35.05978007931622], [-83.45257531362458, 35.059785011834634], [-83.45251091430018, 35.05978967890266], [-83.45245038132477, 35.05980227932333], [-83.45238331400394, 35.05980141164732], [-83.45232218095391, 35.059812812026365], [-83.45225691385696, 35.05981567903316], [-83.4521945806577, 35.059824479324355], [-83.45212691416062, 35.059823012364156], [-83.45206518103598, 35.0598330119587], [-83.45199951418871, 35.059835012024585], [-83.45193238129089, 35.05983467892543], [-83.45187151414218, 35.05984607929971], [-83.45180978101754, 35.059856411990694], [-83.45174291402107, 35.05985621198411], [-83.45168198129532, 35.059867812361915], [-83.45162071439634, 35.05987861197694], [-83.451559381022, 35.05988961233232], [-83.45149878067294, 35.05990187890329], [-83.45144391427033, 35.05992547892185], [-83.45138911434304, 35.05994887892716], [-83.45133391376716, 35.05997201200579], [-83.45128338083745, 35.060004012263505], [-83.4512317142339, 35.06003381170627], [-83.45117691430661, 35.0600576116927], [-83.45112611367901, 35.0600892788187], [-83.45107078105075, 35.06011207875936], [-83.45101991394779, 35.060143478944696], [-83.4509645139459, 35.06016567885305], [-83.45090858124307, 35.06018747874381], [-83.45085258116656, 35.060209011709546], [-83.45080018063939, 35.0602370117624], [-83.45074518128612, 35.06026061168414], [-83.45069038135887, 35.06028407924233], [-83.45063511430763, 35.0603068122151], [-83.45058011405604, 35.06033027902482], [-83.45052511380445, 35.060353278903506], [-83.45047418112449, 35.060384678996066], [-83.45041898144692, 35.06040787886465], [-83.45036831376994, 35.060439478941376], [-83.45031311409237, 35.0604624787893], [-83.4502571813895, 35.06048387932619], [-83.4502019808136, 35.06050701225322], [-83.45014031416429, 35.060517278682354], [-83.45008478121176, 35.06053907921456], [-83.45002651378748, 35.0605562788951], [-83.44996331371397, 35.06056307905848], [-83.44990158058933, 35.06057387931682], [-83.44983458064218, 35.060574879340706], [-83.44976738126904, 35.060575079345476], [-83.44970031394826, 35.060574411682495], [-83.44963411440001, 35.06057267928822], [-83.4495785140738, 35.060550478755346], [-83.44952318144558, 35.06052747893204], [-83.44946811382034, 35.06050441218899], [-83.44941718114036, 35.06047267904591], [-83.44936191408912, 35.06045007921097], [-83.44930698121121, 35.06042661170047], [-83.44924951418584, 35.060407811951215], [-83.44918218096372, 35.060408878890584], [-83.44912158061466, 35.06039581163959], [-83.4490539805929, 35.060395479277986], [-83.44898818079498, 35.060398879366495], [-83.44892651414567, 35.06040887889056], [-83.44886311374785, 35.06041581215789], [-83.44879971424835, 35.06042261233295], [-83.44874311409725, 35.06044261210944], [-83.4486813809726, 35.060452612363434], [-83.44862338124626, 35.060470278985626], [-83.44856498087135, 35.060486478655754], [-83.44850351364803, 35.06049701200581], [-83.44844218117203, 35.06050801227785], [-83.44838071394871, 35.060518611803246], [-83.44832071367424, 35.06053161212118], [-83.44826451417175, 35.0605526788084], [-83.44820271367347, 35.060562612135584], [-83.44814138119744, 35.06057361166341], [-83.44808118059868, 35.060586411967826], [-83.44802258079774, 35.06060281235481], [-83.44796358124653, 35.060618278893344], [-83.44790238082285, 35.06062927914903], [-83.44784091359952, 35.060639678654056], [-83.44777958112351, 35.06065081199814], [-83.44771851365049, 35.060661679158216], [-83.44765738060045, 35.06067307868177], [-83.4475965808254, 35.06068507895258], [-83.44753551425069, 35.060696412294895], [-83.4474681136549, 35.060694879172445], [-83.44740751420419, 35.060707278713636], [-83.44733991418242, 35.06070601177363], [-83.44727951415766, 35.060718612052874], [-83.44721211356189, 35.06071727893521], [-83.44715091403654, 35.060728412268745], [-83.44708438121334, 35.06072907919513], [-83.44701751421684, 35.06072881227746], [-83.4469567809171, 35.0607408118048], [-83.44688918089534, 35.060739211769885], [-83.44682878087059, 35.06075201204829], [-83.4467617144481, 35.06075121203096], [-83.44670078082407, 35.06076287919485], [-83.44663311432699, 35.06076147916471], [-83.44657278077756, 35.060774278704336], [-83.44650571435507, 35.06077341177401], [-83.44643838113296, 35.06077281176115], [-83.44637791373455, 35.060784878930505], [-83.44631138091135, 35.06078581203855], [-83.4462445812885, 35.06078647896449], [-83.44617771429202, 35.060787012064104], [-83.44611091377085, 35.06078741207257], [-83.44604378087303, 35.060787612076794], [-83.44597678092588, 35.06078761207678], [-83.4459099139294, 35.06078741207255], [-83.44584298135591, 35.06078707897728], [-83.44577618083476, 35.06078661205556], [-83.44570951416257, 35.060785878951805], [-83.4456461811384, 35.060779078806895], [-83.44558231361664, 35.06077341177401], [-83.44551491391921, 35.060774611799715], [-83.44544791397205, 35.0607754118168], [-83.44538691387267, 35.060763279203506], [-83.44533178067043, 35.06078701206405], [-83.44526918067153, 35.06077681184668], [-83.44520931424607, 35.060786612055544], [-83.44514191365029, 35.06078507893475], [-83.44508071412494, 35.0607964122632], [-83.44501771437574, 35.060804011688155], [-83.44495851360189, 35.060819012002305], [-83.4448917813527, 35.06081901200233], [-83.44483278090316, 35.06083461232613], [-83.44477498060283, 35.06085241195664], [-83.44471918085065, 35.06087387930446], [-83.44465771362731, 35.06088447878239], [-83.4446055807981, 35.060913679362656], [-83.44454638092256, 35.060928812012165], [-83.44449118124498, 35.060951411714605], [-83.44443611361977, 35.06097461215751], [-83.44438518093979, 35.06100601201107]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;14&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400427412&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.5573999900000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400082835, &quot;drainage_area_sqkm&quot;: 3.8699, &quot;hydroseq&quot;: 25000400100976, &quot;length&quot;: 0.9874056400000001, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 14, &quot;nhdplusid&quot;: 25000400427412, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400120017}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.4618169809433, 35.05724501219522, -83.45451978083744, 35.06033901234701], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.4618169809433, 35.05724501219522], [-83.46173878080117, 35.05726581206621], [-83.4616837814479, 35.05728901208558], [-83.46162831407237, 35.05731147896357], [-83.46157391389542, 35.05733587904627], [-83.46152271441576, 35.057366678790736], [-83.46147138108718, 35.0573970792338], [-83.46142198093307, 35.05743161227622], [-83.46137358060388, 35.05746781231888], [-83.46132231375064, 35.05749861201358], [-83.46127158139495, 35.05753041175781], [-83.46122471359163, 35.05756941192658], [-83.46117311436171, 35.057599612282054], [-83.4611221807834, 35.057631078878764], [-83.46107131368043, 35.05766241236724], [-83.46102018067617, 35.05769341200028], [-83.46096911414722, 35.057724279260896], [-83.46091831441788, 35.05775587890547], [-83.46086578094007, 35.05778427908767], [-83.46081171403807, 35.05780921214809], [-83.46076011390983, 35.05783921166812], [-83.46070611438148, 35.057864679301126], [-83.46065438130258, 35.057894411873875], [-83.46060391394991, 35.05792647912597], [-83.46054871427233, 35.057949678957776], [-83.46049798101836, 35.0579812792505], [-83.46044798078962, 35.05801427887294], [-83.46039998110906, 35.05805127870124], [-83.46034831360718, 35.05808127886759], [-83.46030178087547, 35.05812141192266], [-83.4602503136979, 35.05815161207403], [-83.460202113693, 35.058189478797786], [-83.46015471408704, 35.058228611747055], [-83.46010851373198, 35.05826821234897], [-83.46007158129571, 35.05831081235123], [-83.46001658104412, 35.058333812063495], [-83.45996931438881, 35.05837247874346], [-83.45992258133279, 35.05841221163521], [-83.45987151390553, 35.05844307935936], [-83.45982031442591, 35.058474011780994], [-83.4597691814216, 35.058505011841305], [-83.45971831431864, 35.0585364788244], [-83.45966598116513, 35.058564878735], [-83.45961218106278, 35.05859087925547], [-83.4595601138106, 35.05862001227056], [-83.45950591395795, 35.05864461197171], [-83.45945438120333, 35.058675078853895], [-83.45939978070206, 35.05869907924572], [-83.45934871417309, 35.058730012305666], [-83.45929758116883, 35.058761012268754], [-83.45924798069038, 35.05879501235714], [-83.4592001139605, 35.05883207874635], [-83.45914458100793, 35.058854279011236], [-83.45909771410294, 35.05889387930969], [-83.45904531357577, 35.058923612243], [-83.45899878084407, 35.05896341178123], [-83.45896338093365, 35.0590066790965], [-83.45891498060446, 35.05904501235538], [-83.45886398055083, 35.059076212207266], [-83.45881271369758, 35.05910701203064], [-83.45876078119268, 35.05913661179251], [-83.45871051416434, 35.05916901165872], [-83.45865571423705, 35.05919247879546], [-83.45860458123276, 35.059223611676565], [-83.45854958098117, 35.05924687878955], [-83.45849418097932, 35.059269612051054], [-83.45843951400266, 35.059293079158884], [-83.45838451375108, 35.059316611703636], [-83.45832971382383, 35.059340278805635], [-83.45827491389653, 35.0593640120799], [-83.45821498099573, 35.05937767878374], [-83.45815958099382, 35.059400011993624], [-83.4581041136183, 35.05942241211163], [-83.45804638069163, 35.05944041205752], [-83.45799258058926, 35.05946627920609], [-83.45794131373601, 35.0594966119531], [-83.45788111403553, 35.05950967934806], [-83.457825581083, 35.05953207870069], [-83.45777038140541, 35.05955501189011], [-83.45771331413037, 35.05957401184289], [-83.45765838125243, 35.05959747886321], [-83.45759898105257, 35.05961221174252], [-83.45754398080099, 35.059635678751704], [-83.45748938119802, 35.05965961194707], [-83.45743038074846, 35.05967507866423], [-83.45737531402156, 35.05969787872068], [-83.4573159138217, 35.05971261231712], [-83.45726151364472, 35.05973721168912], [-83.45720671371745, 35.05976081175521], [-83.45714731441593, 35.05977541224757], [-83.45709238063968, 35.05979907921666], [-83.45703391378942, 35.05981541211256], [-83.45697418121291, 35.0598294787541], [-83.45691591378862, 35.05984607929978], [-83.45685771373802, 35.059863212212356], [-83.45679618093766, 35.05987367872893], [-83.45673511436298, 35.05988501218387], [-83.45667611391343, 35.059900411944476], [-83.45661838098674, 35.05991861179143], [-83.45655731441205, 35.05992947904889], [-83.4564959810377, 35.05994047866212], [-83.45643438086373, 35.05995081207634], [-83.45637351371504, 35.05996261171167], [-83.45631738068786, 35.05998341236094], [-83.45626191421066, 35.06000587923274], [-83.45620651420876, 35.060028412276914], [-83.45615018085728, 35.06004907908183], [-83.45609498117972, 35.060072012125964], [-83.45603991355449, 35.060095078991246], [-83.45598491420121, 35.06011841203431], [-83.45592991394963, 35.0601418788981], [-83.45587511402236, 35.060165411933546], [-83.45582038057042, 35.0601892787953], [-83.45576118069488, 35.060204279222354], [-83.45570518061837, 35.060225679091694], [-83.45564391371934, 35.060236678664964], [-83.45558418114285, 35.0602504121364], [-83.45552771394242, 35.0602708788796], [-83.45546631409275, 35.06028161226297], [-83.4554049807184, 35.06029247873685], [-83.4553441135697, 35.0603042121445], [-83.4552775807465, 35.0603050121662], [-83.45521571377287, 35.06031467933992], [-83.45514878119937, 35.06031441168567], [-83.45508811437499, 35.0603264789227], [-83.45502098057885, 35.06032587890659], [-83.45495371383207, 35.060324811966076], [-83.45488718100884, 35.06032541198226], [-83.4548263812338, 35.06033901234701], [-83.45475898063803, 35.060337812314835], [-83.45469778111267, 35.060326478922676], [-83.45463738108792, 35.06031381166939], [-83.45457878128697, 35.06029781197052], [-83.45451978083744, 35.060282212279446]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;15&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400499020&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.8426000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400100976, &quot;drainage_area_sqkm&quot;: 2.97730001, &quot;hydroseq&quot;: 25000400120017, &quot;length&quot;: 0.76462107, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 15, &quot;nhdplusid&quot;: 25000400499020, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400211263}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46611851427396, 35.047702479217435, -83.4618169809433, 35.05724501219522], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46611851427396, 35.047702479217435], [-83.46606558104584, 35.04776761233368], [-83.46604791387914, 35.04781647923555], [-83.46602618093748, 35.047863812009254], [-83.46599871404936, 35.04790941209267], [-83.46598211408121, 35.04795847894531], [-83.46596211398973, 35.048006611779], [-83.46594671417081, 35.04805621175595], [-83.46591971440662, 35.048101878655515], [-83.4659061812869, 35.04815207868018], [-83.4658789811984, 35.04819781171418], [-83.46585931438187, 35.04824587895425], [-83.46584018116464, 35.04829421165344], [-83.46582558084631, 35.048344079149295], [-83.46581378057675, 35.04839507916355], [-83.46579398080958, 35.04844301170545], [-83.46577438136671, 35.048491278835506], [-83.46577391424276, 35.04854601174971], [-83.46576131357428, 35.04859647919408], [-83.46574671415428, 35.04864641195775], [-83.46573711385884, 35.04869787877404], [-83.46573498125835, 35.048752012184], [-83.4657211139653, 35.048802211809104], [-83.46570718109524, 35.04885227902838], [-83.46569418067645, 35.04890267936062], [-83.46568171385694, 35.04895341207002], [-83.4656541813918, 35.04899881224738], [-83.46564171367397, 35.049049478709684], [-83.46561558078405, 35.0490954120095], [-83.46559771419136, 35.049144078819644], [-83.46556911362933, 35.049189278858336], [-83.4655519135866, 35.04923821183227], [-83.46552158107271, 35.04928287864427], [-83.46550418070566, 35.04933181229758], [-83.46548258071465, 35.049379211851075], [-83.46545598070077, 35.04942501185597], [-83.46544138128077, 35.04947487866142], [-83.46542891356293, 35.04952547864133], [-83.4654147812669, 35.049575612339595], [-83.46540218059839, 35.04962607914785], [-83.46540158142211, 35.04968067892782], [-83.46537538115854, 35.049726678795004], [-83.46537358093471, 35.049781012289735], [-83.46534871377101, 35.04982727905363], [-83.46533551392622, 35.049877678784256], [-83.46532231408143, 35.049928012297165], [-83.46531051381187, 35.04997881202715], [-83.46529771371739, 35.05002927932165], [-83.46527938089906, 35.050077878653354], [-83.46525911400794, 35.050125879335816], [-83.46525758058375, 35.050180278751526], [-83.46524251403982, 35.050229878879314], [-83.46522251394832, 35.05027801184528], [-83.46520411375636, 35.05032661176437], [-83.46519111423588, 35.05037701192226], [-83.46516558142056, 35.05042321216231], [-83.46515038102763, 35.050472812142516], [-83.46513838133208, 35.05052361226902], [-83.46512538091329, 35.050574012305354], [-83.46511098091928, 35.05062387914479], [-83.4650991806497, 35.05067481228481], [-83.46508578137893, 35.05072507912045], [-83.4650629812387, 35.05077221165057], [-83.46505518116709, 35.05082441179146], [-83.46503518107559, 35.05087247895652], [-83.46501891438244, 35.05092167934246], [-83.46500611428795, 35.05097227916152], [-83.46497938132342, 35.05101787898026], [-83.46495191443529, 35.05106347877359], [-83.46493138074452, 35.05111141195569], [-83.46491291407723, 35.05116001211427], [-83.46488558103808, 35.05120561182826], [-83.46486698142012, 35.05125401190316], [-83.46484658068002, 35.05130187878783], [-83.46481958091584, 35.051347612264436], [-83.46479251377801, 35.05139327879455], [-83.4647799813815, 35.05144381213592], [-83.46476398058964, 35.0514932791255], [-83.46474378107217, 35.05154127897615], [-83.46474078069912, 35.051595011918884], [-83.46472738142833, 35.05164527892351], [-83.46471318086033, 35.051695278949985], [-83.46469938094093, 35.05174541205182], [-83.46470111379111, 35.051800878911344], [-83.46468791394632, 35.051851278894894], [-83.46468851402095, 35.05190627871013], [-83.4646745811509, 35.05195641168233], [-83.46467511385184, 35.05201141216214], [-83.46466031410755, 35.05206121193891], [-83.46466211433136, 35.05211661166369], [-83.46464691393844, 35.05216627900661], [-83.46464871416228, 35.05222181176516], [-83.46464858121162, 35.05227661204112], [-83.46463398089328, 35.052326411656196], [-83.46463458096791, 35.05238147880689], [-83.46463631381809, 35.052436812129784], [-83.46463638119174, 35.05249167918147], [-83.46462131374946, 35.05254141174548], [-83.46462278069833, 35.052596811879944], [-83.46461011355451, 35.05264727902755], [-83.46459511438421, 35.05269707915193], [-83.46458618063872, 35.052748878749995], [-83.46458191364111, 35.05280221232138], [-83.46458338058997, 35.052857612278935], [-83.46458451426385, 35.052912812175286], [-83.46456991394555, 35.05296267905737], [-83.46456891412063, 35.053017078789644], [-83.46456951419526, 35.05307207929056], [-83.46457071434448, 35.05312747906506], [-83.46457171416938, 35.053182611859626], [-83.46457171416938, 35.0532374122263], [-83.4645567805761, 35.05328721199081], [-83.46455858079993, 35.053342679274], [-83.46454531358148, 35.05339287901906], [-83.4645239139148, 35.05344047917954], [-83.46449438090151, 35.05348527900236], [-83.46446551443817, 35.053530411925564], [-83.4644249141806, 35.05357147893709], [-83.4643841135987, 35.05361247900886], [-83.46434438111369, 35.05365367908183], [-83.46430618115456, 35.05369561230153], [-83.46427831361781, 35.053741078967875], [-83.46423871408344, 35.05378241207842], [-83.46420231434813, 35.05382501221476], [-83.46417511425965, 35.053870478809145], [-83.46414518059775, 35.05391527913153], [-83.46411838115789, 35.05396101187993], [-83.46409051362114, 35.05400627911306], [-83.46406511375648, 35.054052478770735], [-83.46403911381721, 35.05409861221902], [-83.46400551413063, 35.05414201227258], [-83.46397691356863, 35.054187211751355], [-83.46395871370096, 35.0542358122857], [-83.46393098091151, 35.054281278651295], [-83.46390238124782, 35.05432641186999], [-83.46387298118519, 35.05437121194212], [-83.46385231364545, 35.05441907920596], [-83.46383718062617, 35.05446867896557], [-83.46381351361171, 35.05451561225711], [-83.46378478099734, 35.05456061224505], [-83.46377098107794, 35.05461087889509], [-83.46374631423855, 35.054657212047104], [-83.46372018134862, 35.0547032789709], [-83.46369498090996, 35.05474947896966], [-83.46366731369753, 35.05479487886656], [-83.46363938058379, 35.05484041183895], [-83.46361078092009, 35.054885411647895], [-83.46358818110414, 35.05493267928996], [-83.46356098101566, 35.05497821218549], [-83.46353651360228, 35.05502481206542], [-83.4635071809133, 35.05506961175448], [-83.46348931432061, 35.05511847869959], [-83.46346011368398, 35.05516341217291], [-83.46344071366713, 35.05521167900815], [-83.46342351362438, 35.05526067896826], [-83.46340038110748, 35.05530761180472], [-83.46337511419348, 35.05535381219685], [-83.46336651372296, 35.055405679233445], [-83.46334698075542, 35.055454012107724], [-83.46333418066092, 35.05550447896027], [-83.46332038074154, 35.05555467884713], [-83.46330738122107, 35.05560501180273], [-83.4633095811952, 35.05566067899915], [-83.46329478055257, 35.05571041183927], [-83.4632961810261, 35.05576581202998], [-83.46328118095748, 35.055815479359524], [-83.46328238110671, 35.05587081182639], [-83.4632699142872, 35.05592127915671], [-83.46324438057354, 35.05596747920176], [-83.46322858100433, 35.056017011839096], [-83.46320718133764, 35.05606461194065], [-83.46318951417095, 35.05611327900999], [-83.46316231408245, 35.056159011998204], [-83.46314338118954, 35.0562074120789], [-83.46310991355531, 35.056250811746885], [-83.46307558084347, 35.05629407902889], [-83.46304318130612, 35.05633787868128], [-83.46300238072422, 35.05637901193312], [-83.46297338131022, 35.056423879266674], [-83.46293491365311, 35.05646567870102], [-83.4628981141675, 35.05650807889359], [-83.46284951441233, 35.05654641185476], [-83.46281318115236, 35.056589012019984], [-83.46276698079727, 35.05662841193198], [-83.46272011389227, 35.05666781182497], [-83.462672513962, 35.05670661165617], [-83.46262478108109, 35.056745012176115], [-83.46257311357918, 35.05677521210118], [-83.46252578134687, 35.0568136118534], [-83.46247931419215, 35.056853479336574], [-83.46243178073723, 35.05689187905201], [-83.46238111395857, 35.056923412102414], [-83.46232998095427, 35.05695461202976], [-83.46227878057633, 35.05698541191795], [-83.46222751372308, 35.057015878683934], [-83.46217658104311, 35.057047411686476], [-83.46212571394014, 35.05707881231505], [-83.46207071368855, 35.05710181163904], [-83.46201978100858, 35.05713327916285], [-83.46196478075699, 35.057156612316994], [-83.46190951370575, 35.05717941234132], [-83.46185451435248, 35.057202611650084], [-83.4618169809433, 35.05724501219522]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;16&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400421101&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.9912000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400120017, &quot;drainage_area_sqkm&quot;: 0.9912000100000001, &quot;hydroseq&quot;: 25000400211263, &quot;length&quot;: 1.17318721, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 16, &quot;nhdplusid&quot;: 25000400421101, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.473102981185, 35.05724501219522, -83.4618169809433, 35.05794801195263], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.473102981185, 35.05792321203031], [-83.47304218140994, 35.057934878863016], [-83.47297478081417, 35.0579338788069], [-83.47291431431408, 35.05794667878977], [-83.47284751379293, 35.05794787885696], [-83.47278011409547, 35.05794801195263], [-83.47271318062366, 35.05794707881218], [-83.47265178077397, 35.05793567890799], [-83.47258538090144, 35.05793487886303], [-83.47252178107765, 35.05792881234557], [-83.47245731437958, 35.05792447901349], [-83.47239658107986, 35.05791227906087], [-83.47233331363272, 35.05790541176122], [-83.47226778063443, 35.057902879265065], [-83.47220671405975, 35.057891878642046], [-83.47214578133402, 35.057880211803116], [-83.472084713861, 35.05786887880524], [-83.47202318106066, 35.057858478947246], [-83.47196151441133, 35.0578484791108], [-83.471900181037, 35.0578376792273], [-83.47183898061333, 35.057826479319274], [-83.47177771371432, 35.05781567869759], [-83.47171998078767, 35.0577976791287], [-83.47166091386276, 35.05778241206752], [-83.47159418071526, 35.057782478983164], [-83.47153491436437, 35.057767611942424], [-83.47147191371687, 35.057760079150555], [-83.4714131809653, 35.057744012035585], [-83.47135438084005, 35.057728211844854], [-83.4712933807407, 35.05771681191002], [-83.47123178056671, 35.05770681205623], [-83.4711705136677, 35.05769567904606], [-83.47111011364295, 35.05768307903565], [-83.47105158121566, 35.057666611881714], [-83.47099251429078, 35.05765141171175], [-83.47093118091644, 35.057640478705984], [-83.47086971369313, 35.05763021191514], [-83.47081438106488, 35.05760721200456], [-83.47074838094267, 35.057606078848174], [-83.47068998056771, 35.05758907929356], [-83.47062651369457, 35.05758267890665], [-83.47056958116681, 35.05756341229777], [-83.47050491414444, 35.05755921204265], [-83.47044638081886, 35.057542878695386], [-83.47038571399447, 35.057530678685836], [-83.47032411382048, 35.057520478797045], [-83.47026151382158, 35.05751187900516], [-83.47019838112173, 35.05750501167172], [-83.4701351136746, 35.057498011976655], [-83.47006851437605, 35.05749741193984], [-83.47000178122855, 35.05749687881872], [-83.46993491423208, 35.05749647879411], [-83.46986778133424, 35.05749647879409], [-83.4698007813871, 35.05749641187821], [-83.46973391439062, 35.05749661189051], [-83.46966691444347, 35.05749701191516], [-83.4696001139223, 35.05749767886792], [-83.46953338077479, 35.057498278904895], [-83.46946691442692, 35.05749921205046], [-83.46940638055318, 35.0575114789806], [-83.4693387140561, 35.057510211991094], [-83.46927551398258, 35.05751707932404], [-83.4692115144085, 35.05752321205269], [-83.46914471388733, 35.0575242121139], [-83.4690775136159, 35.057524479041945], [-83.46901031424272, 35.05752421211392], [-83.46894371404588, 35.057523078956244], [-83.46888311369682, 35.05751027890693], [-83.46881571399938, 35.05750921192972], [-83.46875478127363, 35.057522478919545], [-83.46868831402745, 35.05752307895625], [-83.46862171383059, 35.05752347898077], [-83.46855498068311, 35.057523478980805], [-83.46848811368662, 35.05752327896848], [-83.46842098078879, 35.05752301204044], [-83.4683541137923, 35.0575226789318], [-83.46828698089449, 35.05752227890726], [-83.46822018127163, 35.05752207889501], [-83.46815331427516, 35.057522078895005], [-83.46808658112764, 35.0575222789073], [-83.46802011388145, 35.05752281202812], [-83.46795938058173, 35.05753487894248], [-83.46789231415924, 35.05753447891807], [-83.46782498093711, 35.05753347885696], [-83.46776471386303, 35.05754601197458], [-83.46770331401336, 35.05755687881257], [-83.46763698061615, 35.05755801196966], [-83.46757478126588, 35.05756701178098], [-83.46751438124112, 35.05757961180935], [-83.46744851406955, 35.05758161193037], [-83.46738598144431, 35.05758987934195], [-83.46732438127034, 35.05760007922205], [-83.46726378092126, 35.057612679245274], [-83.46719711424907, 35.05761287925724], [-83.46713598119905, 35.05762461231476], [-83.46706911420254, 35.05762567929055], [-83.46700158065613, 35.05762547927854], [-83.46693491398395, 35.057624279206536], [-83.46687418068423, 35.057611679185094], [-83.4668075813857, 35.05761041219716], [-83.4667405140649, 35.05760987907684], [-83.46667311436744, 35.05761027910094], [-83.46660651417056, 35.057611612269326], [-83.46654598119517, 35.057624279206586], [-83.46647871444837, 35.057623479158515], [-83.46641198130087, 35.057623879182536], [-83.46635091382784, 35.0576348791063], [-83.46628978077783, 35.05764601212484], [-83.46622338090529, 35.05764821225614], [-83.46615578088353, 35.05764847918389], [-83.46608918068667, 35.057646679076406], [-83.46602838091161, 35.057634879106395], [-83.46596431396385, 35.057629611879115], [-83.46589971431516, 35.05762521235077], [-83.46583891364176, 35.05761347929332], [-83.46577791444071, 35.05760181167943], [-83.46571231406877, 35.0575996122821], [-83.46564911399528, 35.057592611859846], [-83.46558831422021, 35.05758061186983], [-83.46552718117019, 35.05756981195091], [-83.46545978057442, 35.05757067891525], [-83.46539931407433, 35.057558478909804], [-83.46533171405257, 35.05756007900709], [-83.46527071395322, 35.057548812145164], [-83.46520998065348, 35.05753661213655], [-83.46514238063172, 35.05753841224642], [-83.46508171380732, 35.05752641224851], [-83.46502038133131, 35.057515479225934], [-83.46495311368619, 35.05751661164831], [-83.46489238128477, 35.05750467929838], [-83.46483131381176, 35.05749347934472], [-83.46476518073888, 35.057492079258466], [-83.46470251426464, 35.05748401184938], [-83.46464151416527, 35.05747267879641], [-83.46458038111527, 35.05746141192254], [-83.46451951396654, 35.057449878853994], [-83.46445811411687, 35.05743921201432], [-83.46439178071967, 35.05743821195203], [-83.46432991374604, 35.05742867900502], [-83.46426678104619, 35.05742141163966], [-83.4642021813975, 35.05741707901594], [-83.46413458137573, 35.057418679115955], [-83.46406958107838, 35.05741527890334], [-83.46400751378046, 35.05740621215936], [-83.46394051383331, 35.05740661218447], [-83.46387318061119, 35.05740767916313], [-83.4638061141887, 35.05740827920063], [-83.46373991374216, 35.05740741223456], [-83.4636789136428, 35.057396012255], [-83.46361238081958, 35.05739561222987], [-83.4635457141474, 35.05739567914593], [-83.46347878067559, 35.0573958791584], [-83.46341178072845, 35.057396412280134], [-83.46334478078128, 35.0573968792212], [-83.46327778083413, 35.057397412342965], [-83.46321091383766, 35.05739787928396], [-83.46314398126412, 35.05739807929655], [-83.46307718074299, 35.05739821165779], [-83.46301058144445, 35.05739801164529], [-83.46294638064772, 35.05739301206663], [-83.46288258139792, 35.05738687932831], [-83.46282211399951, 35.057374479282764], [-83.46275831385141, 35.05736881201361], [-83.46269318060345, 35.05736561181157], [-83.46263198107806, 35.0573542787422], [-83.46257098097871, 35.05734287875522], [-83.46251011382999, 35.057331611863304], [-83.46244858102966, 35.05732081191145], [-83.46238731413065, 35.0573098788614], [-83.4623259807563, 35.05729921200336], [-83.46226498065694, 35.05728787892486], [-83.46220391408225, 35.05727667894137], [-83.4621425807079, 35.057266012079076], [-83.46207531396112, 35.05726701214343], [-83.46201458066139, 35.05725481209273], [-83.46194738128827, 35.05725567906034], [-83.46188011364313, 35.05725687913778], [-83.4618169809433, 35.05724501219522]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;17&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400334861&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 1.14349999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400120017, &quot;drainage_area_sqkm&quot;: 1.14349999, &quot;hydroseq&quot;: 25000400248911, &quot;length&quot;: 1.03523974, &quot;name&quot;: &quot;Pinnacle Branch&quot;, &quot;new_preorder_index&quot;: 17, &quot;nhdplusid&quot;: 25000400334861, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45858018119301, 35.060282212279446, -83.45434738065968, 35.06571067921658], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45858018119301, 35.06571067921658], [-83.45855211423029, 35.06566527877187], [-83.45851331419654, 35.06562361198361], [-83.4584755139877, 35.06558161209828], [-83.45843911425239, 35.06553907912292], [-83.4583923138227, 35.06549947910661], [-83.45834391439182, 35.06546127902073], [-83.45829218131293, 35.065431011722765], [-83.45824078061068, 35.06540061206538], [-83.45818958113107, 35.06536947933397], [-83.45813831427782, 35.06533867893226], [-83.45809151384813, 35.065298678832384], [-83.4580397142939, 35.06526901218922], [-83.45799258058926, 35.065229878938176], [-83.45794578105792, 35.0651902118623], [-83.45789398060536, 35.06516021210223], [-83.4578469807497, 35.065120811895795], [-83.45779151427247, 35.06509841187073], [-83.4577403812682, 35.0650672790241], [-83.45768958064056, 35.06503541236462], [-83.45763591438717, 35.06500941169062], [-83.45758278083476, 35.064982278689584], [-83.45753571360542, 35.064943212210856], [-83.45748491387612, 35.06491141167749], [-83.45743298137121, 35.06488167871903], [-83.45738631389221, 35.06484161222061], [-83.45733458081332, 35.06481187923679], [-83.457287513584, 35.064772411952276], [-83.45724038077768, 35.06473327919843], [-83.45718871417411, 35.06470327927052], [-83.45714191374444, 35.06466327885926], [-83.45708998123956, 35.0646336788952], [-83.45704338113418, 35.06459367918512], [-83.45699171363229, 35.0645636122958], [-83.45694051415269, 35.06453287923535], [-83.45689331397273, 35.06449387871642], [-83.45684251424339, 35.064461878748084], [-83.45679091411517, 35.06443181181008], [-83.45673951431124, 35.06440107870008], [-83.4566883139333, 35.064370211757904], [-83.45663751420399, 35.06433841173666], [-83.45658198125143, 35.06431567915122], [-83.45653051407386, 35.06428547907412], [-83.45647438104672, 35.0642640787985], [-83.4564183809702, 35.064242812337895], [-83.45636271416868, 35.06422087897392], [-83.45630691441649, 35.06419881178331], [-83.4562515144146, 35.064176212244554], [-83.45619578113777, 35.06415427886268], [-83.45613711396318, 35.06413807918509], [-83.45608258083553, 35.06411381201504], [-83.45602811418323, 35.06408941175203], [-83.45597238090636, 35.06406741217165], [-83.45591698090449, 35.06404481186125], [-83.45586598085085, 35.06401321170949], [-83.45581078117327, 35.06399041212296], [-83.45575978111965, 35.06395887886083], [-83.45570451406843, 35.06393601234853], [-83.45565338106414, 35.06390461215127], [-83.45559818138656, 35.06388201179584], [-83.45554311376134, 35.06385881217914], [-83.4554921137077, 35.063827211955484], [-83.45543691403013, 35.0638044792277], [-83.45538578102583, 35.06377307897988], [-83.45533451417258, 35.06374221180029], [-83.45528231396972, 35.0637126122375], [-83.45523491436376, 35.06367321206765], [-83.4551987814281, 35.063630411925004], [-83.45514991397496, 35.06359227934587], [-83.45511338128898, 35.063549812244915], [-83.45507491363188, 35.06350787893881], [-83.45503598064747, 35.063466278695685], [-83.45499531391454, 35.06342541224663], [-83.45495431390667, 35.06338447886616], [-83.45491418077303, 35.063343211644955], [-83.45487591433856, 35.063301412055054], [-83.45484771442516, 35.063256211739116], [-83.45481011364231, 35.063214079019275], [-83.45477131360856, 35.06317241171507], [-83.45474371376979, 35.06312687897729], [-83.45471418075651, 35.063082011650586], [-83.45468671386837, 35.06303647886236], [-83.45465858132862, 35.062991079136175], [-83.45463398096454, 35.06294467865467], [-83.45461118082434, 35.0628976119734], [-83.45459218055777, 35.06284907909443], [-83.45456591381885, 35.062803212353785], [-83.4545529807737, 35.06275267868911], [-83.45452551388559, 35.06270721189352], [-83.45449918067132, 35.0626612119852], [-83.45447151435721, 35.062615812050375], [-83.45444878069232, 35.06256861209128], [-83.45443091409965, 35.062519679016646], [-83.4544043805611, 35.06247387900288], [-83.45439218143954, 35.0624232120458], [-83.45437858094613, 35.06237281196972], [-83.45436391415248, 35.062323011863825], [-83.45435271395752, 35.06227181172337], [-83.45434958063382, 35.06221787918772], [-83.45434831400927, 35.062163078965554], [-83.45434751361034, 35.06210801179356], [-83.45434738065968, 35.06205267914171], [-83.4543477813083, 35.06199761189517], [-83.45434858080893, 35.06194267917129], [-83.4543501142331, 35.061888211855326], [-83.4543645142271, 35.061838212187375], [-83.4543623807283, 35.06178267935087], [-83.45437591384807, 35.0617324788812], [-83.45437531377344, 35.06167747906647], [-83.45438971376747, 35.06162747926961], [-83.4544037813848, 35.06157747870678], [-83.45441351373259, 35.061525878829116], [-83.45441478125545, 35.06147161197291], [-83.45442938067545, 35.06142167896259], [-83.45444331444382, 35.06137147900624], [-83.45445578126333, 35.06132087901315], [-83.45446991355936, 35.061270878997846], [-83.45446798128322, 35.06121541195292], [-83.45447858140356, 35.06116407876265], [-83.45448358142643, 35.06111101168667], [-83.45448271365386, 35.06105601218856], [-83.45448151440297, 35.061000678823646], [-83.4544825807032, 35.06094527924349], [-83.45448171382895, 35.06089067890648], [-83.45446678113399, 35.060840811718656], [-83.45446551361111, 35.060786078956056], [-83.45446458115987, 35.060731212330175], [-83.4544641140359, 35.06067587874513], [-83.45446418140955, 35.060620812040604], [-83.45446458115987, 35.06056581221224], [-83.45446558098477, 35.06051087926024], [-83.45446711440897, 35.060456611729364], [-83.45448038072907, 35.06040627882323], [-83.4544795138548, 35.060351078845045], [-83.45451978083744, 35.060282212279446]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;18&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400492705&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.3352, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400100976, &quot;drainage_area_sqkm&quot;: 0.3352, &quot;hydroseq&quot;: 25000400179589, &quot;length&quot;: 0.78662657, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 18, &quot;nhdplusid&quot;: 25000400492705, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45417971370517, 35.06100601201107, -83.44438518093979, 35.068462478993716], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45417971370517, 35.06842641175791], [-83.45411218105706, 35.06842527875169], [-83.45405031408343, 35.06843501187055], [-83.45398438133485, 35.06843667866161], [-83.45392398131008, 35.06844947920359], [-83.45385651423896, 35.06844807930517], [-83.45379598126357, 35.06846061221777], [-83.45372938106671, 35.06846187903733], [-83.45366218079525, 35.06846241208679], [-83.45359491404847, 35.068462478993716], [-83.45352798057665, 35.06846181213048], [-83.45346158070409, 35.0684604791392], [-83.45340038117874, 35.068449079232565], [-83.45333938107936, 35.068437679324354], [-83.45327978055523, 35.06842347888176], [-83.45322238090351, 35.068405078739616], [-83.45316591370306, 35.0683844787513], [-83.4531103807505, 35.06836181199392], [-83.4530553140236, 35.06833861218001], [-83.45300438134362, 35.06830741219169], [-83.45295331391635, 35.068275812219646], [-83.45289858136272, 35.068251879344494], [-83.45284271423691, 35.068230211745174], [-83.45278718128434, 35.06820801182416], [-83.45273111383419, 35.06818647876265], [-83.45268131392979, 35.06815307886801], [-83.45262611425221, 35.06812961210136], [-83.45257511419857, 35.06809847894036], [-83.45252718099334, 35.06806047932191], [-83.45247931426341, 35.06802207897754], [-83.45243158138248, 35.067983211734564], [-83.45238431382886, 35.0679442121289], [-83.45233738134684, 35.0679050117826], [-83.45229098066747, 35.067865679073144], [-83.45225431413253, 35.06782341197659], [-83.45220551405302, 35.067785079163386], [-83.4521603144212, 35.06774561184592], [-83.45212238126169, 35.067703479237444], [-83.45207511370808, 35.06766421186794], [-83.45202691370318, 35.06762581207238], [-83.45197471439866, 35.06759641169968], [-83.4519281142933, 35.06755641197101], [-83.45187618089008, 35.06752641234531], [-83.45182531378713, 35.0674952120465], [-83.4517743137335, 35.067463478679876], [-83.45172311425388, 35.067432479080274], [-83.4516687140769, 35.06740801216625], [-83.4516127140004, 35.06738647889367], [-83.4515617139468, 35.06735487930041], [-83.45150231374693, 35.06734041177342], [-83.45144551416985, 35.067320812192904], [-83.45138371367155, 35.06731067896449], [-83.45132258062152, 35.06729947888555], [-83.45126131372251, 35.06728881186225], [-83.45120011419715, 35.06727747869979], [-83.45113871434748, 35.067267011661976], [-83.45107738097313, 35.06725607920859], [-83.45101678062407, 35.06724381227203], [-83.45095178122506, 35.06724027865288], [-83.45089351380079, 35.067223611967606], [-83.45083031372728, 35.06721647929005], [-83.45076698070314, 35.06720981202616], [-83.45070851385287, 35.06719301225401], [-83.45064918102666, 35.06717827927234], [-83.45058738142669, 35.067168479095606], [-83.45052698140194, 35.06715561217999], [-83.45047218057633, 35.06713201204586], [-83.45041731417372, 35.067108478812926], [-83.45036191417185, 35.0670856793556], [-83.45030858119343, 35.06705887864395], [-83.45025551411634, 35.06703147869178], [-83.45020458143634, 35.06700007895009], [-83.45015618110716, 35.06696261187955], [-83.45010851380324, 35.06692361178624], [-83.45006198107153, 35.06688401170638], [-83.45002438118698, 35.066841811744894], [-83.44998631417852, 35.066799878659474], [-83.44995538069169, 35.066755678758334], [-83.44992051438058, 35.06671267877159], [-83.44989258126684, 35.06666721197578], [-83.44986191368133, 35.06662281201289], [-83.44982651377093, 35.06657987886465], [-83.44978731398689, 35.06653841179816], [-83.44975371430033, 35.066494878634686], [-83.4497223810632, 35.066450811650164], [-83.44968411373041, 35.06640887909914], [-83.44964638089525, 35.06636687888264], [-83.44960878101067, 35.066324878644494], [-83.44956698060389, 35.06628407906481], [-83.44952431422114, 35.06624367871115], [-83.4494769810905, 35.06620421211888], [-83.44942918083593, 35.06616567928946], [-83.44938098083107, 35.06612801184475], [-83.44932991430208, 35.06609661175541], [-83.44927831417385, 35.066066479246054], [-83.44922711379591, 35.06603547911583], [-83.4491799809896, 35.06599621167916], [-83.4491289135623, 35.06596501226605], [-83.4490775137584, 35.06593427899793], [-83.44902611395449, 35.06590367880095], [-83.44897918057413, 35.06586421204435], [-83.44892751397057, 35.06583421179669], [-83.44887918101503, 35.065797478720405], [-83.44882898136031, 35.06576441165843], [-83.44877398110876, 35.06574101184938], [-83.44872278073079, 35.06570987924783], [-83.44866771400388, 35.06568687867242], [-83.44861671395024, 35.06565547914863], [-83.448561580748, 35.065632011663986], [-83.44850618074612, 35.065609478695976], [-83.44845491389286, 35.06557847912753], [-83.44840418063886, 35.065546678841635], [-83.44834891358764, 35.065523878948106], [-83.44829331415977, 35.06550167902636], [-83.44823738055858, 35.06547987908402], [-83.4481839137312, 35.06545361164945], [-83.44812831430332, 35.06543141170855], [-83.44807551402587, 35.06540367886888], [-83.4480219142478, 35.06537721215209], [-83.44797098066951, 35.065345811773945], [-83.44791931406594, 35.065315412084864], [-83.44787091373675, 35.065277011919534], [-83.44782671392986, 35.0652366118027], [-83.44779638141594, 35.065192078713], [-83.44775998078232, 35.06514961170897], [-83.44773098136832, 35.06510447932602], [-83.44769298083517, 35.06506261225777], [-83.44765498120034, 35.06502061208382], [-83.44760831372132, 35.0649816787076], [-83.44756058084039, 35.06494321221083], [-83.44751258115981, 35.06490461187626], [-83.4474647144299, 35.06486601225873], [-83.44741751424992, 35.064827278803286], [-83.44738078123964, 35.064784812344655], [-83.44734291365715, 35.06474281202779], [-83.44730511434662, 35.06470087933463], [-83.44727818105778, 35.064655079073944], [-83.44725611394284, 35.064607811913376], [-83.44725118129361, 35.06455447870022], [-83.44725258086882, 35.064499079325884], [-83.44723651360164, 35.064449479041826], [-83.44723498107577, 35.064394078860964], [-83.44723698072559, 35.06433921171883], [-83.4472529806191, 35.064289412077216], [-83.44725391396868, 35.06423401178775], [-83.44725131424424, 35.064179212183674], [-83.44723838119911, 35.064128611725], [-83.44721611375986, 35.06408121190917], [-83.44719698144092, 35.0640328789948], [-83.44716978135246, 35.06398721218054], [-83.44714011359187, 35.06394247914793], [-83.44711238080242, 35.06389701227967], [-83.44708418088902, 35.06385181229358], [-83.44704951400388, 35.06380881224773], [-83.44701671381792, 35.06376501219143], [-83.44698938077877, 35.06371927905173], [-83.44694198117281, 35.063680611962894], [-83.44692951435329, 35.06363001193049], [-83.44690258106446, 35.063584211804326], [-83.4468753136023, 35.06353867929614], [-83.44684891391273, 35.0634926791211], [-83.4468213814476, 35.06344721200235], [-83.44679511381037, 35.063401411773626], [-83.44676858117015, 35.0633554791676], [-83.44674171435665, 35.0633096788874], [-83.44671398066885, 35.06326421166671], [-83.44667558128373, 35.06322247894751], [-83.44664751432099, 35.06317707932479], [-83.44660918141119, 35.06313521200328], [-83.44658138124808, 35.06308987924333], [-83.44655298101038, 35.06304467881025], [-83.44651458072694, 35.06300281215611], [-83.44648651376421, 35.06295741167596], [-83.4464585141751, 35.06291207881714], [-83.44642011389165, 35.06287041209422], [-83.44638191393251, 35.06282847917444], [-83.44635338074414, 35.062783279331946], [-83.44630578081386, 35.06274461179975], [-83.44626938107855, 35.06270221190471], [-83.44622071394971, 35.06266387889233], [-83.44618391356579, 35.06262161204336], [-83.44613771410904, 35.06258207899414], [-83.44609058130273, 35.06254281210209], [-83.44604291399878, 35.06250401210311], [-83.44599478136756, 35.062465878997834], [-83.4459427805907, 35.06243601206028], [-83.4458959136857, 35.06239661200953], [-83.44584471420607, 35.0623658119567], [-83.44579611355257, 35.062328411876784], [-83.44574818124563, 35.06228947868721], [-83.44570178056627, 35.062249879300474], [-83.44566518140498, 35.06220741223641], [-83.44562738119613, 35.06216547897613], [-83.44558971393795, 35.06212347878217], [-83.44555038120325, 35.062081879304074], [-83.44551371376997, 35.06203941215266], [-83.44546778111287, 35.06199921190543], [-83.44542018118258, 35.06196001164527], [-83.44537018095389, 35.061925679049004], [-83.44531518070228, 35.0619018788719], [-83.44526698069741, 35.06186381166232], [-83.4452197140421, 35.0618240789797], [-83.44517371401135, 35.06178421171764], [-83.44513658125076, 35.06174187897148], [-83.44509931374289, 35.061699679292886], [-83.44505411411106, 35.06166027888681], [-83.44501331442747, 35.06161921226685], [-83.44497478119337, 35.0615774787068], [-83.4449273806891, 35.06153881207405], [-83.44489351420287, 35.061495479188075], [-83.44486211359212, 35.06145121170805], [-83.44482638130506, 35.061408611873745], [-83.4447863811221, 35.061367278946975], [-83.44475798088439, 35.06132201211803], [-83.4447197135516, 35.06128021222844], [-83.44467178124465, 35.06124167928072], [-83.44463591421031, 35.06119887933381], [-83.44458878140398, 35.06115941177316], [-83.4445407808251, 35.061120878768264], [-83.44448871357291, 35.06109107898692], [-83.44444098069197, 35.06105301213466], [-83.44438518093979, 35.06100601201107]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;19&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400385380&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.9075000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400082835, &quot;drainage_area_sqkm&quot;: 0.9075000100000001, &quot;hydroseq&quot;: 25000400226762, &quot;length&quot;: 1.2907057499999999, &quot;name&quot;: &quot;Camprock Branch&quot;, &quot;new_preorder_index&quot;: 19, &quot;nhdplusid&quot;: 25000400385380, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44330998108802, 35.063420212304074, -83.43926918107363, 35.07145587901515], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44320798098076, 35.07145587901515], [-83.44318018081766, 35.07141047882514], [-83.44315398055409, 35.071364478674965], [-83.44314111398427, 35.07131407897288], [-83.44312291411661, 35.07126541214239], [-83.4431119807213, 35.07121401175042], [-83.44311091442106, 35.07115867865415], [-83.44311078057207, 35.07110347932979], [-83.44311211367197, 35.07104861228629], [-83.44312771381517, 35.070998812326934], [-83.44312618128932, 35.070943412179865], [-83.44314098103361, 35.07089367906106], [-83.44313878105949, 35.070838078863076], [-83.44315258097888, 35.07078787881563], [-83.44315411440307, 35.070733412255024], [-83.44315491390367, 35.07067867877289], [-83.44315531365399, 35.070623812179036], [-83.44315558135193, 35.07056881173805], [-83.44315571430259, 35.07051367891991], [-83.44315538102762, 35.07045861223467], [-83.44315498127733, 35.070403611682266], [-83.4431541808784, 35.070348611827995], [-83.44315331400414, 35.070293811917686], [-83.44315198090426, 35.070239211951595], [-83.44313778123457, 35.07018907917653], [-83.4431247808158, 35.07013867874863], [-83.44311411422012, 35.070087412193466], [-83.44310571407387, 35.07003527877408], [-83.44308531423209, 35.06998741184296], [-83.44308518128142, 35.06993241170829], [-83.44306971408886, 35.06988287869067], [-83.44307158078804, 35.0698272792744], [-83.44305618096911, 35.069777679287206], [-83.44304378062492, 35.069727011717], [-83.44302958095524, 35.06967687936252], [-83.4430097138144, 35.06962881223871], [-83.44300031384327, 35.06957607931349], [-83.44300471379154, 35.0695216788501], [-83.44301618078613, 35.06947067879629], [-83.44304318144863, 35.06942507898936], [-83.44305671367007, 35.06937481190198], [-83.44306851393964, 35.06932407864592], [-83.44308231385904, 35.069273812231586], [-83.44309598082779, 35.06922367886357], [-83.44310898124657, 35.069173279309894], [-83.4431269807899, 35.069124478860466], [-83.44314838135493, 35.0690768790208], [-83.4431749813688, 35.0690310790098], [-83.44318791441393, 35.068980679337244], [-83.44321331427861, 35.06893447930371], [-83.44322151410053, 35.06888227897657], [-83.44324131386769, 35.068834212119945], [-83.44324138124134, 35.068779478834635], [-83.44325618098566, 35.06872961205438], [-83.44325538058673, 35.06867447872918], [-83.44325398101151, 35.06861921228833], [-83.44325351388758, 35.06856427887362], [-83.44326878075583, 35.06851461194724], [-83.44327838105127, 35.0684630120431], [-83.4432805810254, 35.0684088792009], [-83.44329451389548, 35.068358812208515], [-83.44329298136958, 35.06830341173992], [-83.44330778111387, 35.06825367921819], [-83.44330891388945, 35.068198878636444], [-83.44330971428836, 35.06814407875325], [-83.44330998108802, 35.06808907884677], [-83.44330998108802, 35.06803387891682], [-83.4433095813377, 35.06797881202882], [-83.44330871356516, 35.067923678931635], [-83.44330758078958, 35.06786907885049], [-83.44329891384373, 35.06781687931241], [-83.4432937808702, 35.06776381214965], [-83.44327991357713, 35.067713611681796], [-83.4432663813557, 35.06766327883854], [-83.44325178103738, 35.06761341211158], [-83.44322598142243, 35.067567212039364], [-83.44319858100964, 35.067521678811936], [-83.44317258107036, 35.067475611767925], [-83.44312811356549, 35.06743587887563], [-83.44308051363521, 35.06739727898463], [-83.44305178102083, 35.0673520787309], [-83.44301171436256, 35.06731087895276], [-83.44298491402436, 35.06726521176653], [-83.44294738061514, 35.06722301200222], [-83.4429189139021, 35.06717781165191], [-83.4429045139081, 35.06712787919093], [-83.44288098074261, 35.067080878888575], [-83.44286291382562, 35.067032211739566], [-83.44283611438576, 35.0669864120517], [-83.44281458087008, 35.06693881170042], [-83.44279638100241, 35.06689021211002], [-83.44276998131284, 35.0668442123531], [-83.44274218114975, 35.0667988118037], [-83.44272931368161, 35.066748412223106], [-83.44271678128509, 35.066697678805134], [-83.44270191416715, 35.06664787913187], [-83.44267491440299, 35.06660221231001], [-83.44266251405878, 35.066551478801095], [-83.44263498069532, 35.06650601191552], [-83.44260798093113, 35.066460278841035], [-83.44258151386792, 35.066414478832264], [-83.44255531360434, 35.06636847880726], [-83.44252091441717, 35.06632521171724], [-83.44248278093336, 35.066283279101704], [-83.44244731364931, 35.06624047885697], [-83.44240791443927, 35.06619907926209], [-83.44235931378579, 35.066160811859554], [-83.4423229814241, 35.06611827918589], [-83.44227411397097, 35.06608007865434], [-83.44223791366166, 35.06603747902972], [-83.44219011430538, 35.065998812303775], [-83.4421411812752, 35.06596061171629], [-83.4421045812156, 35.06591821202104], [-83.4420575139863, 35.06587861218865], [-83.44200571443206, 35.065849078839115], [-83.44195911432669, 35.06580907898931], [-83.4419071809235, 35.06577907872147], [-83.44185931419356, 35.06574107875858], [-83.44181151393899, 35.065702611884326], [-83.44176391400872, 35.06566367883347], [-83.44171671382877, 35.06562467885481], [-83.44166991429738, 35.06558541195577], [-83.44163231441284, 35.06554321205826], [-83.4415865138081, 35.065504012029386], [-83.44153918067745, 35.06546507888383], [-83.44149151427186, 35.06542661187952], [-83.44144358106661, 35.065388011773585], [-83.44139591376268, 35.06534941164932], [-83.44134838120607, 35.06531067915851], [-83.44130131397674, 35.06527181209486], [-83.44126451359281, 35.0652294789514], [-83.44121671423655, 35.06519087875218], [-83.4411785142774, 35.065149011728224], [-83.44114178126712, 35.065106679256374], [-83.44109518116178, 35.065067679011555], [-83.44106578109914, 35.06502281201639], [-83.44102698106539, 35.064981078725744], [-83.44099951417725, 35.06493567934574], [-83.44096178134207, 35.06489361219669], [-83.44093471420425, 35.0648478120442], [-83.44091351396352, 35.06480021191627], [-83.44089491434558, 35.064751678697796], [-83.4408677142571, 35.064706079195616], [-83.44084691376669, 35.06465821208031], [-83.44082798087376, 35.06460981186218], [-83.44080131438453, 35.064564012285764], [-83.44077378102108, 35.06451847885358], [-83.44074738133152, 35.06447247923064], [-83.4407137142713, 35.06442921187099], [-83.44068011368643, 35.06438567905315], [-83.44064871397397, 35.06434147931535], [-83.44061058138848, 35.064299611855695], [-83.4405723140557, 35.0642576789348], [-83.44052531420003, 35.06421901210101], [-83.44047711419515, 35.0641804121593], [-83.44044111421013, 35.064137612282614], [-83.44039398140382, 35.064098212317845], [-83.44034551370096, 35.06406001231148], [-83.44029358119607, 35.06403041212866], [-83.44024691371709, 35.063990612119376], [-83.44019931378678, 35.06395221206618], [-83.44014838110682, 35.06392067878929], [-83.44009698130289, 35.063890079308], [-83.44004611419992, 35.06385867909315], [-83.43999331392247, 35.063830611900975], [-83.4399393143941, 35.06380541230125], [-83.43989218068945, 35.063766079086875], [-83.43984111416049, 35.06373487882137], [-83.43978998115622, 35.06370367927919], [-83.43973891372895, 35.06367261207613], [-83.43968771424932, 35.06364167868297], [-83.43963638092075, 35.06361067910245], [-83.43958518144113, 35.06357987877238], [-83.43953378073887, 35.063549012254974], [-83.43947931408657, 35.06352481182073], [-83.43942758100766, 35.06349467909728], [-83.43937271370675, 35.063471411724294], [-83.43926918107363, 35.063420212304074]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;20&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400423603&quot;, &quot;__folium_color&quot;: &quot;black&quot;, &quot;catchment_area&quot;: 0.7604999800000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400064695, &quot;drainage_area_sqkm&quot;: 0.7604999800000001, &quot;hydroseq&quot;: 25000400210191, &quot;length&quot;: 1.04463018, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 20, &quot;nhdplusid&quot;: 25000400423603, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
    geo_json_59c10e85b0fdcf8f6c77b62af36c96b4.bindPopup(
    function(layer){
    let div = L.DomUtil.create(&#x27;div&#x27;);
    
    let handleObject = feature =&gt; {
        if (feature === null) {
            return &#x27;&#x27;;
        } else if (typeof(feature)==&#x27;object&#x27;) {
            return JSON.stringify(feature);
        } else {
            return feature;
        }
    }
    let fields = [&quot;ID&quot;, &quot;name&quot;, &quot;stream_order&quot;, &quot;divergence&quot;, &quot;hydroseq&quot;, &quot;dnhydroseq&quot;, &quot;uphydroseq&quot;, &quot;length&quot;, &quot;catchment_area&quot;];
    let aliases = [&quot;ID&quot;, &quot;name&quot;, &quot;stream_order&quot;, &quot;divergence&quot;, &quot;hydroseq&quot;, &quot;dnhydroseq&quot;, &quot;uphydroseq&quot;, &quot;length&quot;, &quot;catchment_area&quot;];
    let table = &#x27;&lt;table&gt;&#x27; +
        String(
        fields.map(
        (v,i)=&gt;
        `&lt;tr&gt;
            &lt;th&gt;${aliases[i].toLocaleString()}&lt;/th&gt;
            
            &lt;td&gt;${handleObject(layer.feature.properties[v]).toLocaleString()}&lt;/td&gt;
        &lt;/tr&gt;`).join(&#x27;&#x27;))
    +&#x27;&lt;/table&gt;&#x27;;
    div.innerHTML=table;
    
    return div
    }
    ,{
  &quot;className&quot;: &quot;foliumpopup&quot;,
});
                     
    
            geo_json_59c10e85b0fdcf8f6c77b62af36c96b4.addTo(map_f692b53c90bdb78aae5d189c6aa914a5);
        
    
        function geo_json_e326ffca67b4f9eaae03da233afeace9_styler(feature) {
            switch(feature.id) {
                case &quot;0&quot;: 
                    return {&quot;color&quot;: &quot;#dc4d01&quot;, &quot;fillColor&quot;: &quot;#dc4d01&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;1&quot;: 
                    return {&quot;color&quot;: &quot;#3a2efe&quot;, &quot;fillColor&quot;: &quot;#3a2efe&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;2&quot;: 
                    return {&quot;color&quot;: &quot;#0d75f8&quot;, &quot;fillColor&quot;: &quot;#0d75f8&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;3&quot;: 
                    return {&quot;color&quot;: &quot;#0203e2&quot;, &quot;fillColor&quot;: &quot;#0203e2&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;4&quot;: 
                    return {&quot;color&quot;: &quot;#ff474c&quot;, &quot;fillColor&quot;: &quot;#ff474c&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;5&quot;: 
                    return {&quot;color&quot;: &quot;#2cfa1f&quot;, &quot;fillColor&quot;: &quot;#2cfa1f&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;6&quot;: 
                    return {&quot;color&quot;: &quot;#fb5581&quot;, &quot;fillColor&quot;: &quot;#fb5581&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;7&quot;: 
                    return {&quot;color&quot;: &quot;#fff917&quot;, &quot;fillColor&quot;: &quot;#fff917&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;8&quot;: 
                    return {&quot;color&quot;: &quot;#2fef10&quot;, &quot;fillColor&quot;: &quot;#2fef10&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;10&quot;: 
                    return {&quot;color&quot;: &quot;#3e82fc&quot;, &quot;fillColor&quot;: &quot;#3e82fc&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;11&quot;: 
                    return {&quot;color&quot;: &quot;#0485d1&quot;, &quot;fillColor&quot;: &quot;#0485d1&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;12&quot;: 
                    return {&quot;color&quot;: &quot;#5d06e9&quot;, &quot;fillColor&quot;: &quot;#5d06e9&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;13&quot;: 
                    return {&quot;color&quot;: &quot;#b1ff65&quot;, &quot;fillColor&quot;: &quot;#b1ff65&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;14&quot;: 
                    return {&quot;color&quot;: &quot;#f5054f&quot;, &quot;fillColor&quot;: &quot;#f5054f&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;15&quot;: 
                    return {&quot;color&quot;: &quot;#1ef876&quot;, &quot;fillColor&quot;: &quot;#1ef876&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;16&quot;: 
                    return {&quot;color&quot;: &quot;#ff7855&quot;, &quot;fillColor&quot;: &quot;#ff7855&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;17&quot;: 
                    return {&quot;color&quot;: &quot;#c2be0e&quot;, &quot;fillColor&quot;: &quot;#c2be0e&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;18&quot;: 
                    return {&quot;color&quot;: &quot;#bff128&quot;, &quot;fillColor&quot;: &quot;#bff128&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;19&quot;: 
                    return {&quot;color&quot;: &quot;#9dc100&quot;, &quot;fillColor&quot;: &quot;#9dc100&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                case &quot;20&quot;: 
                    return {&quot;color&quot;: &quot;#ad03de&quot;, &quot;fillColor&quot;: &quot;#ad03de&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
                default:
                    return {&quot;color&quot;: &quot;#c9b003&quot;, &quot;fillColor&quot;: &quot;#c9b003&quot;, &quot;fillOpacity&quot;: 0.5, &quot;weight&quot;: 5};
            }
        }
        function geo_json_e326ffca67b4f9eaae03da233afeace9_highlighter(feature) {
            switch(feature.id) {
                default:
                    return {&quot;fillOpacity&quot;: 0.75};
            }
        }
        function geo_json_e326ffca67b4f9eaae03da233afeace9_pointToLayer(feature, latlng) {
            var opts = {
  &quot;stroke&quot;: true,
  &quot;color&quot;: &quot;#3388ff&quot;,
  &quot;weight&quot;: 3,
  &quot;opacity&quot;: 1.0,
  &quot;lineCap&quot;: &quot;round&quot;,
  &quot;lineJoin&quot;: &quot;round&quot;,
  &quot;dashArray&quot;: null,
  &quot;dashOffset&quot;: null,
  &quot;fill&quot;: true,
  &quot;fillColor&quot;: &quot;#3388ff&quot;,
  &quot;fillOpacity&quot;: 0.2,
  &quot;fillRule&quot;: &quot;evenodd&quot;,
  &quot;bubblingMouseEvents&quot;: true,
  &quot;radius&quot;: 2,
};
            
            let style = geo_json_e326ffca67b4f9eaae03da233afeace9_styler(feature)
            Object.assign(opts, style)
            
            return new L.CircleMarker(latlng, opts)
        }

        function geo_json_e326ffca67b4f9eaae03da233afeace9_onEachFeature(feature, layer) {

            layer.on({
                mouseout: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                            geo_json_e326ffca67b4f9eaae03da233afeace9.resetStyle(e.target);
                    }
                },
                mouseover: function(e) {
                    if(typeof e.target.setStyle === &quot;function&quot;){
                        const highlightStyle = geo_json_e326ffca67b4f9eaae03da233afeace9_highlighter(e.target.feature)
                        e.target.setStyle(highlightStyle);
                    }
                },
            });
        };
        var geo_json_e326ffca67b4f9eaae03da233afeace9 = L.geoJson(null, {
                onEachFeature: geo_json_e326ffca67b4f9eaae03da233afeace9_onEachFeature,
            
                style: geo_json_e326ffca67b4f9eaae03da233afeace9_styler,
                pointToLayer: geo_json_e326ffca67b4f9eaae03da233afeace9_pointToLayer,
            ...{
}
        });

        function geo_json_e326ffca67b4f9eaae03da233afeace9_add (data) {
            geo_json_e326ffca67b4f9eaae03da233afeace9
                .addData(data);
        }
            geo_json_e326ffca67b4f9eaae03da233afeace9_add({&quot;bbox&quot;: [-83.473102981185, 35.03353921194884, -83.42540831271198, 35.07145587901515], &quot;features&quot;: [{&quot;bbox&quot;: [-83.42887071363768, 35.059718446001504, -83.42540831271198, 35.06063518003814], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.42887071363768, 35.05976361184979], [-83.42766901845603, 35.059718446001504], [-83.42655062248372, 35.06018733386656], [-83.42540831271198, 35.06063518003814]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;0&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400358462&quot;, &quot;__folium_color&quot;: &quot;#dc4d01&quot;, &quot;catchment_area&quot;: 2.93320001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400055396, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 18.7276, &quot;hydroseq&quot;: 25000400060844, &quot;length&quot;: 2.82476951, &quot;name&quot;: &quot;Coweeta Creek&quot;, &quot;new_preorder_index&quot;: 0, &quot;nhdplusid&quot;: 25000400358462, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400064695}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43243331437519, 35.05538681214582, -83.42887071363768, 35.05976361184979], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43243331437519, 35.05538681214582], [-83.43168276994676, 35.05626346059772], [-83.43085165788055, 35.057127139193604], [-83.43067305334118, 35.05819188135598], [-83.42964880548386, 35.0588780317167], [-83.42887071363768, 35.05976361184979]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;1&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400528468&quot;, &quot;__folium_color&quot;: &quot;#3a2efe&quot;, &quot;catchment_area&quot;: 0.28919999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400060844, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 7.3074, &quot;hydroseq&quot;: 25000400079665, &quot;length&quot;: 0.61879195, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 1, &quot;nhdplusid&quot;: 25000400528468, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400098811}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43243331437519, 35.04767261202763, -83.43002583737865, 35.05538681214582], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43037331393532, 35.04767261202763], [-83.4305183310176, 35.04871237244246], [-83.43057741461877, 35.04974461065494], [-83.43002583737865, 35.05069706139114], [-83.4301157757786, 35.05172337092445], [-83.43042236881188, 35.05273727642515], [-83.43117261961554, 35.05359143044462], [-83.43199504119191, 35.054407525615375], [-83.43243331437519, 35.05538681214582]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;2&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400488802&quot;, &quot;__folium_color&quot;: &quot;#0d75f8&quot;, &quot;catchment_area&quot;: 0.6488, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400079665, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.6488, &quot;hydroseq&quot;: 25000400181333, &quot;length&quot;: 0.9449289300000001, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 2, &quot;nhdplusid&quot;: 25000400488802, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43474011436295, 35.053870011847884, -83.43243331437519, 35.05538681214582], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43474011436295, 35.053870011847884], [-83.43399835160893, 35.05442676263795], [-83.43313947174254, 35.054857901406], [-83.43243331437519, 35.05538681214582]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;3&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400456886&quot;, &quot;__folium_color&quot;: &quot;#0203e2&quot;, &quot;catchment_area&quot;: 0.12059999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400079665, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 6.36940001, &quot;hydroseq&quot;: 25000400098811, &quot;length&quot;: 0.27669397, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 3, &quot;nhdplusid&quot;: 25000400456886, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400129735}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45039378100823, 35.04417447904634, -83.43474011436295, 35.053870011847884], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45039378100823, 35.04417447904634], [-83.44910526216933, 35.044398146551], [-83.44786121313295, 35.04473202888563], [-83.44676819549414, 35.04524519159467], [-83.44546415214595, 35.04529854962075], [-83.4442051598758, 35.04568603823972], [-83.442857865, 35.045653061763744], [-83.4418494382267, 35.04629443964235], [-83.44064824723216, 35.04677789273343], [-83.43976659499262, 35.04760514373535], [-83.43880692170306, 35.04832329236605], [-83.43801289750839, 35.04915257796159], [-83.43738962467408, 35.050103243644585], [-83.43667084225784, 35.05102384544573], [-83.43595039498558, 35.0519246249221], [-83.43526013161703, 35.05286323536478], [-83.43474011436295, 35.053870011847884]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;4&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400431661&quot;, &quot;__folium_color&quot;: &quot;#ff474c&quot;, &quot;catchment_area&quot;: 2.11090002, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400098811, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 3.93380001, &quot;hydroseq&quot;: 25000400129735, &quot;length&quot;: 1.9703628199999998, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 4, &quot;nhdplusid&quot;: 25000400431661, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400194442}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45165241607745, 35.0370720793672, -83.45039378100823, 35.04417447904634], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45152458118619, 35.0370720793672], [-83.45160510136346, 35.0381052278396], [-83.45165241607745, 35.0391419742132], [-83.45157375005482, 35.04016729063506], [-83.45143538640492, 35.04119577774985], [-83.45110890564835, 35.042199972358645], [-83.45080736789167, 35.04321231138019], [-83.45039378100823, 35.04417447904634]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;5&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400383591&quot;, &quot;__folium_color&quot;: &quot;#2cfa1f&quot;, &quot;catchment_area&quot;: 0.5893999900000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400129735, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.5893999900000001, &quot;hydroseq&quot;: 25000400227570, &quot;length&quot;: 0.8189864000000001, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 5, &quot;nhdplusid&quot;: 25000400383591, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46066098122498, 35.03353921194884, -83.45039378100823, 35.04417447904634], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46066098122498, 35.03353921194884], [-83.45988323595094, 35.034382314705816], [-83.45951759113134, 35.03538951403691], [-83.45933240670648, 35.036430045033185], [-83.45916156520705, 35.03747216055336], [-83.45883079777394, 35.038483442088484], [-83.45811414292898, 35.03935732074045], [-83.45753991511347, 35.040298930535236], [-83.45676425136008, 35.04110819930516], [-83.45602389636315, 35.04196819533865], [-83.4551838066373, 35.04277036102721], [-83.45403387804448, 35.04321612118961], [-83.45277306005606, 35.0433966847218], [-83.4516174440566, 35.043873018075395], [-83.45039378100823, 35.04417447904634]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;6&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400458981&quot;, &quot;__folium_color&quot;: &quot;#fb5581&quot;, &quot;catchment_area&quot;: 1.2335, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400129735, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 1.2335, &quot;hydroseq&quot;: 25000400194442, &quot;length&quot;: 1.65506017, &quot;name&quot;: &quot;Ball Creek&quot;, &quot;new_preorder_index&quot;: 6, &quot;nhdplusid&quot;: 25000400458981, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46680271431347, 35.03374081189603, -83.43474011436295, 35.053870011847884], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46680271431347, 35.03374081189603], [-83.4662883192456, 35.03475663248732], [-83.46587636281235, 35.035801272478544], [-83.4652514608147, 35.036767957652835], [-83.46466167742048, 35.03775429256362], [-83.46403723116215, 35.03872412764181], [-83.46342037951091, 35.039704233184196], [-83.46266828947104, 35.04061710582679], [-83.46188992242965, 35.04151583730387], [-83.46135867118637, 35.0425270885565], [-83.46057691938736, 35.04341971034302], [-83.45964536625638, 35.04421980307905], [-83.4586960671707, 35.045003605124144], [-83.45773442912967, 35.04578001784668], [-83.45673099350937, 35.04650388457957], [-83.45562538321269, 35.047120538070224], [-83.45434095058448, 35.04735318083243], [-83.45300863437187, 35.047555369741204], [-83.45168171327914, 35.04777560569995], [-83.45037973370643, 35.047481493020854], [-83.4490383641375, 35.04743462622139], [-83.44788581173427, 35.04797695602391], [-83.44684949341595, 35.04868531294463], [-83.4458119003575, 35.049376337525615], [-83.44523229709512, 35.05036375224777], [-83.44417756640976, 35.05102003696356], [-83.44297042895258, 35.05150590219716], [-83.44180978445188, 35.05206028561735], [-83.44086673516891, 35.05283491433253], [-83.43979459240954, 35.05348574720113], [-83.4384609913117, 35.053513254904026], [-83.43720493705803, 35.053179870311794], [-83.43596094253225, 35.053527197921], [-83.43474011436295, 35.053870011847884]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;7&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400492703&quot;, &quot;__folium_color&quot;: &quot;#fff917&quot;, &quot;catchment_area&quot;: 2.31500001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400098811, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 2.31500001, &quot;hydroseq&quot;: 25000400179591, &quot;length&quot;: 4.06871425, &quot;name&quot;: &quot;Henson Creek&quot;, &quot;new_preorder_index&quot;: 7, &quot;nhdplusid&quot;: 25000400492703, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.43926918107363, 35.05976361184979, -83.42887071363768, 35.063420212304074], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.43926918107363, 35.063420212304074], [-83.43798054389904, 35.06337107850854], [-83.43673335418704, 35.06307763416519], [-83.43548202911117, 35.06274436882747], [-83.43452446269339, 35.06208433205509], [-83.43373008544259, 35.06125004999114], [-83.43254274888355, 35.060864887531956], [-83.4312919723345, 35.060539166362815], [-83.43006144572952, 35.06017460868235], [-83.42887071363768, 35.05976361184979]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;8&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400461115&quot;, &quot;__folium_color&quot;: &quot;#2fef10&quot;, &quot;catchment_area&quot;: 0.9560000000000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400060844, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 8.486999990000001, &quot;hydroseq&quot;: 25000400064695, &quot;length&quot;: 1.0921758000000001, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 8, &quot;nhdplusid&quot;: 25000400461115, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400070770}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44262238092514, 35.06102981171405, -83.43926918107363, 35.063420212304074], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44262238092514, 35.06102981171405], [-83.44166211548536, 35.061491736814084], [-83.44083788506501, 35.06213435253925], [-83.44016944125435, 35.0628985031137], [-83.43926918107363, 35.063420212304074]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;9&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400509565&quot;, &quot;__folium_color&quot;: &quot;#c9b003&quot;, &quot;catchment_area&quot;: 0.1507, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400064695, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 6.77050001, &quot;hydroseq&quot;: 25000400070770, &quot;length&quot;: 0.42071594, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 9, &quot;nhdplusid&quot;: 25000400509565, &quot;stream_order&quot;: 3, &quot;uphydroseq&quot;: 25000400082835}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44867491400089, 35.056622479150626, -83.44262238092514, 35.06102981171405], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44867491400089, 35.056622479150626], [-83.44757506311547, 35.05701050053242], [-83.44662009520161, 35.05759811858972], [-83.44551397898395, 35.05800099605968], [-83.4447257827777, 35.05868942095154], [-83.443914310474, 35.05939947871884], [-83.44321294308067, 35.06017212559566], [-83.44262238092514, 35.06102981171405]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;10&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400397871&quot;, &quot;__folium_color&quot;: &quot;#3e82fc&quot;, &quot;catchment_area&quot;: 0.40089999000000004, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400070770, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 1.7986, &quot;hydroseq&quot;: 25000400134610, &quot;length&quot;: 0.77518619, &quot;name&quot;: &quot;Cunningham Creek&quot;, &quot;new_preorder_index&quot;: 10, &quot;nhdplusid&quot;: 25000400397871, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400210321}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45804278114228, 35.04877607873832, -83.44852286690562, 35.056622479150626], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45804278114228, 35.04877607873832], [-83.45692895699617, 35.04940317074009], [-83.45558877624346, 35.049367151091374], [-83.45435393905191, 35.049671682650214], [-83.45349398472788, 35.05052851236086], [-83.45242859621331, 35.0512185910803], [-83.45137155020346, 35.05191351652877], [-83.45037891664579, 35.05266586624019], [-83.44951454641682, 35.05351908144669], [-83.44891942513424, 35.05450423949277], [-83.44852286690562, 35.05553737147826], [-83.44867491400089, 35.056622479150626]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;11&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400423293&quot;, &quot;__folium_color&quot;: &quot;#0485d1&quot;, &quot;catchment_area&quot;: 1.0071000200000002, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400134610, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 1.0071000200000002, &quot;hydroseq&quot;: 25000400210321, &quot;length&quot;: 1.36168448, &quot;name&quot;: &quot;Cunningham Creek&quot;, &quot;new_preorder_index&quot;: 11, &quot;nhdplusid&quot;: 25000400423293, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45789878120223, 35.055164012226946, -83.44867491400089, 35.056622479150626], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45789878120223, 35.055164012226946], [-83.45669962571442, 35.0556696949646], [-83.45534510832658, 35.05565870500275], [-83.45398160003192, 35.05560699840018], [-83.45266048145439, 35.05587808557732], [-83.45132339989723, 35.056131546126686], [-83.44997524314425, 35.056313348928164], [-83.44867491400089, 35.056622479150626]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;12&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400328912&quot;, &quot;__folium_color&quot;: &quot;#5d06e9&quot;, &quot;catchment_area&quot;: 0.39059999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400134610, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.39059999, &quot;hydroseq&quot;: 25000400251500, &quot;length&quot;: 0.87135947, &quot;name&quot;: &quot;Mill Branch&quot;, &quot;new_preorder_index&quot;: 12, &quot;nhdplusid&quot;: 25000400328912, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.44438518093979, 35.06100601201107, -83.44262238092514, 35.06116074344642], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44438518093979, 35.06100601201107], [-83.44351394395008, 35.06116074344642], [-83.44262238092514, 35.06102981171405]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;13&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400463186&quot;, &quot;__folium_color&quot;: &quot;#b1ff65&quot;, &quot;catchment_area&quot;: 0.0438, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400070770, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 4.82120001, &quot;hydroseq&quot;: 25000400082835, &quot;length&quot;: 0.16512304, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 13, &quot;nhdplusid&quot;: 25000400463186, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400100976}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45451978083744, 35.05964733776366, -83.44438518093979, 35.06100601201107], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45451978083744, 35.060282212279446], [-83.45348612007625, 35.05964733776366], [-83.45215108368807, 35.05982353634633], [-83.45089839622071, 35.060191395058126], [-83.4496510249602, 35.06057312182887], [-83.4483616905926, 35.060522733616146], [-83.44703172458617, 35.0607288690052], [-83.44567684809746, 35.0607823715605], [-83.44438518093979, 35.06100601201107]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;14&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400427412&quot;, &quot;__folium_color&quot;: &quot;#f5054f&quot;, &quot;catchment_area&quot;: 0.5573999900000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400082835, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 3.8699, &quot;hydroseq&quot;: 25000400100976, &quot;length&quot;: 0.9874056400000001, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 14, &quot;nhdplusid&quot;: 25000400427412, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400120017}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.4618169809433, 35.05724501219522, -83.45451978083744, 35.060282212279446], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.4618169809433, 35.05724501219522], [-83.46083255008818, 35.05779960356671], [-83.45991146131607, 35.05841893313723], [-83.4589605441476, 35.059008925844296], [-83.45792647236836, 35.05949983353411], [-83.45681492637013, 35.05987049019941], [-83.45569857740614, 35.060226864603315], [-83.45451978083744, 35.060282212279446]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;15&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400499020&quot;, &quot;__folium_color&quot;: &quot;#1ef876&quot;, &quot;catchment_area&quot;: 0.8426000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400100976, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 2.97730001, &quot;hydroseq&quot;: 25000400120017, &quot;length&quot;: 0.76462107, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 15, &quot;nhdplusid&quot;: 25000400499020, &quot;stream_order&quot;: 2, &quot;uphydroseq&quot;: 25000400211263}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.46611851427396, 35.047702479217435, -83.4618169809433, 35.05724501219522], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.46611851427396, 35.047702479217435], [-83.46573757280696, 35.048695418372326], [-83.46539258952797, 35.04969646602555], [-83.46508973731441, 35.0507102385918], [-83.46471024583485, 35.05170594147684], [-83.46458730897903, 35.052742336416834], [-83.46428858380257, 35.05372432288119], [-83.46374012751444, 35.0546681179782], [-83.46330907100267, 35.05564776931508], [-83.46281387336795, 35.056588200408775], [-83.4618169809433, 35.05724501219522]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;16&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400421101&quot;, &quot;__folium_color&quot;: &quot;#ff7855&quot;, &quot;catchment_area&quot;: 0.9912000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400120017, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.9912000100000001, &quot;hydroseq&quot;: 25000400211263, &quot;length&quot;: 1.17318721, &quot;name&quot;: &quot;Shope Fork&quot;, &quot;new_preorder_index&quot;: 16, &quot;nhdplusid&quot;: 25000400421101, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.473102981185, 35.05724501219522, -83.4618169809433, 35.05792321203031], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.473102981185, 35.05792321203031], [-83.47184982212562, 35.05782846335945], [-83.4706236028737, 35.05758169385297], [-83.4693671193802, 35.05751074385794], [-83.46810067842078, 35.05752223665808], [-83.4668450124077, 35.05761112429118], [-83.46558660484274, 35.05758030988738], [-83.46433626522999, 35.05742965769295], [-83.46306833850791, 35.05739818510477], [-83.4618169809433, 35.05724501219522]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;17&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400334861&quot;, &quot;__folium_color&quot;: &quot;#c2be0e&quot;, &quot;catchment_area&quot;: 1.14349999, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400120017, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 1.14349999, &quot;hydroseq&quot;: 25000400248911, &quot;length&quot;: 1.03523974, &quot;name&quot;: &quot;Pinnacle Branch&quot;, &quot;new_preorder_index&quot;: 17, &quot;nhdplusid&quot;: 25000400334861, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45858018119301, 35.060282212279446, -83.45435256569894, 35.06571067921658], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45858018119301, 35.06571067921658], [-83.4576832917144, 35.06503236545547], [-83.45672989777833, 35.06439528122765], [-83.45565235877855, 35.06390419359815], [-83.45479675481204, 35.0631997329961], [-83.45435256569894, 35.062269259814926], [-83.4544685844467, 35.0612755813969], [-83.45451978083744, 35.060282212279446]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;18&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400492705&quot;, &quot;__folium_color&quot;: &quot;#bff128&quot;, &quot;catchment_area&quot;: 0.3352, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400100976, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.3352, &quot;hydroseq&quot;: 25000400179589, &quot;length&quot;: 0.78662657, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 18, &quot;nhdplusid&quot;: 25000400492705, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.45417971370517, 35.06100601201107, -83.44438518093979, 35.06842641175791], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.45417971370517, 35.06842641175791], [-83.45294429418834, 35.068271868170655], [-83.45197344785964, 35.0675953245524], [-83.45079763909668, 35.06721303953475], [-83.44983003654431, 35.06658415130053], [-83.4489349266752, 35.06583851599148], [-83.44785767310846, 35.06526490954429], [-83.44723529616826, 35.06438543324038], [-83.44680947672391, 35.06342645494455], [-83.4461055155837, 35.06255525403276], [-83.445204284586, 35.06181070660046], [-83.44438518093979, 35.06100601201107]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;19&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400385380&quot;, &quot;__folium_color&quot;: &quot;#9dc100&quot;, &quot;catchment_area&quot;: 0.9075000100000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400082835, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.9075000100000001, &quot;hydroseq&quot;: 25000400226762, &quot;length&quot;: 1.2907057499999999, &quot;name&quot;: &quot;Camprock Branch&quot;, &quot;new_preorder_index&quot;: 19, &quot;nhdplusid&quot;: 25000400385380, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}, {&quot;bbox&quot;: [-83.4432805203729, 35.063420212304074, -83.43926918107363, 35.07145587901515], &quot;geometry&quot;: {&quot;coordinates&quot;: [[-83.44320798098076, 35.07145587901515], [-83.44315522199518, 35.070436731404776], [-83.4430444718058, 35.069420285803226], [-83.4432805203729, 35.06841037162515], [-83.44310390971523, 35.06741625141769], [-83.44261343291714, 35.066469513596466], [-83.4417917261047, 35.06568642697804], [-83.44096658859864, 35.06489897165893], [-83.44029838153125, 35.06403314819739], [-83.43926918107363, 35.063420212304074]], &quot;type&quot;: &quot;LineString&quot;}, &quot;id&quot;: &quot;20&quot;, &quot;properties&quot;: {&quot;ID&quot;: &quot;25000400423603&quot;, &quot;__folium_color&quot;: &quot;#ad03de&quot;, &quot;catchment_area&quot;: 0.7604999800000001, &quot;divergence&quot;: 0, &quot;dnhydroseq&quot;: 25000400064695, &quot;do-not-merge&quot;: 0, &quot;drainage_area_sqkm&quot;: 0.7604999800000001, &quot;hydroseq&quot;: 25000400210191, &quot;length&quot;: 1.04463018, &quot;name&quot;: null, &quot;new_preorder_index&quot;: 20, &quot;nhdplusid&quot;: 25000400423603, &quot;stream_order&quot;: 1, &quot;uphydroseq&quot;: 0}, &quot;type&quot;: &quot;Feature&quot;}], &quot;type&quot;: &quot;FeatureCollection&quot;});

        
    
    geo_json_e326ffca67b4f9eaae03da233afeace9.bindPopup(
    function(layer){
    let div = L.DomUtil.create(&#x27;div&#x27;);
    
    let handleObject = feature =&gt; {
        if (feature === null) {
            return &#x27;&#x27;;
        } else if (typeof(feature)==&#x27;object&#x27;) {
            return JSON.stringify(feature);
        } else {
            return feature;
        }
    }
    let fields = [&quot;ID&quot;, &quot;name&quot;, &quot;stream_order&quot;, &quot;divergence&quot;, &quot;hydroseq&quot;, &quot;dnhydroseq&quot;, &quot;uphydroseq&quot;, &quot;length&quot;, &quot;catchment_area&quot;];
    let aliases = [&quot;ID&quot;, &quot;name&quot;, &quot;stream_order&quot;, &quot;divergence&quot;, &quot;hydroseq&quot;, &quot;dnhydroseq&quot;, &quot;uphydroseq&quot;, &quot;length&quot;, &quot;catchment_area&quot;];
    let table = &#x27;&lt;table&gt;&#x27; +
        String(
        fields.map(
        (v,i)=&gt;
        `&lt;tr&gt;
            &lt;th&gt;${aliases[i].toLocaleString()}&lt;/th&gt;
            
            &lt;td&gt;${handleObject(layer.feature.properties[v]).toLocaleString()}&lt;/td&gt;
        &lt;/tr&gt;`).join(&#x27;&#x27;))
    +&#x27;&lt;/table&gt;&#x27;;
    div.innerHTML=table;
    
    return div
    }
    ,{
  &quot;className&quot;: &quot;foliumpopup&quot;,
});
                     
    
            geo_json_e326ffca67b4f9eaae03da233afeace9.addTo(map_f692b53c90bdb78aae5d189c6aa914a5);
        
    
            var layer_control_6fc570ae4f72e70dca26d1669d49662e_layers = {
                base_layers : {
                    &quot;openstreetmap&quot; : tile_layer_c6ae7c72e84be2e9f572419c29ff14dc,
                },
                overlays :  {
                    &quot;watersheds&quot; : geo_json_0465dbf9808d845d75e1e5952452a03d,
                    &quot;Coweeta Creek raw&quot; : geo_json_59c10e85b0fdcf8f6c77b62af36c96b4,
                    &quot;Coweeta Creek&quot; : geo_json_e326ffca67b4f9eaae03da233afeace9,
                },
            };
            let layer_control_6fc570ae4f72e70dca26d1669d49662e = L.control.layers(
                layer_control_6fc570ae4f72e70dca26d1669d49662e_layers.base_layers,
                layer_control_6fc570ae4f72e70dca26d1669d49662e_layers.overlays,
                {
  &quot;position&quot;: &quot;topright&quot;,
  &quot;collapsed&quot;: true,
  &quot;autoZIndex&quot;: true,
}
            ).addTo(map_f692b53c90bdb78aae5d189c6aa914a5);

        
    
            L.control.fullscreen(
                {
  &quot;position&quot;: &quot;topleft&quot;,
  &quot;title&quot;: &quot;Full Screen&quot;,
  &quot;titleCancel&quot;: &quot;Exit Full Screen&quot;,
  &quot;forceSeparateButton&quot;: false,
}
            ).addTo(map_f692b53c90bdb78aae5d189c6aa914a5);
        
    
            var measure_control_6a78655a0f22a1410e0b3bc09ab1dbc2 = new L.Control.Measure(
                {
  &quot;position&quot;: &quot;topright&quot;,
  &quot;primaryLengthUnit&quot;: &quot;meters&quot;,
  &quot;secondaryLengthUnit&quot;: &quot;miles&quot;,
  &quot;primaryAreaUnit&quot;: &quot;sqmeters&quot;,
  &quot;secondaryAreaUnit&quot;: &quot;acres&quot;,
});
            map_f692b53c90bdb78aae5d189c6aa914a5.addControl(measure_control_6a78655a0f22a1410e0b3bc09ab1dbc2);

            // Workaround for using this plugin with Leaflet&gt;=1.8.0
            // https://github.com/ljagis/leaflet-measure/issues/171
            L.Control.Measure.include({
                _setCaptureMarkerIcon: function () {
                    // disable autopan
                    this._captureMarker.options.autoPanOnFocus = false;
                    // default function
                    this._captureMarker.setIcon(
                        L.divIcon({
                            iconSize: this._map.getSize().multiplyBy(2)
                        })
                    );
                },
            });

        
&lt;/script&gt;
&lt;/html&gt;" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div></div></div>
</div>
</section>
<section id="mesh-geometry">
<h3>Mesh Geometry<a class="headerlink" href="#mesh-geometry" title="Link to this heading">#</a></h3>
<p>Discretely create the stream-aligned mesh.  Download elevation data, and condition the mesh discretely to make for better topography.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Refine triangles if they get too acute</span>
<span class="n">min_angle</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># degrees</span>

<span class="c1"># width of reach by stream order (order:width)</span>
<span class="n">widths</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">})</span>

<span class="c1"># create the mesh</span>
<span class="n">m2</span><span class="p">,</span> <span class="n">areas</span><span class="p">,</span> <span class="n">dists</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">tessalateRiverAligned</span><span class="p">(</span><span class="n">watershed</span><span class="p">,</span> <span class="n">rivers</span><span class="p">,</span> 
                                                            <span class="n">river_width</span><span class="o">=</span><span class="n">widths</span><span class="p">,</span>
                                                            <span class="n">refine_min_angle</span><span class="o">=</span><span class="n">min_angle</span><span class="p">,</span>
                                                            <span class="n">refine_distance</span><span class="o">=</span><span class="p">[</span><span class="n">refine_d0</span><span class="p">,</span> <span class="n">refine_A0</span><span class="p">,</span> <span class="n">refine_d1</span><span class="p">,</span> <span class="n">refine_A1</span><span class="p">],</span>
                                                            <span class="n">diagnostics</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:33,945 - root - INFO: 
2025-08-29 17:27:33,946 - root - INFO: Stream-aligned Meshing
2025-08-29 17:27:33,946 - root - INFO: ------------------------------
2025-08-29 17:27:33,946 - root - INFO: Creating stream-aligned mesh...
2025-08-29 17:27:33,965 - root - INFO: Adjusting HUC to match reaches at outlet
2025-08-29 17:27:33,973 - root - INFO: 
2025-08-29 17:27:33,974 - root - INFO: Triangulation
2025-08-29 17:27:33,974 - root - INFO: ------------------------------
2025-08-29 17:27:33,978 - root - INFO: Triangulating...
2025-08-29 17:27:33,979 - root - INFO:    455 points and 456 facets
2025-08-29 17:27:33,979 - root - INFO:  checking graph consistency
2025-08-29 17:27:33,979 - root - INFO:  tolerance is set to 1.0
2025-08-29 17:27:33,981 - root - INFO:  building graph data structures
2025-08-29 17:27:33,982 - root - INFO:  triangle.build...
2025-08-29 17:27:34,114 - root - INFO:   ...built: 1475 mesh points and 2493 triangles
2025-08-29 17:27:34,115 - root - INFO: Plotting triangulation diagnostics
2025-08-29 17:27:34,162 - root - INFO:   min area = 2656.7518310546875
2025-08-29 17:27:34,162 - root - INFO:   max area = 41455.08837890625
</pre></div>
</div>
<img alt="../_images/3b9a98ed0080bb66aa66cbf8f8e3640281e538f3e3175535c32d1eed0f352dc0.png" src="../_images/3b9a98ed0080bb66aa66cbf8f8e3640281e538f3e3175535c32d1eed0f352dc0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get a raster for the elevation map, based on 3DEP</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;DEM&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getDataset</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">)[</span><span class="s1">&#39;dem&#39;</span><span class="p">]</span>

<span class="c1"># provide surface mesh elevations</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">elevate</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">dem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:34,313 - root - INFO: Incoming shape area = 0.0017688403168597767
2025-08-29 17:27:34,313 - root - INFO: ... buffering incoming shape by = 0.00108
2025-08-29 17:27:34,314 - root - INFO: ... buffered shape area = 0.001956767422135052
2025-08-29 17:27:34,314 - root - INFO: Getting DEM with map of area = 0.001956767422135052
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the DEM raster</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># Plot the DEM data</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">dem</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;terrain&#39;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Elevation (m)&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">270</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Add title and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Digital Elevation Model (DEM)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X Coordinate&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y Coordinate&#39;</span><span class="p">)</span>

<span class="c1"># Set equal aspect ratio</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5bbf8db5dd3fa01aa9f20334e5108bddf6d0a58d5194f43466a819297933ecdb.png" src="../_images/5bbf8db5dd3fa01aa9f20334e5108bddf6d0a58d5194f43466a819297933ecdb.png" />
</div>
</div>
<p>In the pit-filling algorithm, we want to make sure that river corridor is not filled up. Hence we exclude river corridor cells from the pit-filling algorithm.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hydrologically condition the mesh, removing pits</span>
<span class="n">river_mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">conn</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">conn</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">river_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>     
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">fillPitsDual</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">is_waterbody</span><span class="o">=</span><span class="n">river_mask</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are a range of options to condition river corridor mesh. We hydrologically condition the river mesh, ensuring unimpeded water flow in river corridors by globally adjusting flowlines to rectify artificial obstructions from inconsistent DEM elevations or misalignments. Please read the documentation for more information</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># conditioning river mesh</span>
<span class="c1">#</span>
<span class="c1"># adding elevations to the river tree for stream bed conditioning</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">setProfileByDEM</span><span class="p">(</span><span class="n">rivers</span><span class="p">,</span> <span class="n">dem</span><span class="p">)</span>

<span class="c1"># conditioning the river mesh using NHD elevations</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">condition</span><span class="o">.</span><span class="n">conditionRiverMesh</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">rivers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotting surface mesh with elevations</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>
<span class="n">cbax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">0.04</span><span class="p">])</span>

<span class="n">mp</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mp</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;surface mesh with elevations&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>

<span class="n">mp2</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span> <span class="s1">&#39;datalim&#39;</span><span class="p">)</span>

<span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.1322e6</span><span class="p">,</span> <span class="mf">1.1328e6</span><span class="p">)</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.4085e6</span><span class="p">,</span> <span class="mf">1.4088e6</span><span class="p">)</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">indicate_inset_zoom</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

<span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;elevation [m]&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:50,483 - matplotlib.axes._base - WARNING: Ignoring fixed y limits to fulfill fixed data aspect with adjustable data limits.
</pre></div>
</div>
<img alt="../_images/22b77dc737603cee1966f75ddcde0710133064de31e01aa0e997c5124a83fbfe.png" src="../_images/22b77dc737603cee1966f75ddcde0710133064de31e01aa0e997c5124a83fbfe.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add labeled sets for subcatchments and outlets</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">regions</span><span class="o">.</span><span class="n">addWatershedAndOutletRegions</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">watershed</span><span class="p">,</span> <span class="n">outlet_width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">exterior_outlet</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># add labeled sets for river corridor cells</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">regions</span><span class="o">.</span><span class="n">addRiverCorridorRegions</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>

<span class="c1"># add labeled sets for river corridor cells by order</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">regions</span><span class="o">.</span><span class="n">addStreamOrderRegions</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">rivers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:50,586 - root - INFO: Adding regions for 1 polygons
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m2</span><span class="o">.</span><span class="n">labeled_sets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">ent_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> : &quot;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10000 : CELL : 2683 : &quot;0&quot;
10001 : CELL : 2683 : &quot;0 surface&quot;
10002 : FACE : 76 : &quot;0 boundary&quot;
10003 : FACE : 5 : &quot;0 outlet&quot;
10004 : FACE : 5 : &quot;surface domain outlet&quot;
10005 : CELL : 190 : &quot;river corridor 0 surface&quot;
10006 : CELL : 16 : &quot;stream order 3&quot;
10007 : CELL : 48 : &quot;stream order 2&quot;
10008 : CELL : 126 : &quot;stream order 1&quot;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="surface-properties">
<h2>Surface properties<a class="headerlink" href="#surface-properties" title="Link to this heading">#</a></h2>
<p>Meshes interact with data to provide forcing, parameters, and more in the actual simulation.  Specifically, we need vegetation type on the surface to provide information about transpiration and subsurface structure to provide information about water retention curves, etc.</p>
<section id="nlcd-for-lulc">
<h3>NLCD for LULC<a class="headerlink" href="#nlcd-for-lulc" title="Link to this heading">#</a></h3>
<p>We’ll start by downloading and collecting land cover from the NLCD dataset, and generate sets for each land cover type that cover the surface.  Likely these will be some combination of grass, deciduous forest, coniferous forest, and mixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download the NLCD raster</span>
<span class="n">nlcd</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;land cover&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getDataset</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">)[</span><span class="s1">&#39;cover&#39;</span><span class="p">]</span>

<span class="c1"># what land cover types did we get?</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Found land cover dtypes: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nlcd</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Found land cover types: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">nlcd</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">ravel</span><span class="p">()))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:50,657 - root - INFO: Incoming shape area = 0.0017688403168597767
2025-08-29 17:27:50,657 - root - INFO: ... buffering incoming shape by = 0.00027
2025-08-29 17:27:50,657 - root - INFO: ... buffered shape area = 0.0018151848254589866
2025-08-29 17:27:50,700 - root - INFO: Found land cover dtypes: uint8
2025-08-29 17:27:50,701 - root - INFO: Found land cover types: {np.uint8(71), np.uint8(41), np.uint8(42), np.uint8(43), np.uint8(81), np.uint8(52), np.uint8(21), np.uint8(22), np.uint8(23), np.uint8(127)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a colormap for the data</span>
<span class="n">nlcd_indices</span><span class="p">,</span> <span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">nlcd_norm</span><span class="p">,</span> <span class="n">nlcd_ticks</span><span class="p">,</span> <span class="n">nlcd_labels</span> <span class="o">=</span> \
      <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createNLCDColormap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">nlcd</span><span class="p">))</span>
<span class="n">nlcd_cmap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>making colormap with: [np.uint8(21), np.uint8(22), np.uint8(23), np.uint8(41), np.uint8(42), np.uint8(43), np.uint8(52), np.uint8(71), np.uint8(81), np.uint8(127)]
making colormap with colors: [(0.86666666667, 0.78823529412, 0.78823529412), (0.84705882353, 0.57647058824, 0.50980392157), (0.92941176471, 0.0, 0.0), (0.40784313726, 0.66666666667, 0.38823529412), (0.10980392157, 0.38823529412, 0.18823529412), (0.70980392157, 0.78823529412, 0.5568627451), (0.8, 0.72941176471, 0.4862745098), (0.8862745098, 0.8862745098, 0.7568627451), (0.85882352941, 0.84705882353, 0.23921568628), (1.0, 1.0, 1.0)]
</pre></div>
</div>
<div class="output text_html"><div style="vertical-align: middle;"><strong>from_list</strong> </div><div class="cmap"><img alt="from_list colormap" title="from_list" style="border: 1px solid #555;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAABACAYAAABsv8+/AAAAGHRFWHRUaXRsZQBmcm9tX2xpc3QgY29sb3JtYXBDL89FAAAAHnRFWHREZXNjcmlwdGlvbgBmcm9tX2xpc3QgY29sb3JtYXABtCnOAAAAMXRFWHRBdXRob3IATWF0cGxvdGxpYiB2My4xMC4zLCBodHRwczovL21hdHBsb3RsaWIub3Jnhnp4VQAAADN0RVh0U29mdHdhcmUATWF0cGxvdGxpYiB2My4xMC4zLCBodHRwczovL21hdHBsb3RsaWIub3JnI15roQAAAXtJREFUeJzt1rFJA2AYAFF1h+AEkk0cI41g5wSKe2QF6zRp7SI4giNYWIlY6BI/fuC9N8GVd/52Ov2c/SPfL8fphGU2d4/TCcvcP91MJyxzOL5OJyyzv91NJyxz+fE+nbDMZns9nbDM1+fDdMIyV9vn6YSlLqYDAIC/ZwAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABBkAAAgyAAAQZAAAIMgAAECQAQCAIAMAAEEGAACCDAAABP0CV+0SfEFTtMYAAAAASUVORK5CYII="></div><div style="vertical-align: middle; max-width: 514px; display: flex; justify-content: space-between;"><div style="float: left;"><div title="#ddc9c9ff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #ddc9c9ff;"></div> under</div><div style="margin: 0 auto; display: inline-block;">bad <div title="#00000000" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #00000000;"></div></div><div style="float: right;">over <div title="#ffffffff" style="display: inline-block; width: 1em; height: 1em; margin: 0; vertical-align: middle; border: 1px solid #555; background-color: #ffffffff;"></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nlcd</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">nlcd_norm</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createIndexedColorbar</span><span class="p">(</span><span class="n">ncolors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">nlcd_indices</span><span class="p">),</span> 
                               <span class="n">cmap</span><span class="o">=</span><span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">nlcd_labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Land Cover&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/afca6b146cbf3fe23837e74e09c7e2353978b0989ab0e72f78f4e632ad518f00.png" src="../_images/afca6b146cbf3fe23837e74e09c7e2353978b0989ab0e72f78f4e632ad518f00.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># map nlcd onto the mesh</span>
<span class="n">m2_nlcd</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">getDatasetOnMesh</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">nlcd</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;land_cover&#39;</span><span class="p">:</span> <span class="n">m2_nlcd</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># double-check that nan not in the values</span>
<span class="k">assert</span> <span class="mi">127</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">m2_nlcd</span>

<span class="c1"># create a new set of labels and indices with only those that actually appear on the mesh</span>
<span class="n">nlcd_indices</span><span class="p">,</span> <span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">nlcd_norm</span><span class="p">,</span> <span class="n">nlcd_ticks</span><span class="p">,</span> <span class="n">nlcd_labels</span> <span class="o">=</span> \
      <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createNLCDColormap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">m2_nlcd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>making colormap with: [np.uint8(21), np.uint8(22), np.uint8(23), np.uint8(41), np.uint8(42), np.uint8(43), np.uint8(81)]
making colormap with colors: [(0.86666666667, 0.78823529412, 0.78823529412), (0.84705882353, 0.57647058824, 0.50980392157), (0.92941176471, 0.0, 0.0), (0.40784313726, 0.66666666667, 0.38823529412), (0.10980392157, 0.38823529412, 0.18823529412), (0.70980392157, 0.78823529412, 0.5568627451), (0.85882352941, 0.84705882353, 0.23921568628)]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mp</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolors</span><span class="o">=</span><span class="n">m2_nlcd</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">nlcd_norm</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createIndexedColorbar</span><span class="p">(</span><span class="n">ncolors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">nlcd_indices</span><span class="p">),</span> 
                               <span class="n">cmap</span><span class="o">=</span><span class="n">nlcd_cmap</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">nlcd_labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4e00b7895af84ceaec5afe21158a0850edeca327dee11cdb8f48062740b19405.png" src="../_images/4e00b7895af84ceaec5afe21158a0850edeca327dee11cdb8f48062740b19405.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add labeled sets to the mesh for NLCD</span>
<span class="n">nlcd_labels_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nlcd_indices</span><span class="p">,</span> <span class="n">nlcd_labels</span><span class="p">))</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">regions</span><span class="o">.</span><span class="n">addSurfaceRegions</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="n">nlcd_labels_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nlcd_labels_dict</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{np.uint8(21): &#39;Developed, Open Space&#39;,
 np.uint8(22): &#39;Developed, Low Intensity&#39;,
 np.uint8(23): &#39;Developed, Medium Intensity&#39;,
 np.uint8(41): &#39;Deciduous Forest&#39;,
 np.uint8(42): &#39;Evergreen Forest&#39;,
 np.uint8(43): &#39;Mixed Forest&#39;,
 np.uint8(81): &#39;Pasture/Hay&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m2</span><span class="o">.</span><span class="n">labeled_sets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">ent_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> : &quot;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10000 : CELL : 2683 : &quot;0&quot;
10001 : CELL : 2683 : &quot;0 surface&quot;
10002 : FACE : 76 : &quot;0 boundary&quot;
10003 : FACE : 5 : &quot;0 outlet&quot;
10004 : FACE : 5 : &quot;surface domain outlet&quot;
10005 : CELL : 190 : &quot;river corridor 0 surface&quot;
10006 : CELL : 16 : &quot;stream order 3&quot;
10007 : CELL : 48 : &quot;stream order 2&quot;
10008 : CELL : 126 : &quot;stream order 1&quot;
21 : CELL : 104 : &quot;Developed, Open Space&quot;
22 : CELL : 5 : &quot;Developed, Low Intensity&quot;
23 : CELL : 1 : &quot;Developed, Medium Intensity&quot;
41 : CELL : 1393 : &quot;Deciduous Forest&quot;
42 : CELL : 43 : &quot;Evergreen Forest&quot;
43 : CELL : 1133 : &quot;Mixed Forest&quot;
81 : CELL : 4 : &quot;Pasture/Hay&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="modis-lai">
<h3>MODIS LAI<a class="headerlink" href="#modis-lai" title="Link to this heading">#</a></h3>
<p>Leaf area index is needed on each land cover type – this is used in the Evapotranspiration calculation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download LAI and corresponding LULC datasets -- these are actually already downloaded, </span>
<span class="c1"># as the MODIS AppEEARS API is quite slow</span>
<span class="c1">#</span>
<span class="c1"># Note that MODIS does NOT work with the noleap calendar, so we have to convert to actual dates first</span>
<span class="n">start_leap</span> <span class="o">=</span> <span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeGregorian</span><span class="p">(</span><span class="n">start</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="n">end_leap</span> <span class="o">=</span> <span class="n">cftime</span><span class="o">.</span><span class="n">DatetimeGregorian</span><span class="p">(</span><span class="n">end</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">end</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;LAI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getDataset</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">start_leap</span><span class="p">,</span> <span class="n">end_leap</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,060 - root - INFO: Incoming shape area = 0.0016040440731829
2025-08-29 17:27:51,061 - root - INFO: ... buffering incoming shape by = 0.0045000000000000005
2025-08-29 17:27:51,061 - root - INFO: ... buffered shape area = 0.0024043957079133795
2025-08-29 17:27:51,062 - root - INFO: Building request for bounds: [np.float64(-83.4825), np.float64(35.0235), np.float64(-83.4176), np.float64(35.0782)]
2025-08-29 17:27:51,062 - root - INFO: ... requires files:
2025-08-29 17:27:51,063 - root - INFO:  ... /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/input_data/land_cover/MODIS/modis_LAI_08-01-2010_08-01-2014_35.0782x-83.4825_35.0235x-83.4176.nc
2025-08-29 17:27:51,063 - root - INFO:  ... /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/input_data/land_cover/MODIS/modis_LULC_08-01-2010_08-01-2014_35.0782x-83.4825_35.0235x-83.4176.nc
2025-08-29 17:27:51,064 - root - INFO: ... files exist locally.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modis_data</span> <span class="o">=</span> <span class="n">res</span>
<span class="k">assert</span> <span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LAI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>EPSG:4269 float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># MODIS data comes with time-dependent LAI AND time-dependent LULC -- just take the mode to find the most common LULC</span>
<span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">computeMode</span><span class="p">(</span><span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">],</span> <span class="s1">&#39;time_LULC&#39;</span><span class="p">)</span>

<span class="c1"># now it is safe to have only one time</span>
<span class="n">modis_data</span> <span class="o">=</span> <span class="n">modis_data</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;time_LAI&#39;</span><span class="p">:</span><span class="s1">&#39;time&#39;</span><span class="p">})</span>

<span class="c1"># remove leap day (366th day of any leap year) to match our Noleap Calendar</span>
<span class="n">modis_data</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">filterLeapDay</span><span class="p">(</span><span class="n">modis_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the MODIS data -- note the entire domain is covered with one type for Coweeta (it is small!)</span>
<span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">imshow</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7fad5074a990&gt;
</pre></div>
</div>
<img alt="../_images/7740218b59f26801b818d4009b46e510e8e1a07a3ecaa389c5d47bc45fbc8a27.png" src="../_images/7740218b59f26801b818d4009b46e510e8e1a07a3ecaa389c5d47bc45fbc8a27.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the transient time series</span>
<span class="n">modis_lai</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">computeTimeSeries</span><span class="p">(</span><span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LAI&#39;</span><span class="p">],</span> <span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">],</span> 
                                                                      <span class="n">polygon</span><span class="o">=</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">polygon_crs</span><span class="o">=</span><span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modis_lai</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Deciduous Broadleaf Forests LAI [-]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-08-01 00:00:00</td>
      <td>3.244086</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-08-05 00:00:00</td>
      <td>4.813978</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010-08-09 00:00:00</td>
      <td>3.469892</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010-08-13 00:00:00</td>
      <td>4.234409</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010-08-17 00:00:00</td>
      <td>3.178495</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2014-07-16 00:00:00</td>
      <td>5.615054</td>
    </tr>
    <tr>
      <th>365</th>
      <td>2014-07-20 00:00:00</td>
      <td>4.093548</td>
    </tr>
    <tr>
      <th>366</th>
      <td>2014-07-24 00:00:00</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>367</th>
      <td>2014-07-28 00:00:00</td>
      <td>4.853763</td>
    </tr>
    <tr>
      <th>368</th>
      <td>2014-08-01 00:00:00</td>
      <td>5.529032</td>
    </tr>
  </tbody>
</table>
<p>369 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># smooth the data in time</span>
<span class="n">modis_lai_smoothed</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">smoothTimeSeries</span><span class="p">(</span><span class="n">modis_lai</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="c1"># save the MODIS time series to disk</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;modis_lai_transient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_LAI_MODIS_transient.h5&#39;</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeTimeseriesToHDF5</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;modis_lai_transient&#39;</span><span class="p">],</span> <span class="n">modis_lai_smoothed</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">plotLAI</span><span class="p">(</span><span class="n">modis_lai_smoothed</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="s1">&#39;MODIS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,314 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_LAI_MODIS_transient.h5
</pre></div>
</div>
<img alt="../_images/f2dffd77f1d9b41ee3073c34dc2d201cdb4c64c0a437801561c8bce6e09ffce1.png" src="../_images/f2dffd77f1d9b41ee3073c34dc2d201cdb4c64c0a437801561c8bce6e09ffce1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute a typical year</span>
<span class="n">modis_lai_typical</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">computeAverageYear</span><span class="p">(</span><span class="n">modis_lai_smoothed</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">output_nyears</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> 
                                                                  <span class="n">start_year</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>

<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;modis_lai_cyclic_steadystate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_LAI_MODIS_CyclicSteadystate.h5&#39;</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeTimeseriesToHDF5</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;modis_lai_cyclic_steadystate&#39;</span><span class="p">],</span> <span class="n">modis_lai_typical</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">plotLAI</span><span class="p">(</span><span class="n">modis_lai_typical</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="s1">&#39;MODIS&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,424 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_LAI_MODIS_CyclicSteadystate.h5
</pre></div>
</div>
<img alt="../_images/bdf7d2d554667e410b7396e728552b5c0b8e8bd2052caa8c28dba6201a53a560.png" src="../_images/bdf7d2d554667e410b7396e728552b5c0b8e8bd2052caa8c28dba6201a53a560.png" />
</div>
</div>
</section>
<section id="crosswalk-of-lai-to-nlcd-lc">
<h3>Crosswalk of LAI to NLCD LC<a class="headerlink" href="#crosswalk-of-lai-to-nlcd-lc" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">crosswalk</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">computeCrosswalk</span><span class="p">(</span><span class="n">modis_data</span><span class="p">[</span><span class="s1">&#39;LULC&#39;</span><span class="p">],</span> <span class="n">nlcd</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fractional area&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,523 - root - INFO: Compute the crosswalk between MODIS and NLCD:
2025-08-29 17:27:51,523 - root - INFO:   unique MODIS: [np.float64(4.0)]
2025-08-29 17:27:51,524 - root - INFO:   unique NLCD: [np.uint8(21), np.uint8(22), np.uint8(23), np.uint8(41), np.uint8(42), np.uint8(43), np.uint8(52), np.uint8(71), np.uint8(81)]
</pre></div>
</div>
<img alt="../_images/c39612da5f1666ec413d5bd4b0a00a09e7737cd66caae8626976a483798841b4.png" src="../_images/c39612da5f1666ec413d5bd4b0a00a09e7737cd66caae8626976a483798841b4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the NLCD-based time series</span>
<span class="n">nlcd_lai_cyclic_steadystate</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">applyCrosswalk</span><span class="p">(</span><span class="n">crosswalk</span><span class="p">,</span> <span class="n">modis_lai_typical</span><span class="p">)</span>
<span class="n">nlcd_lai_transient</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">applyCrosswalk</span><span class="p">(</span><span class="n">crosswalk</span><span class="p">,</span> <span class="n">modis_lai_smoothed</span><span class="p">)</span>

<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">removeNullLAI</span><span class="p">(</span><span class="n">nlcd_lai_cyclic_steadystate</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">land_cover_properties</span><span class="o">.</span><span class="n">removeNullLAI</span><span class="p">(</span><span class="n">nlcd_lai_transient</span><span class="p">)</span>
<span class="n">nlcd_lai_transient</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>None LAI [-] False
Open Water LAI [-] False
Perrenial Ice/Snow LAI [-] False
Developed, Medium Intensity LAI [-] True
Developed, High Intensity LAI [-] False
Barren Land LAI [-] False
None LAI [-] False
Open Water LAI [-] False
Perrenial Ice/Snow LAI [-] False
Developed, Medium Intensity LAI [-] True
Developed, High Intensity LAI [-] False
Barren Land LAI [-] False
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>Developed, Open Space LAI [-]</th>
      <th>Developed, Low Intensity LAI [-]</th>
      <th>Developed, Medium Intensity LAI [-]</th>
      <th>Deciduous Forest LAI [-]</th>
      <th>Evergreen Forest LAI [-]</th>
      <th>Mixed Forest LAI [-]</th>
      <th>Shrub/Scrub LAI [-]</th>
      <th>Grassland/Herbaceous LAI [-]</th>
      <th>Pasture/Hay LAI [-]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2010-08-01 00:00:00</td>
      <td>3.427880</td>
      <td>3.427880</td>
      <td>0.0</td>
      <td>3.427880</td>
      <td>3.427880</td>
      <td>3.427880</td>
      <td>3.427880</td>
      <td>3.427880</td>
      <td>3.427880</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2010-08-05 00:00:00</td>
      <td>4.186508</td>
      <td>4.186508</td>
      <td>0.0</td>
      <td>4.186508</td>
      <td>4.186508</td>
      <td>4.186508</td>
      <td>4.186508</td>
      <td>4.186508</td>
      <td>4.186508</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2010-08-09 00:00:00</td>
      <td>4.217460</td>
      <td>4.217460</td>
      <td>0.0</td>
      <td>4.217460</td>
      <td>4.217460</td>
      <td>4.217460</td>
      <td>4.217460</td>
      <td>4.217460</td>
      <td>4.217460</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2010-08-13 00:00:00</td>
      <td>3.842960</td>
      <td>3.842960</td>
      <td>0.0</td>
      <td>3.842960</td>
      <td>3.842960</td>
      <td>3.842960</td>
      <td>3.842960</td>
      <td>3.842960</td>
      <td>3.842960</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2010-08-17 00:00:00</td>
      <td>3.192524</td>
      <td>3.192524</td>
      <td>0.0</td>
      <td>3.192524</td>
      <td>3.192524</td>
      <td>3.192524</td>
      <td>3.192524</td>
      <td>3.192524</td>
      <td>3.192524</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2014-07-16 00:00:00</td>
      <td>3.712084</td>
      <td>3.712084</td>
      <td>0.0</td>
      <td>3.712084</td>
      <td>3.712084</td>
      <td>3.712084</td>
      <td>3.712084</td>
      <td>3.712084</td>
      <td>3.712084</td>
    </tr>
    <tr>
      <th>365</th>
      <td>2014-07-20 00:00:00</td>
      <td>4.249360</td>
      <td>4.249360</td>
      <td>0.0</td>
      <td>4.249360</td>
      <td>4.249360</td>
      <td>4.249360</td>
      <td>4.249360</td>
      <td>4.249360</td>
      <td>4.249360</td>
    </tr>
    <tr>
      <th>366</th>
      <td>2014-07-24 00:00:00</td>
      <td>4.460855</td>
      <td>4.460855</td>
      <td>0.0</td>
      <td>4.460855</td>
      <td>4.460855</td>
      <td>4.460855</td>
      <td>4.460855</td>
      <td>4.460855</td>
      <td>4.460855</td>
    </tr>
    <tr>
      <th>367</th>
      <td>2014-07-28 00:00:00</td>
      <td>4.805709</td>
      <td>4.805709</td>
      <td>0.0</td>
      <td>4.805709</td>
      <td>4.805709</td>
      <td>4.805709</td>
      <td>4.805709</td>
      <td>4.805709</td>
      <td>4.805709</td>
    </tr>
    <tr>
      <th>368</th>
      <td>2014-08-01 00:00:00</td>
      <td>5.453098</td>
      <td>5.453098</td>
      <td>0.0</td>
      <td>5.453098</td>
      <td>5.453098</td>
      <td>5.453098</td>
      <td>5.453098</td>
      <td>5.453098</td>
      <td>5.453098</td>
    </tr>
  </tbody>
</table>
<p>369 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write the NLCD-based time series to disk</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_cyclic_steadystate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_LAI_NLCD_CyclicSteadystate.h5&#39;</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeTimeseriesToHDF5</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_cyclic_steadystate&#39;</span><span class="p">],</span> <span class="n">nlcd_lai_cyclic_steadystate</span><span class="p">)</span>

<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_transient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_LAI_NLCD_</span><span class="si">{</span><span class="n">start</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">end</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">.h5&#39;</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeTimeseriesToHDF5</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_transient&#39;</span><span class="p">],</span> <span class="n">nlcd_lai_transient</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,625 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_LAI_NLCD_CyclicSteadystate.h5
2025-08-29 17:27:51,629 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_LAI_NLCD_2010_2014.h5
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="subsurface-soil-geologic-structure">
<h2>Subsurface Soil, Geologic Structure<a class="headerlink" href="#subsurface-soil-geologic-structure" title="Link to this heading">#</a></h2>
<section id="nrcs-soils">
<h3>NRCS Soils<a class="headerlink" href="#nrcs-soils" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get NRCS shapes, on a reasonable crs</span>
<span class="n">nrcs</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;soil structure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getShapesByGeometry</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">out_crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">nrcs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:51,666 - root - INFO: Attempting to download source for target &#39;/home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/input_data/soil_structure/SSURGO/SSURGO_-83.4780_35.0280_-83.4221_35.0737.shp&#39;
2025-08-29 17:27:51,671 - root - INFO:   Found 456 shapes.
2025-08-29 17:27:51,722 - root - INFO: found 41 unique MUKEYs.
2025-08-29 17:27:52,049 - root - INFO: Running Rosetta for van Genutchen parameters
2025-08-29 17:27:52,086 - root - INFO:   ... done
2025-08-29 17:27:52,087 - root - INFO:   requested 41 values
2025-08-29 17:27:52,087 - root - INFO:   got 41 responses
2025-08-29 17:27:52,092 - root - INFO: fixing column: geometry
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mukey</th>
      <th>geometry</th>
      <th>residual saturation [-]</th>
      <th>Rosetta porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>Rosetta permeability [m^2]</th>
      <th>thickness [m]</th>
      <th>permeability [m^2]</th>
      <th>porosity [-]</th>
      <th>bulk density [g/cm^3]</th>
      <th>total sand pct [%]</th>
      <th>total silt pct [%]</th>
      <th>total clay pct [%]</th>
      <th>source</th>
      <th>ID</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>545800</td>
      <td>MULTIPOLYGON (((1131335.296 1404750.906, 11313...</td>
      <td>0.177165</td>
      <td>0.431041</td>
      <td>0.000139</td>
      <td>1.470755</td>
      <td>8.079687e-13</td>
      <td>2.03</td>
      <td>3.429028e-15</td>
      <td>0.307246</td>
      <td>1.297356</td>
      <td>66.356250</td>
      <td>19.518750</td>
      <td>14.125000</td>
      <td>NRCS</td>
      <td>545800</td>
      <td>NRCS-545800</td>
    </tr>
    <tr>
      <th>1</th>
      <td>545801</td>
      <td>MULTIPOLYGON (((1129506.994 1406944.207, 11294...</td>
      <td>0.177493</td>
      <td>0.432741</td>
      <td>0.000139</td>
      <td>1.469513</td>
      <td>8.184952e-13</td>
      <td>2.03</td>
      <td>3.247236e-15</td>
      <td>0.303714</td>
      <td>1.292308</td>
      <td>66.400000</td>
      <td>19.300000</td>
      <td>14.300000</td>
      <td>NRCS</td>
      <td>545801</td>
      <td>NRCS-545801</td>
    </tr>
    <tr>
      <th>2</th>
      <td>545803</td>
      <td>MULTIPOLYGON (((1130760.995 1408224.107, 11307...</td>
      <td>0.172412</td>
      <td>0.400889</td>
      <td>0.000150</td>
      <td>1.491087</td>
      <td>6.477202e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.379163</td>
      <td>1.400000</td>
      <td>66.799507</td>
      <td>21.700493</td>
      <td>11.500000</td>
      <td>NRCS</td>
      <td>545803</td>
      <td>NRCS-545803</td>
    </tr>
    <tr>
      <th>3</th>
      <td>545805</td>
      <td>MULTIPOLYGON (((1134255.698 1405132.204, 11342...</td>
      <td>0.177122</td>
      <td>0.388687</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>3.412748e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>1.400000</td>
      <td>46.721675</td>
      <td>41.778325</td>
      <td>11.500000</td>
      <td>NRCS</td>
      <td>545805</td>
      <td>NRCS-545805</td>
    </tr>
    <tr>
      <th>4</th>
      <td>545806</td>
      <td>MULTIPOLYGON (((1134180.798 1405169.304, 11341...</td>
      <td>0.177122</td>
      <td>0.388687</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>3.412748e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>1.400000</td>
      <td>46.721675</td>
      <td>41.778325</td>
      <td>11.500000</td>
      <td>NRCS</td>
      <td>545806</td>
      <td>NRCS-545806</td>
    </tr>
    <tr>
      <th>5</th>
      <td>545807</td>
      <td>MULTIPOLYGON (((1131255.496 1405664.406, 11312...</td>
      <td>0.177122</td>
      <td>0.388687</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>3.412748e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>1.400000</td>
      <td>46.721675</td>
      <td>41.778325</td>
      <td>11.500000</td>
      <td>NRCS</td>
      <td>545807</td>
      <td>NRCS-545807</td>
    </tr>
    <tr>
      <th>6</th>
      <td>545811</td>
      <td>MULTIPOLYGON (((1130078.796 1404597.506, 11300...</td>
      <td>0.185628</td>
      <td>0.387114</td>
      <td>0.000166</td>
      <td>1.473045</td>
      <td>4.803887e-13</td>
      <td>2.03</td>
      <td>1.830706e-12</td>
      <td>0.329821</td>
      <td>1.488889</td>
      <td>69.043320</td>
      <td>17.115010</td>
      <td>13.841670</td>
      <td>NRCS</td>
      <td>545811</td>
      <td>NRCS-545811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>545812</td>
      <td>POLYGON ((1130078.496 1404548.906, 1130061.396...</td>
      <td>0.185628</td>
      <td>0.387114</td>
      <td>0.000166</td>
      <td>1.473045</td>
      <td>4.803887e-13</td>
      <td>2.03</td>
      <td>1.830706e-12</td>
      <td>0.329821</td>
      <td>1.488889</td>
      <td>69.043320</td>
      <td>17.115010</td>
      <td>13.841670</td>
      <td>NRCS</td>
      <td>545812</td>
      <td>NRCS-545812</td>
    </tr>
    <tr>
      <th>8</th>
      <td>545813</td>
      <td>MULTIPOLYGON (((1132919.997 1405040.305, 11329...</td>
      <td>0.183468</td>
      <td>0.398767</td>
      <td>0.000127</td>
      <td>1.445858</td>
      <td>4.296896e-13</td>
      <td>2.03</td>
      <td>6.219065e-14</td>
      <td>0.349442</td>
      <td>1.410667</td>
      <td>60.007287</td>
      <td>26.226047</td>
      <td>13.766667</td>
      <td>NRCS</td>
      <td>545813</td>
      <td>NRCS-545813</td>
    </tr>
    <tr>
      <th>9</th>
      <td>545814</td>
      <td>MULTIPOLYGON (((1131226.596 1404721.006, 11312...</td>
      <td>0.183216</td>
      <td>0.399168</td>
      <td>0.000125</td>
      <td>1.445793</td>
      <td>4.285058e-13</td>
      <td>2.03</td>
      <td>6.060887e-14</td>
      <td>0.346424</td>
      <td>1.406875</td>
      <td>59.510029</td>
      <td>26.771221</td>
      <td>13.718750</td>
      <td>NRCS</td>
      <td>545814</td>
      <td>NRCS-545814</td>
    </tr>
    <tr>
      <th>10</th>
      <td>545815</td>
      <td>MULTIPOLYGON (((1131297.396 1404750.606, 11313...</td>
      <td>0.177808</td>
      <td>0.408626</td>
      <td>0.000162</td>
      <td>1.498482</td>
      <td>7.226966e-13</td>
      <td>2.03</td>
      <td>3.794887e-14</td>
      <td>0.319402</td>
      <td>1.396429</td>
      <td>70.272487</td>
      <td>16.465168</td>
      <td>13.262346</td>
      <td>NRCS</td>
      <td>545815</td>
      <td>NRCS-545815</td>
    </tr>
    <tr>
      <th>11</th>
      <td>545817</td>
      <td>MULTIPOLYGON (((1130046.496 1404549.606, 11300...</td>
      <td>0.161194</td>
      <td>0.457152</td>
      <td>0.000168</td>
      <td>1.559659</td>
      <td>1.846434e-12</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.242266</td>
      <td>1.198030</td>
      <td>76.538424</td>
      <td>12.010837</td>
      <td>11.450739</td>
      <td>NRCS</td>
      <td>545817</td>
      <td>NRCS-545817</td>
    </tr>
    <tr>
      <th>12</th>
      <td>545818</td>
      <td>MULTIPOLYGON (((1129829.018 1404481.296, 11298...</td>
      <td>0.176724</td>
      <td>0.454692</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>1.162758e-12</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>1.230523</td>
      <td>70.847537</td>
      <td>13.736515</td>
      <td>15.415948</td>
      <td>NRCS</td>
      <td>545818</td>
      <td>NRCS-545818</td>
    </tr>
    <tr>
      <th>13</th>
      <td>545819</td>
      <td>MULTIPOLYGON (((1130832.496 1405209.106, 11308...</td>
      <td>0.179179</td>
      <td>0.453829</td>
      <td>0.000149</td>
      <td>1.469380</td>
      <td>1.077383e-12</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.313860</td>
      <td>1.237111</td>
      <td>69.872443</td>
      <td>14.111475</td>
      <td>16.016082</td>
      <td>NRCS</td>
      <td>545819</td>
      <td>NRCS-545819</td>
    </tr>
    <tr>
      <th>14</th>
      <td>545820</td>
      <td>MULTIPOLYGON (((1130594.795 1406194.606, 11305...</td>
      <td>0.176724</td>
      <td>0.454692</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>1.162758e-12</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>1.230523</td>
      <td>70.847537</td>
      <td>13.736515</td>
      <td>15.415948</td>
      <td>NRCS</td>
      <td>545820</td>
      <td>NRCS-545820</td>
    </tr>
    <tr>
      <th>15</th>
      <td>545829</td>
      <td>MULTIPOLYGON (((1132541.183 1404841.203, 11325...</td>
      <td>0.195475</td>
      <td>0.370974</td>
      <td>0.000131</td>
      <td>1.409385</td>
      <td>2.366513e-13</td>
      <td>2.03</td>
      <td>2.091075e-12</td>
      <td>0.421416</td>
      <td>1.535417</td>
      <td>57.760157</td>
      <td>27.569263</td>
      <td>14.670580</td>
      <td>NRCS</td>
      <td>545829</td>
      <td>NRCS-545829</td>
    </tr>
    <tr>
      <th>16</th>
      <td>545830</td>
      <td>MULTIPOLYGON (((1132031.497 1405039.905, 11320...</td>
      <td>0.195431</td>
      <td>0.370396</td>
      <td>0.000132</td>
      <td>1.409349</td>
      <td>2.367865e-13</td>
      <td>2.03</td>
      <td>1.689101e-12</td>
      <td>0.420388</td>
      <td>1.538287</td>
      <td>58.042625</td>
      <td>27.326604</td>
      <td>14.630771</td>
      <td>NRCS</td>
      <td>545830</td>
      <td>NRCS-545830</td>
    </tr>
    <tr>
      <th>17</th>
      <td>545831</td>
      <td>MULTIPOLYGON (((1130650.695 1406946.307, 11306...</td>
      <td>0.195360</td>
      <td>0.369401</td>
      <td>0.000134</td>
      <td>1.409332</td>
      <td>2.370381e-13</td>
      <td>2.03</td>
      <td>1.729105e-12</td>
      <td>0.418625</td>
      <td>1.543205</td>
      <td>58.526856</td>
      <td>26.910618</td>
      <td>14.562525</td>
      <td>NRCS</td>
      <td>545831</td>
      <td>NRCS-545831</td>
    </tr>
    <tr>
      <th>18</th>
      <td>545835</td>
      <td>MULTIPOLYGON (((1131130.296 1406792.506, 11311...</td>
      <td>0.202983</td>
      <td>0.420460</td>
      <td>0.000125</td>
      <td>1.404309</td>
      <td>3.889099e-13</td>
      <td>2.03</td>
      <td>9.069462e-13</td>
      <td>0.375338</td>
      <td>1.377167</td>
      <td>59.117274</td>
      <td>21.086002</td>
      <td>19.796724</td>
      <td>NRCS</td>
      <td>545835</td>
      <td>NRCS-545835</td>
    </tr>
    <tr>
      <th>19</th>
      <td>545836</td>
      <td>MULTIPOLYGON (((1133372.798 1405277.705, 11333...</td>
      <td>0.225964</td>
      <td>0.380189</td>
      <td>0.000118</td>
      <td>1.356194</td>
      <td>1.478829e-13</td>
      <td>2.03</td>
      <td>8.686821e-13</td>
      <td>0.410934</td>
      <td>1.542610</td>
      <td>53.155082</td>
      <td>25.296698</td>
      <td>21.548220</td>
      <td>NRCS</td>
      <td>545836</td>
      <td>NRCS-545836</td>
    </tr>
    <tr>
      <th>20</th>
      <td>545837</td>
      <td>MULTIPOLYGON (((1132492.397 1405272.505, 11325...</td>
      <td>0.219777</td>
      <td>0.382865</td>
      <td>0.000117</td>
      <td>1.368452</td>
      <td>1.688837e-13</td>
      <td>2.03</td>
      <td>9.140653e-13</td>
      <td>0.353400</td>
      <td>1.523322</td>
      <td>53.594200</td>
      <td>25.951006</td>
      <td>20.454794</td>
      <td>NRCS</td>
      <td>545837</td>
      <td>NRCS-545837</td>
    </tr>
    <tr>
      <th>21</th>
      <td>545838</td>
      <td>MULTIPOLYGON (((1132692.297 1406223.605, 11326...</td>
      <td>0.224883</td>
      <td>0.381193</td>
      <td>0.000114</td>
      <td>1.359591</td>
      <td>1.486964e-13</td>
      <td>2.03</td>
      <td>9.090539e-13</td>
      <td>0.348524</td>
      <td>1.534344</td>
      <td>52.199770</td>
      <td>26.439637</td>
      <td>21.360593</td>
      <td>NRCS</td>
      <td>545838</td>
      <td>NRCS-545838</td>
    </tr>
    <tr>
      <th>22</th>
      <td>545842</td>
      <td>MULTIPOLYGON (((1132238.796 1408684.207, 11322...</td>
      <td>0.193278</td>
      <td>0.412219</td>
      <td>0.000142</td>
      <td>1.434838</td>
      <td>4.783588e-13</td>
      <td>2.03</td>
      <td>9.952892e-13</td>
      <td>0.386946</td>
      <td>1.400000</td>
      <td>64.415764</td>
      <td>18.601478</td>
      <td>16.982759</td>
      <td>NRCS</td>
      <td>545842</td>
      <td>NRCS-545842</td>
    </tr>
    <tr>
      <th>23</th>
      <td>545843</td>
      <td>MULTIPOLYGON (((1130711.995 1408154.207, 11307...</td>
      <td>0.200565</td>
      <td>0.409655</td>
      <td>0.000118</td>
      <td>1.409272</td>
      <td>3.388668e-13</td>
      <td>2.03</td>
      <td>9.952892e-13</td>
      <td>0.387980</td>
      <td>1.400000</td>
      <td>56.982759</td>
      <td>24.706897</td>
      <td>18.310345</td>
      <td>NRCS</td>
      <td>545843</td>
      <td>NRCS-545843</td>
    </tr>
    <tr>
      <th>24</th>
      <td>545852</td>
      <td>MULTIPOLYGON (((1129583.595 1405958.407, 11296...</td>
      <td>0.174940</td>
      <td>0.395697</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>4.885423e-13</td>
      <td>2.03</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>1.404089</td>
      <td>60.280000</td>
      <td>28.050000</td>
      <td>11.670000</td>
      <td>NRCS</td>
      <td>545852</td>
      <td>NRCS-545852</td>
    </tr>
    <tr>
      <th>25</th>
      <td>545853</td>
      <td>MULTIPOLYGON (((1130816.796 1405093.006, 11308...</td>
      <td>0.174940</td>
      <td>0.395697</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>4.885423e-13</td>
      <td>2.03</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>1.404089</td>
      <td>60.280000</td>
      <td>28.050000</td>
      <td>11.670000</td>
      <td>NRCS</td>
      <td>545853</td>
      <td>NRCS-545853</td>
    </tr>
    <tr>
      <th>26</th>
      <td>545854</td>
      <td>MULTIPOLYGON (((1130252.496 1404576.306, 11302...</td>
      <td>0.174940</td>
      <td>0.395697</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>4.885423e-13</td>
      <td>2.03</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>1.404089</td>
      <td>60.280000</td>
      <td>28.050000</td>
      <td>11.670000</td>
      <td>NRCS</td>
      <td>545854</td>
      <td>NRCS-545854</td>
    </tr>
    <tr>
      <th>27</th>
      <td>545855</td>
      <td>POLYGON ((1133569.697 1408334.306, 1133563.297...</td>
      <td>0.149582</td>
      <td>0.384703</td>
      <td>0.000247</td>
      <td>1.928427</td>
      <td>2.349139e-12</td>
      <td>2.03</td>
      <td>6.238368e-12</td>
      <td>0.235555</td>
      <td>1.474297</td>
      <td>84.857230</td>
      <td>9.099160</td>
      <td>6.043611</td>
      <td>NRCS</td>
      <td>545855</td>
      <td>NRCS-545855</td>
    </tr>
    <tr>
      <th>28</th>
      <td>545857</td>
      <td>MULTIPOLYGON (((1132073.397 1404858.905, 11320...</td>
      <td>0.175471</td>
      <td>0.416598</td>
      <td>0.000147</td>
      <td>1.484106</td>
      <td>7.390878e-13</td>
      <td>2.03</td>
      <td>4.981053e-15</td>
      <td>0.405556</td>
      <td>1.350000</td>
      <td>67.400000</td>
      <td>19.600000</td>
      <td>13.000000</td>
      <td>NRCS</td>
      <td>545857</td>
      <td>NRCS-545857</td>
    </tr>
    <tr>
      <th>29</th>
      <td>545859</td>
      <td>MULTIPOLYGON (((1133532.297 1408393.806, 11335...</td>
      <td>0.209607</td>
      <td>0.381582</td>
      <td>0.000108</td>
      <td>1.389431</td>
      <td>1.854826e-13</td>
      <td>2.03</td>
      <td>1.107558e-12</td>
      <td>0.265930</td>
      <td>1.502800</td>
      <td>51.495222</td>
      <td>30.403882</td>
      <td>18.100896</td>
      <td>NRCS</td>
      <td>545859</td>
      <td>NRCS-545859</td>
    </tr>
    <tr>
      <th>30</th>
      <td>545860</td>
      <td>MULTIPOLYGON (((1133109.197 1406512.605, 11331...</td>
      <td>0.210433</td>
      <td>0.385251</td>
      <td>0.000105</td>
      <td>1.390548</td>
      <td>1.880541e-13</td>
      <td>2.03</td>
      <td>1.035014e-12</td>
      <td>0.269704</td>
      <td>1.488030</td>
      <td>50.640394</td>
      <td>30.852217</td>
      <td>18.507389</td>
      <td>NRCS</td>
      <td>545860</td>
      <td>NRCS-545860</td>
    </tr>
    <tr>
      <th>31</th>
      <td>545861</td>
      <td>MULTIPOLYGON (((1133264.497 1408640.506, 11332...</td>
      <td>0.202264</td>
      <td>0.393882</td>
      <td>0.000117</td>
      <td>1.404424</td>
      <td>2.644035e-13</td>
      <td>2.03</td>
      <td>1.968721e-12</td>
      <td>0.309901</td>
      <td>1.455172</td>
      <td>55.476355</td>
      <td>26.989163</td>
      <td>17.534483</td>
      <td>NRCS</td>
      <td>545861</td>
      <td>NRCS-545861</td>
    </tr>
    <tr>
      <th>32</th>
      <td>545863</td>
      <td>MULTIPOLYGON (((1133988.297 1408799.806, 11339...</td>
      <td>0.208942</td>
      <td>0.381575</td>
      <td>0.000109</td>
      <td>1.390351</td>
      <td>1.885234e-13</td>
      <td>2.03</td>
      <td>1.131635e-12</td>
      <td>0.270988</td>
      <td>1.502407</td>
      <td>51.766596</td>
      <td>30.261553</td>
      <td>17.971851</td>
      <td>NRCS</td>
      <td>545863</td>
      <td>NRCS-545863</td>
    </tr>
    <tr>
      <th>33</th>
      <td>545874</td>
      <td>MULTIPOLYGON (((1133454.498 1405357.905, 11334...</td>
      <td>0.208675</td>
      <td>0.399614</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>2.920696e-13</td>
      <td>2.03</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>1.466059</td>
      <td>60.603941</td>
      <td>19.792611</td>
      <td>19.603448</td>
      <td>NRCS</td>
      <td>545874</td>
      <td>NRCS-545874</td>
    </tr>
    <tr>
      <th>34</th>
      <td>545875</td>
      <td>MULTIPOLYGON (((1132812.997 1406047.305, 11328...</td>
      <td>0.208675</td>
      <td>0.399614</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>2.920696e-13</td>
      <td>2.03</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>1.466059</td>
      <td>60.603941</td>
      <td>19.792611</td>
      <td>19.603448</td>
      <td>NRCS</td>
      <td>545875</td>
      <td>NRCS-545875</td>
    </tr>
    <tr>
      <th>35</th>
      <td>545876</td>
      <td>MULTIPOLYGON (((1134517.198 1407050.505, 11345...</td>
      <td>0.184037</td>
      <td>0.452018</td>
      <td>0.000141</td>
      <td>1.449088</td>
      <td>9.100580e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.324877</td>
      <td>1.247752</td>
      <td>67.266810</td>
      <td>15.562931</td>
      <td>17.170259</td>
      <td>NRCS</td>
      <td>545876</td>
      <td>NRCS-545876</td>
    </tr>
    <tr>
      <th>36</th>
      <td>545878</td>
      <td>MULTIPOLYGON (((1129854.195 1404493.006, 11299...</td>
      <td>0.196924</td>
      <td>0.425599</td>
      <td>0.000125</td>
      <td>1.416495</td>
      <td>4.633338e-13</td>
      <td>1.85</td>
      <td>2.282599e-12</td>
      <td>0.364041</td>
      <td>1.346733</td>
      <td>59.965519</td>
      <td>21.381982</td>
      <td>18.652500</td>
      <td>NRCS</td>
      <td>545878</td>
      <td>NRCS-545878</td>
    </tr>
    <tr>
      <th>37</th>
      <td>545882</td>
      <td>POLYGON ((1133621.697 1408540.806, 1133603.497...</td>
      <td>0.184498</td>
      <td>0.361656</td>
      <td>0.000091</td>
      <td>1.439689</td>
      <td>2.057343e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.280000</td>
      <td>1.530000</td>
      <td>45.300000</td>
      <td>43.200000</td>
      <td>11.500000</td>
      <td>NRCS</td>
      <td>545882</td>
      <td>NRCS-545882</td>
    </tr>
    <tr>
      <th>38</th>
      <td>545885</td>
      <td>MULTIPOLYGON (((1130139.195 1406476.107, 11301...</td>
      <td>0.165660</td>
      <td>0.400572</td>
      <td>0.000183</td>
      <td>1.574297</td>
      <td>9.869368e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.326502</td>
      <td>1.413645</td>
      <td>74.559606</td>
      <td>15.282759</td>
      <td>10.157635</td>
      <td>NRCS</td>
      <td>545885</td>
      <td>NRCS-545885</td>
    </tr>
    <tr>
      <th>39</th>
      <td>545886</td>
      <td>MULTIPOLYGON (((1129354.294 1407598.707, 11293...</td>
      <td>0.165660</td>
      <td>0.400572</td>
      <td>0.000183</td>
      <td>1.574297</td>
      <td>9.869368e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.306355</td>
      <td>1.413645</td>
      <td>74.559606</td>
      <td>15.282759</td>
      <td>10.157635</td>
      <td>NRCS</td>
      <td>545886</td>
      <td>NRCS-545886</td>
    </tr>
    <tr>
      <th>40</th>
      <td>545887</td>
      <td>POLYGON ((1129821.295 1406513.007, 1129781.195...</td>
      <td>0.165660</td>
      <td>0.400572</td>
      <td>0.000183</td>
      <td>1.574297</td>
      <td>9.869368e-13</td>
      <td>2.03</td>
      <td>2.800000e-12</td>
      <td>0.306355</td>
      <td>1.413645</td>
      <td>74.559606</td>
      <td>15.282759</td>
      <td>10.157635</td>
      <td>NRCS</td>
      <td>545887</td>
      <td>NRCS-545887</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a clean dataframe with just the data we will need for ATS</span>
<span class="k">def</span><span class="w"> </span><span class="nf">replace_column_nans</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col_nan</span><span class="p">,</span> <span class="n">col_replacement</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;In a df, replace col_nan entries by col_replacement if is nan.  In Place!&quot;&quot;&quot;</span>
    <span class="n">row_indexer</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col_nan</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span> <span class="n">col_nan</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">row_indexer</span><span class="p">,</span> <span class="n">col_replacement</span><span class="p">]</span>
    <span class="k">return</span>

<span class="c1"># where poro or perm is nan, put Rosetta poro</span>
<span class="n">replace_column_nans</span><span class="p">(</span><span class="n">nrcs</span><span class="p">,</span> <span class="s1">&#39;porosity [-]&#39;</span><span class="p">,</span> <span class="s1">&#39;Rosetta porosity [-]&#39;</span><span class="p">)</span>
<span class="n">replace_column_nans</span><span class="p">(</span><span class="n">nrcs</span><span class="p">,</span> <span class="s1">&#39;permeability [m^2]&#39;</span><span class="p">,</span> <span class="s1">&#39;Rosetta permeability [m^2]&#39;</span><span class="p">)</span>

<span class="c1"># drop unnecessary columns</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Rosetta porosity [-]&#39;</span><span class="p">,</span> <span class="s1">&#39;Rosetta permeability [m^2]&#39;</span><span class="p">,</span> <span class="s1">&#39;bulk density [g/cm^3]&#39;</span><span class="p">,</span> <span class="s1">&#39;total sand pct [%]&#39;</span><span class="p">,</span>
            <span class="s1">&#39;total silt pct [%]&#39;</span><span class="p">,</span> <span class="s1">&#39;total clay pct [%]&#39;</span><span class="p">]:</span>
    <span class="n">nrcs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">col</span><span class="p">)</span>
    
<span class="c1"># drop nans</span>
<span class="n">nan_mask</span> <span class="o">=</span> <span class="n">nrcs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dropped_mukeys</span> <span class="o">=</span> <span class="n">nrcs</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">nan_mask</span><span class="p">]</span>

<span class="c1"># Drop those rows</span>
<span class="n">nrcs</span> <span class="o">=</span> <span class="n">nrcs</span><span class="p">[</span><span class="o">~</span><span class="n">nan_mask</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">nrcs</span><span class="p">[</span><span class="s1">&#39;porosity [-]&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">min_porosity</span>
<span class="k">assert</span> <span class="n">nrcs</span><span class="p">[</span><span class="s1">&#39;permeability [m^2]&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">max_permeability</span>
<span class="n">nrcs</span>

<span class="c1"># check for nans</span>
<span class="n">nrcs</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mukey                          False
geometry                       False
residual saturation [-]        False
van Genuchten alpha [Pa^-1]    False
van Genuchten n [-]            False
thickness [m]                  False
permeability [m^2]             False
porosity [-]                   False
source                         False
ID                             False
name                           False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the soil color of each cell of the mesh</span>
<span class="c1"># Note, we use mukey here because it is an int, while ID is a string</span>
<span class="n">soil_color_mukey</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">getShapePropertiesOnMesh</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">nrcs</span><span class="p">,</span> <span class="s1">&#39;mukey&#39;</span><span class="p">,</span> 
                                                         <span class="n">resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">)</span>

<span class="n">nrcs</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;mukey&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">unique_soil_colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">soil_color_mukey</span><span class="p">))</span>
<span class="k">if</span> <span class="o">-</span><span class="mi">999</span> <span class="ow">in</span> <span class="n">unique_soil_colors</span><span class="p">:</span>
    <span class="n">unique_soil_colors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span>

<span class="c1"># retain only the unique values of soil_color</span>
<span class="n">nrcs</span> <span class="o">=</span> <span class="n">nrcs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unique_soil_colors</span><span class="p">]</span>

<span class="c1"># renumber the ones we know will appear with an ATS ID using ATS conventions</span>
<span class="n">nrcs</span><span class="p">[</span><span class="s1">&#39;ATS ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_soil_colors</span><span class="p">))</span>
<span class="n">nrcs</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ATS ID&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create a new soil color and a soil thickness map using the ATS IDs</span>
<span class="n">soil_color</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">soil_color_mukey</span><span class="p">)</span>
<span class="n">soil_thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">soil_color</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ats_ID</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">thickness</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nrcs</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">nrcs</span><span class="o">.</span><span class="n">mukey</span><span class="p">,</span> <span class="n">nrcs</span><span class="p">[</span><span class="s1">&#39;thickness [m]&#39;</span><span class="p">]):</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">soil_color_mukey</span> <span class="o">==</span> <span class="n">ID</span><span class="p">)</span>
    <span class="n">soil_thickness</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">thickness</span>
    <span class="n">soil_color</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">ats_ID</span>

<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;soil_color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soil_color</span>
<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;soil thickness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">soil_thickness</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the soil color</span>
<span class="c1"># -- get a cmap for soil color</span>
<span class="n">sc_indices</span><span class="p">,</span> <span class="n">sc_cmap</span><span class="p">,</span> <span class="n">sc_norm</span><span class="p">,</span> <span class="n">sc_ticks</span><span class="p">,</span> <span class="n">sc_labels</span> <span class="o">=</span> \
      <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createIndexedColormap</span><span class="p">(</span><span class="n">nrcs</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="n">mp</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolors</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;soil_color&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">sc_cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">sc_norm</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">createIndexedColorbar</span><span class="p">(</span><span class="n">ncolors</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">nrcs</span><span class="p">),</span> 
                               <span class="n">cmap</span><span class="o">=</span><span class="n">sc_cmap</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">sc_labels</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/fec40968b943de8c6203b3131da836973dbf1eed3fb61387d4c39409ae3f54b4.png" src="../_images/fec40968b943de8c6203b3131da836973dbf1eed3fb61387d4c39409ae3f54b4.png" />
</div>
</div>
</section>
<section id="depth-to-bedrock-from-soilgrids">
<h3>Depth to Bedrock from SoilGrids<a class="headerlink" href="#depth-to-bedrock-from-soilgrids" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dtb</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;depth to bedrock&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getDataset</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">)[</span><span class="s1">&#39;band_1&#39;</span><span class="p">]</span>

<span class="c1"># the SoilGrids dataset is in cm --&gt; convert to meters</span>
<span class="n">dtb</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="n">dtb</span><span class="o">.</span><span class="n">values</span><span class="o">/</span><span class="mf">100.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:52,495 - root - INFO: Incoming shape area = 0.0016040429015210392
2025-08-29 17:27:52,496 - root - INFO: ... buffering incoming shape by = 0.0020833330000016304
2025-08-29 17:27:52,496 - root - INFO: ... buffered shape area = 0.00196035495453784
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># map to the mesh</span>
<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">getDatasetOnMesh</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">dtb</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gons</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">facecolors</span><span class="o">=</span><span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/969c6f6bbf141e0be454e26302603b86776bc819b4dab3490ba1ccc8f52f6eff.png" src="../_images/969c6f6bbf141e0be454e26302603b86776bc819b4dab3490ba1ccc8f52f6eff.png" />
</div>
</div>
</section>
<section id="glhymps-geology">
<h3>GLHYMPs Geology<a class="headerlink" href="#glhymps-geology" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glhymps</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;geologic structure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getShapesByGeometry</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">watershed</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">out_crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
<span class="n">glhymps</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">soil_properties</span><span class="o">.</span><span class="n">mangleGLHYMPSProperties</span><span class="p">(</span><span class="n">glhymps</span><span class="p">,</span>
                                              <span class="n">min_porosity</span><span class="o">=</span><span class="n">min_porosity</span><span class="p">,</span> 
                                              <span class="n">max_permeability</span><span class="o">=</span><span class="n">max_permeability</span><span class="p">,</span> 
                                              <span class="n">max_vg_alpha</span><span class="o">=</span><span class="n">max_vg_alpha</span><span class="p">)</span>

<span class="c1"># intersect with the buffered geometry -- don&#39;t keep extras</span>
<span class="n">glhymps</span> <span class="o">=</span> <span class="n">glhymps</span><span class="p">[</span><span class="n">glhymps</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="mi">10</span><span class="p">))]</span>
<span class="n">glhymps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:52,723 - root - INFO: fixing column: geometry
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>name</th>
      <th>source</th>
      <th>permeability [m^2]</th>
      <th>logk_stdev [-]</th>
      <th>porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>residual saturation [-]</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1793338</td>
      <td>GLHYMPS-1793338</td>
      <td>GLHYMPS</td>
      <td>3.019952e-11</td>
      <td>1.61</td>
      <td>0.05</td>
      <td>0.001</td>
      <td>2.0</td>
      <td>0.01</td>
      <td>MULTIPOLYGON (((1060059.466 1375224.917, 10600...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># quality check -- make sure glymps shapes cover the watershed</span>
<span class="nb">print</span><span class="p">(</span><span class="n">glhymps</span><span class="o">.</span><span class="n">union_all</span><span class="p">()</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">))</span>
<span class="n">glhymps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>name</th>
      <th>source</th>
      <th>permeability [m^2]</th>
      <th>logk_stdev [-]</th>
      <th>porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>residual saturation [-]</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1793338</td>
      <td>GLHYMPS-1793338</td>
      <td>GLHYMPS</td>
      <td>3.019952e-11</td>
      <td>1.61</td>
      <td>0.05</td>
      <td>0.001</td>
      <td>2.0</td>
      <td>0.01</td>
      <td>MULTIPOLYGON (((1060059.466 1375224.917, 10600...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># clean the data</span>
<span class="n">glhymps</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;logk_stdev [-]&#39;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">glhymps</span><span class="p">[</span><span class="s1">&#39;porosity [-]&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">min_porosity</span>
<span class="k">assert</span> <span class="n">glhymps</span><span class="p">[</span><span class="s1">&#39;permeability [m^2]&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">max_permeability</span>
<span class="k">assert</span> <span class="n">glhymps</span><span class="p">[</span><span class="s1">&#39;van Genuchten alpha [Pa^-1]&#39;</span><span class="p">][:]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">max_vg_alpha</span>

<span class="n">glhymps</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ID                             False
name                           False
source                         False
permeability [m^2]             False
porosity [-]                   False
van Genuchten alpha [Pa^-1]    False
van Genuchten n [-]            False
residual saturation [-]        False
geometry                       False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># note that for larger areas there are often common regions -- two labels with the same properties -- no need to duplicate those with identical values.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">reindex_remove_duplicates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes duplicates, creating a new index and saving the old index as tuples of duplicate values. In place!&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">index_name</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span>

    <span class="c1"># identify duplicate rows</span>
    <span class="n">duplicates</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">index</span><span class="p">)))</span>

    <span class="c1"># order is preserved</span>
    <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="n">index_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">duplicates</span>
    <span class="k">return</span>

<span class="n">reindex_remove_duplicates</span><span class="p">(</span><span class="n">glhymps</span><span class="p">,</span> <span class="s1">&#39;ID&#39;</span><span class="p">)</span>
<span class="n">glhymps</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>name</th>
      <th>source</th>
      <th>permeability [m^2]</th>
      <th>porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>residual saturation [-]</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(1793338,)</td>
      <td>GLHYMPS-1793338</td>
      <td>GLHYMPS</td>
      <td>3.019952e-11</td>
      <td>0.05</td>
      <td>0.001</td>
      <td>2.0</td>
      <td>0.01</td>
      <td>MULTIPOLYGON (((1060059.466 1375224.917, 10600...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute the geo color of each cell of the mesh</span>
<span class="n">geology_color_glhymps</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">getShapePropertiesOnMesh</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">glhymps</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">,</span> 
                                                         <span class="n">resolution</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mi">999</span><span class="p">)</span>

<span class="c1"># retain only the unique values of geology that actually appear in our cell mesh</span>
<span class="n">unique_geology_colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">geology_color_glhymps</span><span class="p">))</span>
<span class="k">if</span> <span class="o">-</span><span class="mi">999</span> <span class="ow">in</span> <span class="n">unique_geology_colors</span><span class="p">:</span>
    <span class="n">unique_geology_colors</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span>

<span class="c1"># retain only the unique values of geology_color</span>
<span class="n">glhymps</span> <span class="o">=</span> <span class="n">glhymps</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">unique_geology_colors</span><span class="p">]</span>

<span class="c1"># renumber the ones we know will appear with an ATS ID using ATS conventions</span>
<span class="n">glhymps</span><span class="p">[</span><span class="s1">&#39;ATS ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_geology_colors</span><span class="p">))</span>
<span class="n">glhymps</span><span class="p">[</span><span class="s1">&#39;TMP_ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">glhymps</span><span class="o">.</span><span class="n">index</span>
<span class="n">glhymps</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">glhymps</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;ATS ID&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># create a new geology color using the ATS IDs</span>
<span class="n">geology_color</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">geology_color_glhymps</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ats_ID</span><span class="p">,</span> <span class="n">tmp_ID</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">glhymps</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">glhymps</span><span class="o">.</span><span class="n">TMP_ID</span><span class="p">):</span>
    <span class="n">geology_color</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">geology_color_glhymps</span> <span class="o">==</span> <span class="n">tmp_ID</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ats_ID</span>

<span class="n">glhymps</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;TMP_ID&#39;</span><span class="p">)</span>

<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;geology_color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geology_color</span>
                            
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">geology_color_glhymps</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;index&#x27; ()&gt; Size: 8B
array(0)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'index'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-46938c52-1ec5-42bd-9d90-a43db861bbae' class='xr-array-in' type='checkbox' checked><label for='section-46938c52-1ec5-42bd-9d90-a43db861bbae' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0</span></div><div class='xr-array-data'><pre>array(0)</pre></div></div></li><li class='xr-section-item'><input id='section-21236682-dfa1-4169-833b-121b14342886' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-21236682-dfa1-4169-833b-121b14342886' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-3cef1ae3-6c8e-4fd3-a6da-7b0bec76a72b' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3cef1ae3-6c8e-4fd3-a6da-7b0bec76a72b' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-0886348e-1bce-4006-9d8d-d1c5f470f6ff' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-0886348e-1bce-4006-9d8d-d1c5f470f6ff' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="combine-to-form-a-complete-subsurface-dataset">
<h3>Combine to form a complete subsurface dataset<a class="headerlink" href="#combine-to-form-a-complete-subsurface-dataset" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bedrock</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">soil_properties</span><span class="o">.</span><span class="n">getDefaultBedrockProperties</span><span class="p">()</span>

<span class="c1"># merge the properties databases</span>
<span class="n">subsurface_props</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">glhymps</span><span class="p">,</span> <span class="n">nrcs</span><span class="p">,</span> <span class="n">bedrock</span><span class="p">])</span>

<span class="c1"># save the properties to disk for use in generating input file</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;subsurface_properties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_subsurface_properties.csv&#39;</span><span class="p">)</span>
<span class="n">subsurface_props</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;subsurface_properties&#39;</span><span class="p">])</span>
<span class="n">subsurface_props</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>name</th>
      <th>source</th>
      <th>permeability [m^2]</th>
      <th>porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>residual saturation [-]</th>
      <th>geometry</th>
      <th>mukey</th>
      <th>thickness [m]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>(1793338,)</td>
      <td>GLHYMPS-1793338</td>
      <td>GLHYMPS</td>
      <td>3.019952e-11</td>
      <td>0.050000</td>
      <td>0.001000</td>
      <td>2.000000</td>
      <td>0.010000</td>
      <td>MULTIPOLYGON (((1060059.466 1375224.917, 10600...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1000</th>
      <td>545800</td>
      <td>NRCS-545800</td>
      <td>NRCS</td>
      <td>3.429028e-15</td>
      <td>0.307246</td>
      <td>0.000139</td>
      <td>1.470755</td>
      <td>0.177165</td>
      <td>MULTIPOLYGON (((1131335.296 1404750.906, 11313...</td>
      <td>545800.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1001</th>
      <td>545803</td>
      <td>NRCS-545803</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.379163</td>
      <td>0.000150</td>
      <td>1.491087</td>
      <td>0.172412</td>
      <td>MULTIPOLYGON (((1130760.995 1408224.107, 11307...</td>
      <td>545803.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1002</th>
      <td>545805</td>
      <td>NRCS-545805</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1134255.698 1405132.204, 11342...</td>
      <td>545805.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1003</th>
      <td>545806</td>
      <td>NRCS-545806</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1134180.798 1405169.304, 11341...</td>
      <td>545806.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1004</th>
      <td>545807</td>
      <td>NRCS-545807</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1131255.496 1405664.406, 11312...</td>
      <td>545807.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1005</th>
      <td>545811</td>
      <td>NRCS-545811</td>
      <td>NRCS</td>
      <td>1.830706e-12</td>
      <td>0.329821</td>
      <td>0.000166</td>
      <td>1.473045</td>
      <td>0.185628</td>
      <td>MULTIPOLYGON (((1130078.796 1404597.506, 11300...</td>
      <td>545811.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1006</th>
      <td>545813</td>
      <td>NRCS-545813</td>
      <td>NRCS</td>
      <td>6.219065e-14</td>
      <td>0.349442</td>
      <td>0.000127</td>
      <td>1.445858</td>
      <td>0.183468</td>
      <td>MULTIPOLYGON (((1132919.997 1405040.305, 11329...</td>
      <td>545813.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1007</th>
      <td>545814</td>
      <td>NRCS-545814</td>
      <td>NRCS</td>
      <td>6.060887e-14</td>
      <td>0.346424</td>
      <td>0.000125</td>
      <td>1.445793</td>
      <td>0.183216</td>
      <td>MULTIPOLYGON (((1131226.596 1404721.006, 11312...</td>
      <td>545814.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1008</th>
      <td>545815</td>
      <td>NRCS-545815</td>
      <td>NRCS</td>
      <td>3.794887e-14</td>
      <td>0.319402</td>
      <td>0.000162</td>
      <td>1.498482</td>
      <td>0.177808</td>
      <td>MULTIPOLYGON (((1131297.396 1404750.606, 11313...</td>
      <td>545815.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1009</th>
      <td>545818</td>
      <td>NRCS-545818</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>0.176724</td>
      <td>MULTIPOLYGON (((1129829.018 1404481.296, 11298...</td>
      <td>545818.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1010</th>
      <td>545819</td>
      <td>NRCS-545819</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.313860</td>
      <td>0.000149</td>
      <td>1.469380</td>
      <td>0.179179</td>
      <td>MULTIPOLYGON (((1130832.496 1405209.106, 11308...</td>
      <td>545819.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1011</th>
      <td>545820</td>
      <td>NRCS-545820</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>0.176724</td>
      <td>MULTIPOLYGON (((1130594.795 1406194.606, 11305...</td>
      <td>545820.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1012</th>
      <td>545829</td>
      <td>NRCS-545829</td>
      <td>NRCS</td>
      <td>2.091075e-12</td>
      <td>0.421416</td>
      <td>0.000131</td>
      <td>1.409385</td>
      <td>0.195475</td>
      <td>MULTIPOLYGON (((1132541.183 1404841.203, 11325...</td>
      <td>545829.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1013</th>
      <td>545830</td>
      <td>NRCS-545830</td>
      <td>NRCS</td>
      <td>1.689101e-12</td>
      <td>0.420388</td>
      <td>0.000132</td>
      <td>1.409349</td>
      <td>0.195431</td>
      <td>MULTIPOLYGON (((1132031.497 1405039.905, 11320...</td>
      <td>545830.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1014</th>
      <td>545831</td>
      <td>NRCS-545831</td>
      <td>NRCS</td>
      <td>1.729105e-12</td>
      <td>0.418625</td>
      <td>0.000134</td>
      <td>1.409332</td>
      <td>0.195360</td>
      <td>MULTIPOLYGON (((1130650.695 1406946.307, 11306...</td>
      <td>545831.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>545835</td>
      <td>NRCS-545835</td>
      <td>NRCS</td>
      <td>9.069462e-13</td>
      <td>0.375338</td>
      <td>0.000125</td>
      <td>1.404309</td>
      <td>0.202983</td>
      <td>MULTIPOLYGON (((1131130.296 1406792.506, 11311...</td>
      <td>545835.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1016</th>
      <td>545836</td>
      <td>NRCS-545836</td>
      <td>NRCS</td>
      <td>8.686821e-13</td>
      <td>0.410934</td>
      <td>0.000118</td>
      <td>1.356194</td>
      <td>0.225964</td>
      <td>MULTIPOLYGON (((1133372.798 1405277.705, 11333...</td>
      <td>545836.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1017</th>
      <td>545837</td>
      <td>NRCS-545837</td>
      <td>NRCS</td>
      <td>9.140653e-13</td>
      <td>0.353400</td>
      <td>0.000117</td>
      <td>1.368452</td>
      <td>0.219777</td>
      <td>MULTIPOLYGON (((1132492.397 1405272.505, 11325...</td>
      <td>545837.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1018</th>
      <td>545838</td>
      <td>NRCS-545838</td>
      <td>NRCS</td>
      <td>9.090539e-13</td>
      <td>0.348524</td>
      <td>0.000114</td>
      <td>1.359591</td>
      <td>0.224883</td>
      <td>MULTIPOLYGON (((1132692.297 1406223.605, 11326...</td>
      <td>545838.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1019</th>
      <td>545842</td>
      <td>NRCS-545842</td>
      <td>NRCS</td>
      <td>9.952892e-13</td>
      <td>0.386946</td>
      <td>0.000142</td>
      <td>1.434838</td>
      <td>0.193278</td>
      <td>MULTIPOLYGON (((1132238.796 1408684.207, 11322...</td>
      <td>545842.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>545843</td>
      <td>NRCS-545843</td>
      <td>NRCS</td>
      <td>9.952892e-13</td>
      <td>0.387980</td>
      <td>0.000118</td>
      <td>1.409272</td>
      <td>0.200565</td>
      <td>MULTIPOLYGON (((1130711.995 1408154.207, 11307...</td>
      <td>545843.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1021</th>
      <td>545853</td>
      <td>NRCS-545853</td>
      <td>NRCS</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>0.174940</td>
      <td>MULTIPOLYGON (((1130816.796 1405093.006, 11308...</td>
      <td>545853.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1022</th>
      <td>545854</td>
      <td>NRCS-545854</td>
      <td>NRCS</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>0.174940</td>
      <td>MULTIPOLYGON (((1130252.496 1404576.306, 11302...</td>
      <td>545854.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1023</th>
      <td>545855</td>
      <td>NRCS-545855</td>
      <td>NRCS</td>
      <td>6.238368e-12</td>
      <td>0.235555</td>
      <td>0.000247</td>
      <td>1.928427</td>
      <td>0.149582</td>
      <td>POLYGON ((1133569.697 1408334.306, 1133563.297...</td>
      <td>545855.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1024</th>
      <td>545857</td>
      <td>NRCS-545857</td>
      <td>NRCS</td>
      <td>4.981053e-15</td>
      <td>0.405556</td>
      <td>0.000147</td>
      <td>1.484106</td>
      <td>0.175471</td>
      <td>MULTIPOLYGON (((1132073.397 1404858.905, 11320...</td>
      <td>545857.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1025</th>
      <td>545859</td>
      <td>NRCS-545859</td>
      <td>NRCS</td>
      <td>1.107558e-12</td>
      <td>0.265930</td>
      <td>0.000108</td>
      <td>1.389431</td>
      <td>0.209607</td>
      <td>MULTIPOLYGON (((1133532.297 1408393.806, 11335...</td>
      <td>545859.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1026</th>
      <td>545860</td>
      <td>NRCS-545860</td>
      <td>NRCS</td>
      <td>1.035014e-12</td>
      <td>0.269704</td>
      <td>0.000105</td>
      <td>1.390548</td>
      <td>0.210433</td>
      <td>MULTIPOLYGON (((1133109.197 1406512.605, 11331...</td>
      <td>545860.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1027</th>
      <td>545861</td>
      <td>NRCS-545861</td>
      <td>NRCS</td>
      <td>1.968721e-12</td>
      <td>0.309901</td>
      <td>0.000117</td>
      <td>1.404424</td>
      <td>0.202264</td>
      <td>MULTIPOLYGON (((1133264.497 1408640.506, 11332...</td>
      <td>545861.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1028</th>
      <td>545874</td>
      <td>NRCS-545874</td>
      <td>NRCS</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>0.208675</td>
      <td>MULTIPOLYGON (((1133454.498 1405357.905, 11334...</td>
      <td>545874.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1029</th>
      <td>545875</td>
      <td>NRCS-545875</td>
      <td>NRCS</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>0.208675</td>
      <td>MULTIPOLYGON (((1132812.997 1406047.305, 11328...</td>
      <td>545875.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1030</th>
      <td>545876</td>
      <td>NRCS-545876</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.324877</td>
      <td>0.000141</td>
      <td>1.449088</td>
      <td>0.184037</td>
      <td>MULTIPOLYGON (((1134517.198 1407050.505, 11345...</td>
      <td>545876.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1031</th>
      <td>545878</td>
      <td>NRCS-545878</td>
      <td>NRCS</td>
      <td>2.282599e-12</td>
      <td>0.364041</td>
      <td>0.000125</td>
      <td>1.416495</td>
      <td>0.196924</td>
      <td>MULTIPOLYGON (((1129854.195 1404493.006, 11299...</td>
      <td>545878.0</td>
      <td>1.85</td>
    </tr>
    <tr>
      <th>1032</th>
      <td>545882</td>
      <td>NRCS-545882</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.280000</td>
      <td>0.000091</td>
      <td>1.439689</td>
      <td>0.184498</td>
      <td>POLYGON ((1133621.697 1408540.806, 1133603.497...</td>
      <td>545882.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1033</th>
      <td>545885</td>
      <td>NRCS-545885</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.326502</td>
      <td>0.000183</td>
      <td>1.574297</td>
      <td>0.165660</td>
      <td>MULTIPOLYGON (((1130139.195 1406476.107, 11301...</td>
      <td>545885.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>bedrock</td>
      <td>n/a</td>
      <td>1.000000e-16</td>
      <td>0.050000</td>
      <td>0.000019</td>
      <td>3.000000</td>
      <td>0.010000</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="extrude-the-2d-mesh-to-make-a-3d-mesh">
<h2>Extrude the 2D Mesh to make a 3D mesh<a class="headerlink" href="#extrude-the-2d-mesh-to-make-a-3d-mesh" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the floor of the domain as max DTB</span>
<span class="n">dtb_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">dtb_max</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;total thickness: </span><span class="si">{</span><span class="n">dtb_max</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
<span class="n">total_thickness</span> <span class="o">=</span> <span class="mf">50.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total thickness: 19.647739130592548 m
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a dz structure for the top 2m of soil</span>
<span class="c1">#</span>
<span class="c1"># here we try for 10 cells, starting at 5cm at the top and going to 50cm at the bottom of the 2m thick soil</span>
<span class="n">dzs</span><span class="p">,</span> <span class="n">res</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">optimizeDzs</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dzs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dzs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0.05447108 0.07161305 0.11027281 0.17443206 0.26441087 0.36782677
 0.45697337 0.49999999]
2.0000000000000004
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this looks like it would work out, with rounder numbers:</span>
<span class="n">dzs_soil</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dzs_soil</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 50m total thickness, minus 2m soil thickness, leaves us with 48 meters to make up.</span>
<span class="c1"># optimize again...</span>
<span class="n">dzs2</span><span class="p">,</span> <span class="n">res2</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">optimizeDzs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dzs2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dzs2</span><span class="p">))</span>

<span class="c1"># how about...</span>
<span class="n">dzs_geo</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dzs_geo</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">dzs_geo</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2.71113048 5.85796948 9.43304714 9.99786869 9.99998875 9.99999546]
48.0
[1.0, 2.0, 4.0, 8.0, 11, 11, 11]
48.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># layer extrusion</span>
<span class="n">DTB</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;dtb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">soil_color</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;soil_color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">geo_color</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;geology_color&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">soil_thickness</span> <span class="o">=</span> <span class="n">m2</span><span class="o">.</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;soil thickness&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>


<span class="c1"># -- data structures needed for extrusion</span>
<span class="n">layer_types</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">layer_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">layer_ncells</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">layer_mat_ids</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># -- soil layer --</span>
<span class="n">depth</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">dz</span> <span class="ow">in</span> <span class="n">dzs_soil</span><span class="p">:</span>
    <span class="n">depth</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span>
    <span class="n">layer_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
    <span class="n">layer_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span>
    <span class="n">layer_ncells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="c1"># use glhymps params</span>
    <span class="n">br_or_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DTB</span><span class="p">,</span> <span class="n">geo_color</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>
    <span class="n">soil_or_br_or_geo</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bitwise_and</span><span class="p">(</span><span class="n">soil_color</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">soil_thickness</span><span class="p">),</span>
                                 <span class="n">soil_color</span><span class="p">,</span>
                                 <span class="n">br_or_geo</span><span class="p">)</span>

    <span class="n">layer_mat_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">soil_or_br_or_geo</span><span class="p">)</span>
    <span class="n">depth</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span>
    
<span class="c1"># -- geologic layer --</span>
<span class="k">for</span> <span class="n">dz</span> <span class="ow">in</span> <span class="n">dzs_geo</span><span class="p">:</span>
    <span class="n">depth</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span>
    <span class="n">layer_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
    <span class="n">layer_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span>
    <span class="n">layer_ncells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">geo_or_br</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="n">DTB</span><span class="p">,</span> <span class="n">geo_color</span><span class="p">,</span> <span class="mi">999</span><span class="p">)</span>

    <span class="n">layer_mat_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo_or_br</span><span class="p">)</span>
    <span class="n">depth</span> <span class="o">+=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dz</span>

<span class="c1"># print the summary</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Mesh3D</span><span class="o">.</span><span class="n">summarizeExtrusion</span><span class="p">(</span><span class="n">layer_types</span><span class="p">,</span> <span class="n">layer_data</span><span class="p">,</span> 
                                            <span class="n">layer_ncells</span><span class="p">,</span> <span class="n">layer_mat_ids</span><span class="p">)</span>

<span class="c1"># downselect subsurface properties to only those that are used</span>
<span class="n">layer_mat_id_used</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">layer_mat_ids</span><span class="p">)))</span>
<span class="n">subsurface_props_used</span> <span class="o">=</span> <span class="n">subsurface_props</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">layer_mat_id_used</span><span class="p">]</span>
<span class="n">subsurface_props_used</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:53,356 - root - INFO: Cell summary:
2025-08-29 17:27:53,357 - root - INFO: ------------------------------------------------------------
2025-08-29 17:27:53,357 - root - INFO: l_id	| c_id	|mat_id	| dz		| z_top
2025-08-29 17:27:53,357 - root - INFO: ------------------------------------------------------------
2025-08-29 17:27:53,357 - root - INFO:  00 	| 00 	| 1008 	|   0.050000 	|   0.000000
2025-08-29 17:27:53,358 - root - INFO:  01 	| 01 	| 1008 	|   0.050000 	|   0.050000
2025-08-29 17:27:53,358 - root - INFO:  02 	| 02 	| 1008 	|   0.050000 	|   0.100000
2025-08-29 17:27:53,358 - root - INFO:  03 	| 03 	| 1008 	|   0.120000 	|   0.150000
2025-08-29 17:27:53,359 - root - INFO:  04 	| 04 	| 1008 	|   0.230000 	|   0.270000
2025-08-29 17:27:53,359 - root - INFO:  05 	| 05 	| 1008 	|   0.500000 	|   0.500000
2025-08-29 17:27:53,359 - root - INFO:  06 	| 06 	| 1008 	|   0.500000 	|   1.000000
2025-08-29 17:27:53,359 - root - INFO:  07 	| 07 	| 1008 	|   0.500000 	|   1.500000
2025-08-29 17:27:53,360 - root - INFO:  08 	| 08 	|  100 	|   1.000000 	|   2.000000
2025-08-29 17:27:53,360 - root - INFO:  09 	| 09 	|  100 	|   2.000000 	|   3.000000
2025-08-29 17:27:53,360 - root - INFO:  10 	| 10 	|  100 	|   4.000000 	|   5.000000
2025-08-29 17:27:53,360 - root - INFO:  11 	| 11 	|  100 	|   8.000000 	|   9.000000
2025-08-29 17:27:53,360 - root - INFO:  12 	| 12 	|  999 	|  11.000000 	|  17.000000
2025-08-29 17:27:53,360 - root - INFO:  13 	| 13 	|  999 	|  11.000000 	|  28.000000
2025-08-29 17:27:53,361 - root - INFO:  14 	| 14 	|  999 	|  11.000000 	|  39.000000
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>name</th>
      <th>source</th>
      <th>permeability [m^2]</th>
      <th>porosity [-]</th>
      <th>van Genuchten alpha [Pa^-1]</th>
      <th>van Genuchten n [-]</th>
      <th>residual saturation [-]</th>
      <th>geometry</th>
      <th>mukey</th>
      <th>thickness [m]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>(1793338,)</td>
      <td>GLHYMPS-1793338</td>
      <td>GLHYMPS</td>
      <td>3.019952e-11</td>
      <td>0.050000</td>
      <td>0.001000</td>
      <td>2.000000</td>
      <td>0.010000</td>
      <td>MULTIPOLYGON (((1060059.466 1375224.917, 10600...</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>999</th>
      <td>999</td>
      <td>bedrock</td>
      <td>n/a</td>
      <td>1.000000e-16</td>
      <td>0.050000</td>
      <td>0.000019</td>
      <td>3.000000</td>
      <td>0.010000</td>
      <td>None</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1000</th>
      <td>545800</td>
      <td>NRCS-545800</td>
      <td>NRCS</td>
      <td>3.429028e-15</td>
      <td>0.307246</td>
      <td>0.000139</td>
      <td>1.470755</td>
      <td>0.177165</td>
      <td>MULTIPOLYGON (((1131335.296 1404750.906, 11313...</td>
      <td>545800.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1001</th>
      <td>545803</td>
      <td>NRCS-545803</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.379163</td>
      <td>0.000150</td>
      <td>1.491087</td>
      <td>0.172412</td>
      <td>MULTIPOLYGON (((1130760.995 1408224.107, 11307...</td>
      <td>545803.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1002</th>
      <td>545805</td>
      <td>NRCS-545805</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1134255.698 1405132.204, 11342...</td>
      <td>545805.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1003</th>
      <td>545806</td>
      <td>NRCS-545806</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1134180.798 1405169.304, 11341...</td>
      <td>545806.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1004</th>
      <td>545807</td>
      <td>NRCS-545807</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.384877</td>
      <td>0.000083</td>
      <td>1.468789</td>
      <td>0.177122</td>
      <td>MULTIPOLYGON (((1131255.496 1405664.406, 11312...</td>
      <td>545807.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1005</th>
      <td>545811</td>
      <td>NRCS-545811</td>
      <td>NRCS</td>
      <td>1.830706e-12</td>
      <td>0.329821</td>
      <td>0.000166</td>
      <td>1.473045</td>
      <td>0.185628</td>
      <td>MULTIPOLYGON (((1130078.796 1404597.506, 11300...</td>
      <td>545811.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1006</th>
      <td>545813</td>
      <td>NRCS-545813</td>
      <td>NRCS</td>
      <td>6.219065e-14</td>
      <td>0.349442</td>
      <td>0.000127</td>
      <td>1.445858</td>
      <td>0.183468</td>
      <td>MULTIPOLYGON (((1132919.997 1405040.305, 11329...</td>
      <td>545813.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1007</th>
      <td>545814</td>
      <td>NRCS-545814</td>
      <td>NRCS</td>
      <td>6.060887e-14</td>
      <td>0.346424</td>
      <td>0.000125</td>
      <td>1.445793</td>
      <td>0.183216</td>
      <td>MULTIPOLYGON (((1131226.596 1404721.006, 11312...</td>
      <td>545814.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1008</th>
      <td>545815</td>
      <td>NRCS-545815</td>
      <td>NRCS</td>
      <td>3.794887e-14</td>
      <td>0.319402</td>
      <td>0.000162</td>
      <td>1.498482</td>
      <td>0.177808</td>
      <td>MULTIPOLYGON (((1131297.396 1404750.606, 11313...</td>
      <td>545815.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1009</th>
      <td>545818</td>
      <td>NRCS-545818</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>0.176724</td>
      <td>MULTIPOLYGON (((1129829.018 1404481.296, 11298...</td>
      <td>545818.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1010</th>
      <td>545819</td>
      <td>NRCS-545819</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.313860</td>
      <td>0.000149</td>
      <td>1.469380</td>
      <td>0.179179</td>
      <td>MULTIPOLYGON (((1130832.496 1405209.106, 11308...</td>
      <td>545819.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1011</th>
      <td>545820</td>
      <td>NRCS-545820</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.305511</td>
      <td>0.000151</td>
      <td>1.479294</td>
      <td>0.176724</td>
      <td>MULTIPOLYGON (((1130594.795 1406194.606, 11305...</td>
      <td>545820.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1012</th>
      <td>545829</td>
      <td>NRCS-545829</td>
      <td>NRCS</td>
      <td>2.091075e-12</td>
      <td>0.421416</td>
      <td>0.000131</td>
      <td>1.409385</td>
      <td>0.195475</td>
      <td>MULTIPOLYGON (((1132541.183 1404841.203, 11325...</td>
      <td>545829.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1013</th>
      <td>545830</td>
      <td>NRCS-545830</td>
      <td>NRCS</td>
      <td>1.689101e-12</td>
      <td>0.420388</td>
      <td>0.000132</td>
      <td>1.409349</td>
      <td>0.195431</td>
      <td>MULTIPOLYGON (((1132031.497 1405039.905, 11320...</td>
      <td>545830.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1014</th>
      <td>545831</td>
      <td>NRCS-545831</td>
      <td>NRCS</td>
      <td>1.729105e-12</td>
      <td>0.418625</td>
      <td>0.000134</td>
      <td>1.409332</td>
      <td>0.195360</td>
      <td>MULTIPOLYGON (((1130650.695 1406946.307, 11306...</td>
      <td>545831.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1015</th>
      <td>545835</td>
      <td>NRCS-545835</td>
      <td>NRCS</td>
      <td>9.069462e-13</td>
      <td>0.375338</td>
      <td>0.000125</td>
      <td>1.404309</td>
      <td>0.202983</td>
      <td>MULTIPOLYGON (((1131130.296 1406792.506, 11311...</td>
      <td>545835.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1016</th>
      <td>545836</td>
      <td>NRCS-545836</td>
      <td>NRCS</td>
      <td>8.686821e-13</td>
      <td>0.410934</td>
      <td>0.000118</td>
      <td>1.356194</td>
      <td>0.225964</td>
      <td>MULTIPOLYGON (((1133372.798 1405277.705, 11333...</td>
      <td>545836.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1017</th>
      <td>545837</td>
      <td>NRCS-545837</td>
      <td>NRCS</td>
      <td>9.140653e-13</td>
      <td>0.353400</td>
      <td>0.000117</td>
      <td>1.368452</td>
      <td>0.219777</td>
      <td>MULTIPOLYGON (((1132492.397 1405272.505, 11325...</td>
      <td>545837.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1018</th>
      <td>545838</td>
      <td>NRCS-545838</td>
      <td>NRCS</td>
      <td>9.090539e-13</td>
      <td>0.348524</td>
      <td>0.000114</td>
      <td>1.359591</td>
      <td>0.224883</td>
      <td>MULTIPOLYGON (((1132692.297 1406223.605, 11326...</td>
      <td>545838.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1019</th>
      <td>545842</td>
      <td>NRCS-545842</td>
      <td>NRCS</td>
      <td>9.952892e-13</td>
      <td>0.386946</td>
      <td>0.000142</td>
      <td>1.434838</td>
      <td>0.193278</td>
      <td>MULTIPOLYGON (((1132238.796 1408684.207, 11322...</td>
      <td>545842.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1020</th>
      <td>545843</td>
      <td>NRCS-545843</td>
      <td>NRCS</td>
      <td>9.952892e-13</td>
      <td>0.387980</td>
      <td>0.000118</td>
      <td>1.409272</td>
      <td>0.200565</td>
      <td>MULTIPOLYGON (((1130711.995 1408154.207, 11307...</td>
      <td>545843.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1021</th>
      <td>545853</td>
      <td>NRCS-545853</td>
      <td>NRCS</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>0.174940</td>
      <td>MULTIPOLYGON (((1130816.796 1405093.006, 11308...</td>
      <td>545853.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1022</th>
      <td>545854</td>
      <td>NRCS-545854</td>
      <td>NRCS</td>
      <td>1.811809e-12</td>
      <td>0.466299</td>
      <td>0.000127</td>
      <td>1.464370</td>
      <td>0.174940</td>
      <td>MULTIPOLYGON (((1130252.496 1404576.306, 11302...</td>
      <td>545854.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1023</th>
      <td>545855</td>
      <td>NRCS-545855</td>
      <td>NRCS</td>
      <td>6.238368e-12</td>
      <td>0.235555</td>
      <td>0.000247</td>
      <td>1.928427</td>
      <td>0.149582</td>
      <td>POLYGON ((1133569.697 1408334.306, 1133563.297...</td>
      <td>545855.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1024</th>
      <td>545857</td>
      <td>NRCS-545857</td>
      <td>NRCS</td>
      <td>4.981053e-15</td>
      <td>0.405556</td>
      <td>0.000147</td>
      <td>1.484106</td>
      <td>0.175471</td>
      <td>MULTIPOLYGON (((1132073.397 1404858.905, 11320...</td>
      <td>545857.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1025</th>
      <td>545859</td>
      <td>NRCS-545859</td>
      <td>NRCS</td>
      <td>1.107558e-12</td>
      <td>0.265930</td>
      <td>0.000108</td>
      <td>1.389431</td>
      <td>0.209607</td>
      <td>MULTIPOLYGON (((1133532.297 1408393.806, 11335...</td>
      <td>545859.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1026</th>
      <td>545860</td>
      <td>NRCS-545860</td>
      <td>NRCS</td>
      <td>1.035014e-12</td>
      <td>0.269704</td>
      <td>0.000105</td>
      <td>1.390548</td>
      <td>0.210433</td>
      <td>MULTIPOLYGON (((1133109.197 1406512.605, 11331...</td>
      <td>545860.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1027</th>
      <td>545861</td>
      <td>NRCS-545861</td>
      <td>NRCS</td>
      <td>1.968721e-12</td>
      <td>0.309901</td>
      <td>0.000117</td>
      <td>1.404424</td>
      <td>0.202264</td>
      <td>MULTIPOLYGON (((1133264.497 1408640.506, 11332...</td>
      <td>545861.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1028</th>
      <td>545874</td>
      <td>NRCS-545874</td>
      <td>NRCS</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>0.208675</td>
      <td>MULTIPOLYGON (((1133454.498 1405357.905, 11334...</td>
      <td>545874.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1029</th>
      <td>545875</td>
      <td>NRCS-545875</td>
      <td>NRCS</td>
      <td>1.023505e-12</td>
      <td>0.365616</td>
      <td>0.000135</td>
      <td>1.395264</td>
      <td>0.208675</td>
      <td>MULTIPOLYGON (((1132812.997 1406047.305, 11328...</td>
      <td>545875.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1030</th>
      <td>545876</td>
      <td>NRCS-545876</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.324877</td>
      <td>0.000141</td>
      <td>1.449088</td>
      <td>0.184037</td>
      <td>MULTIPOLYGON (((1134517.198 1407050.505, 11345...</td>
      <td>545876.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1031</th>
      <td>545878</td>
      <td>NRCS-545878</td>
      <td>NRCS</td>
      <td>2.282599e-12</td>
      <td>0.364041</td>
      <td>0.000125</td>
      <td>1.416495</td>
      <td>0.196924</td>
      <td>MULTIPOLYGON (((1129854.195 1404493.006, 11299...</td>
      <td>545878.0</td>
      <td>1.85</td>
    </tr>
    <tr>
      <th>1032</th>
      <td>545882</td>
      <td>NRCS-545882</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.280000</td>
      <td>0.000091</td>
      <td>1.439689</td>
      <td>0.184498</td>
      <td>POLYGON ((1133621.697 1408540.806, 1133603.497...</td>
      <td>545882.0</td>
      <td>2.03</td>
    </tr>
    <tr>
      <th>1033</th>
      <td>545885</td>
      <td>NRCS-545885</td>
      <td>NRCS</td>
      <td>2.800000e-12</td>
      <td>0.326502</td>
      <td>0.000183</td>
      <td>1.574297</td>
      <td>0.165660</td>
      <td>MULTIPOLYGON (((1130139.195 1406476.107, 11301...</td>
      <td>545885.0</td>
      <td>2.03</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extrude</span>
<span class="n">m3</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">Mesh3D</span><span class="o">.</span><span class="n">extruded_Mesh2D</span><span class="p">(</span><span class="n">m2</span><span class="p">,</span> <span class="n">layer_types</span><span class="p">,</span> <span class="n">layer_data</span><span class="p">,</span> 
                                             <span class="n">layer_ncells</span><span class="p">,</span> <span class="n">layer_mat_ids</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;2D labeled sets&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m2</span><span class="o">.</span><span class="n">labeled_sets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">ent_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> : &quot;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Extruded 3D labeled sets&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;------------------------&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m3</span><span class="o">.</span><span class="n">labeled_sets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s1"> : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">ent_ids</span><span class="p">)</span><span class="si">}</span><span class="s1"> : &quot;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Extruded 3D side sets&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;---------------------&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m3</span><span class="o">.</span><span class="n">side_sets</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="si">}</span><span class="s1"> : FACE : </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ls</span><span class="o">.</span><span class="n">cell_list</span><span class="p">)</span><span class="si">}</span><span class="s1"> : &quot;</span><span class="si">{</span><span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2D labeled sets
---------------
10000 : CELL : 2683 : &quot;0&quot;
10001 : CELL : 2683 : &quot;0 surface&quot;
10002 : FACE : 76 : &quot;0 boundary&quot;
10003 : FACE : 5 : &quot;0 outlet&quot;
10004 : FACE : 5 : &quot;surface domain outlet&quot;
10005 : CELL : 190 : &quot;river corridor 0 surface&quot;
10006 : CELL : 16 : &quot;stream order 3&quot;
10007 : CELL : 48 : &quot;stream order 2&quot;
10008 : CELL : 126 : &quot;stream order 1&quot;
21 : CELL : 104 : &quot;Developed, Open Space&quot;
22 : CELL : 5 : &quot;Developed, Low Intensity&quot;
23 : CELL : 1 : &quot;Developed, Medium Intensity&quot;
41 : CELL : 1393 : &quot;Deciduous Forest&quot;
42 : CELL : 43 : &quot;Evergreen Forest&quot;
43 : CELL : 1133 : &quot;Mixed Forest&quot;
81 : CELL : 4 : &quot;Pasture/Hay&quot;

Extruded 3D labeled sets
------------------------
10000 : CELL : 40245 : &quot;0&quot;

Extruded 3D side sets
---------------------
1 : FACE : 2683 : &quot;bottom&quot;
2 : FACE : 2683 : &quot;surface&quot;
3 : FACE : 1140 : &quot;external sides&quot;
10001 : FACE : 2683 : &quot;0 surface&quot;
10002 : FACE : 1140 : &quot;0 boundary&quot;
10003 : FACE : 75 : &quot;0 outlet&quot;
10004 : FACE : 75 : &quot;surface domain outlet&quot;
10005 : FACE : 190 : &quot;river corridor 0 surface&quot;
10006 : FACE : 16 : &quot;stream order 3&quot;
10007 : FACE : 48 : &quot;stream order 2&quot;
10008 : FACE : 126 : &quot;stream order 1&quot;
21 : FACE : 104 : &quot;Developed, Open Space&quot;
22 : FACE : 5 : &quot;Developed, Low Intensity&quot;
23 : FACE : 1 : &quot;Developed, Medium Intensity&quot;
41 : FACE : 1393 : &quot;Deciduous Forest&quot;
42 : FACE : 43 : &quot;Evergreen Forest&quot;
43 : FACE : 1133 : &quot;Mixed Forest&quot;
81 : FACE : 4 : &quot;Pasture/Hay&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save the mesh to disk</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.exo&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">])</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="n">m3</span><span class="o">.</span><span class="n">writeExodus</span><span class="p">(</span><span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You are using exodus.py v 1.20.10 (seacas-py3), a python wrapper of some of the exodus library.

Copyright (c) 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021 National Technology &amp;
Engineering Solutions of Sandia, LLC (NTESS).  Under the terms of
Contract DE-NA0003525 with NTESS, the U.S. Government retains certain
rights in this software.

Opening exodus file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta.exo
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:53,697 - root - INFO: adding side set: 1
2025-08-29 17:27:53,703 - root - INFO: adding side set: 2
2025-08-29 17:27:53,706 - root - INFO: adding side set: 3
2025-08-29 17:27:53,708 - root - INFO: adding side set: 10001
2025-08-29 17:27:53,710 - root - INFO: adding side set: 10002
2025-08-29 17:27:53,712 - root - INFO: adding side set: 10003
2025-08-29 17:27:53,713 - root - INFO: adding side set: 10004
2025-08-29 17:27:53,714 - root - INFO: adding side set: 10005
2025-08-29 17:27:53,715 - root - INFO: adding side set: 10006
2025-08-29 17:27:53,716 - root - INFO: adding side set: 10007
2025-08-29 17:27:53,718 - root - INFO: adding side set: 10008
2025-08-29 17:27:53,719 - root - INFO: adding side set: 21
2025-08-29 17:27:53,720 - root - INFO: adding side set: 22
2025-08-29 17:27:53,721 - root - INFO: adding side set: 23
2025-08-29 17:27:53,722 - root - INFO: adding side set: 41
2025-08-29 17:27:53,724 - root - INFO: adding side set: 42
2025-08-29 17:27:53,725 - root - INFO: adding side set: 43
2025-08-29 17:27:53,727 - root - INFO: adding side set: 81
2025-08-29 17:27:53,728 - root - WARNING: not writing elem_set: 10000 because this exodus installation does not write element sets
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Closing exodus file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta.exo
</pre></div>
</div>
</div>
</div>
</section>
<section id="meteorological-forcing-dataset">
<h2>Meteorological forcing dataset<a class="headerlink" href="#meteorological-forcing-dataset" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download the data -- note it is hourly!</span>
<span class="n">met_data_raw</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;meteorology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getDataset</span><span class="p">(</span><span class="n">watershed</span><span class="o">.</span><span class="n">exterior</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="n">start_leap</span><span class="p">,</span> <span class="n">end_leap</span><span class="p">)</span>

<span class="c1"># convert it to daily mean immediately</span>
<span class="n">met_data_raw_daily</span> <span class="o">=</span> <span class="n">met_data_raw</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># also, note that we sampled from 8/1 to 8/1, meaning we have an extra day now.</span>
<span class="n">met_data_raw_daily</span> <span class="o">=</span> <span class="n">met_data_raw_daily</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="s1">&#39;time&#39;</span> <span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)})</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Total days: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">met_data_raw_daily</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:27:53,758 - root - INFO: Incoming shape area = 0.0016040429015210392
2025-08-29 17:27:53,758 - root - INFO: ... buffering incoming shape by = 0.00833333
2025-08-29 17:27:53,759 - root - INFO: ... buffered shape area = 0.0031753726729616284
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variable size: 99.0 TB
&lt;xarray.Dataset&gt; Size: 99TB
Dimensions:              (time: 43824, latitude: 4201, longitude: 8401)
Coordinates:
  * latitude             (latitude) float64 34kB 20.0 20.01 20.02 ... 54.99 55.0
  * longitude            (longitude) float64 67kB -130.0 -130.0 ... -60.01 -60.0
  * time                 (time) datetime64[ns] 351kB 2010-01-01 ... 2014-12-3...
Data variables:
    APCP_surface         (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    DLWRF_surface        (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    DSWRF_surface        (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    PRES_surface         (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    SPFH_2maboveground   (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    TMP_2maboveground    (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    UGRD_10maboveground  (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
    VGRD_10maboveground  (time, latitude, longitude) float64 12TB dask.array&lt;chunksize=(144, 128, 256), meta=np.ndarray&gt;
Subsetting:
  lon: (np.float64(-83.4863), np.float64(-83.4138))
  lat: (np.float64(35.0197), np.float64(35.0821))
Variable size: 0.177 GB
Total days: 1461
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># AORC is a non-projected dataset in lat-lon</span>
<span class="c1"># warp it to projected</span>
<span class="n">met_data_warped</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">warp</span><span class="o">.</span><span class="n">dataset</span><span class="p">(</span><span class="n">met_data_raw_daily</span><span class="p">,</span> <span class="n">crs</span><span class="p">,</span> <span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>

<span class="c1"># convert and write ATS format for transient run</span>
<span class="n">met_data_transient</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">meteorology</span><span class="o">.</span><span class="n">convertAORCToATS</span><span class="p">(</span><span class="n">met_data_warped</span><span class="p">)</span>
<span class="n">met_data_transient</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:54,371 - root - INFO: Converting AORC to ATS met input
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 8MB
Dimensions:                                (x: 9, y: 9, time: 1461)
Coordinates:
  * x                                      (x) float64 72B 1.128e+06 ... 1.13...
  * y                                      (y) float64 72B 1.41e+06 ... 1.404...
  * time                                   (time) object 12kB 2010-08-01 00:0...
    spatial_ref                            int64 8B 0
Data variables:
    air temperature [K]                    (time, y, x) float64 947kB nan ......
    incoming shortwave radiation [W m^-2]  (time, y, x) float64 947kB nan ......
    incoming longwave radiation [W m^-2]   (time, y, x) float64 947kB nan ......
    vapor pressure air [Pa]                (time, y, x) float64 947kB nan ......
    wind speed [m s^-1]                    (time, y, x) float64 947kB nan ......
    precipitation total [m s^-1]           (time, y, x) float64 947kB nan ......
    precipitation rain [m s^-1]            (time, y, x) float64 947kB 0.0 ......
    precipitation snow [m SWE s^-1]        (time, y, x) float64 947kB 0.0 ......
Attributes:
    name:                             AORC v1.1
    source:                           NOAA AWS S3 Zarr
    wind speed reference height [m]:  10.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d458b577-5a58-4af4-a83c-78df426ef790' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d458b577-5a58-4af4-a83c-78df426ef790' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>x</span>: 9</li><li><span class='xr-has-index'>y</span>: 9</li><li><span class='xr-has-index'>time</span>: 1461</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-61d8b13f-1aca-4259-913f-6e2618e7d433' class='xr-section-summary-in' type='checkbox'  checked><label for='section-61d8b13f-1aca-4259-913f-6e2618e7d433' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.128e+06 1.129e+06 ... 1.135e+06</div><input id='attrs-7f92fdfd-32a8-4a46-8a6d-7eb087f147f2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7f92fdfd-32a8-4a46-8a6d-7eb087f147f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5af4c99-baeb-44a8-ac8b-962cb38b3f76' class='xr-var-data-in' type='checkbox'><label for='data-c5af4c99-baeb-44a8-ac8b-962cb38b3f76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1128418.497769, 1129244.157954, 1130069.818139, 1130895.478324,
       1131721.138509, 1132546.798694, 1133372.458879, 1134198.119063,
       1135023.779248])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.41e+06 1.41e+06 ... 1.404e+06</div><input id='attrs-d5478035-cae1-4b74-b95f-ca57deccbc13' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d5478035-cae1-4b74-b95f-ca57deccbc13' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7015ef61-81fa-40df-99e5-0a4010f3c722' class='xr-var-data-in' type='checkbox'><label for='data-7015ef61-81fa-40df-99e5-0a4010f3c722' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1410426.807656, 1409601.147471, 1408775.487286, 1407949.827101,
       1407124.166916, 1406298.506731, 1405472.846546, 1404647.186362,
       1403821.526177])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>2010-08-01 00:00:00 ... 2014-07-...</div><input id='attrs-986af247-ef1c-4c91-81b4-41cc821b017d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-986af247-ef1c-4c91-81b4-41cc821b017d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ffdeef2-5296-49fa-83e2-ece5170d6a59' class='xr-var-data-in' type='checkbox'><label for='data-4ffdeef2-5296-49fa-83e2-ece5170d6a59' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeGregorian(2010, 8, 1, 0, 0, 0, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2010, 8, 2, 0, 0, 0, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2010, 8, 3, 0, 0, 0, 0, has_year_zero=False),
       ...,
       cftime.DatetimeGregorian(2014, 7, 29, 0, 0, 0, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2014, 7, 30, 0, 0, 0, 0, has_year_zero=False),
       cftime.DatetimeGregorian(2014, 7, 31, 0, 0, 0, 0, has_year_zero=False)],
      shape=(1461,), dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-918fc537-080a-4335-9aa3-95f2e1dc598c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-918fc537-080a-4335-9aa3-95f2e1dc598c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6bb257e0-587b-4047-98c4-21ad62713ee2' class='xr-var-data-in' type='checkbox'><label for='data-6bb257e0-587b-4047-98c4-21ad62713ee2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>PROJCS[&quot;NAD83 / Conus Albers&quot;,GEOGCS[&quot;NAD83&quot;,DATUM[&quot;North_American_Datum_1983&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],PROJECTION[&quot;Albers_Conic_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,23],PARAMETER[&quot;longitude_of_center&quot;,-96],PARAMETER[&quot;standard_parallel_1&quot;,29.5],PARAMETER[&quot;standard_parallel_2&quot;,45.5],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;5070&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314140356</dd><dt><span>inverse_flattening :</span></dt><dd>298.257222101</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>GRS 1980</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>NAD83</dd><dt><span>horizontal_datum_name :</span></dt><dd>North American Datum 1983</dd><dt><span>projected_crs_name :</span></dt><dd>NAD83 / Conus Albers</dd><dt><span>grid_mapping_name :</span></dt><dd>albers_conical_equal_area</dd><dt><span>standard_parallel :</span></dt><dd>(29.5, 45.5)</dd><dt><span>latitude_of_projection_origin :</span></dt><dd>23.0</dd><dt><span>longitude_of_central_meridian :</span></dt><dd>-96.0</dd><dt><span>false_easting :</span></dt><dd>0.0</dd><dt><span>false_northing :</span></dt><dd>0.0</dd><dt><span>spatial_ref :</span></dt><dd>PROJCS[&quot;NAD83 / Conus Albers&quot;,GEOGCS[&quot;NAD83&quot;,DATUM[&quot;North_American_Datum_1983&quot;,SPHEROID[&quot;GRS 1980&quot;,6378137,298.257222101]],PRIMEM[&quot;Greenwich&quot;,0],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;4269&quot;]],PROJECTION[&quot;Albers_Conic_Equal_Area&quot;],PARAMETER[&quot;latitude_of_center&quot;,23],PARAMETER[&quot;longitude_of_center&quot;,-96],PARAMETER[&quot;standard_parallel_1&quot;,29.5],PARAMETER[&quot;standard_parallel_2&quot;,45.5],PARAMETER[&quot;false_easting&quot;,0],PARAMETER[&quot;false_northing&quot;,0],UNIT[&quot;metre&quot;,1],AXIS[&quot;Easting&quot;,EAST],AXIS[&quot;Northing&quot;,NORTH],AUTHORITY[&quot;EPSG&quot;,&quot;5070&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>1128005.667676891 825.660184871774 0.0 1410839.6377481048 0.0 -825.660184871774</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-41ee5793-563a-4785-adc8-e243f50128f4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-41ee5793-563a-4785-adc8-e243f50128f4' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>air temperature [K]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-9bf02f28-afac-4c70-837e-b800413444b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9bf02f28-afac-4c70-837e-b800413444b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6609162d-af52-4c09-9d11-ef9ae2bdda11' class='xr-var-data-in' type='checkbox'><label for='data-6609162d-af52-4c09-9d11-ef9ae2bdda11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>AORC_Contact :</span></dt><dd>aorc.info@noaa.gov</dd><dt><span>aorc_version :</span></dt><dd>v1.1</dd><dt><span>level :</span></dt><dd>2 m above ground</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>short_name :</span></dt><dd>TMP_2maboveground</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>_FillValue :</span></dt><dd>nan</dd></dl></div><div class='xr-var-data'><pre>array([[[         nan,          nan,          nan, ..., 297.01970602,
         297.0831444 ,          nan],
        [295.94167108, 296.50383577, 296.12757939, ..., 296.75440842,
         297.13096262,          nan],
        [295.3993245 , 295.17070276, 295.83463549, ..., 296.62607068,
         296.95954862,          nan],
        ...,
        [         nan, 293.91887459, 294.6997662 , ..., 296.17648866,
         296.60396676, 296.42512912],
        [         nan, 294.05006792, 294.2927717 , ..., 295.89321231,
         296.46002704, 296.43080388],
        [         nan, 294.17285241, 294.52497602, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 297.92507297,
         297.97930708,          nan],
        [296.81250442, 297.37509095, 297.01270883, ..., 297.63772619,
         298.00608661,          nan],
        [296.25676657, 296.02620153, 296.69660671, ..., 297.48434224,
         297.80712355,          nan],
...
        [         nan, 287.0376977 , 287.8770312 , ..., 289.34518982,
         289.78373057, 289.53893142],
        [         nan, 287.15714635, 287.4767115 , ..., 289.10286409,
         289.64857275, 289.58986738],
        [         nan, 287.30639983, 287.71147867, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 290.98997339,
         291.05014031,          nan],
        [289.73750432, 290.24775584, 290.01553283, ..., 290.72499923,
         291.11652513,          nan],
        [289.27550538, 289.0710378 , 289.77788131, ..., 290.63232527,
         290.99474335,          nan],
        ...,
        [         nan, 287.85807709, 288.72918943, ..., 290.29459454,
         290.75829004, 290.50991846],
        [         nan, 287.97882898, 288.3217372 , ..., 290.03885199,
         290.59258422, 290.5449361 ],
        [         nan, 288.11993063, 288.54800749, ...,          nan,
                  nan,          nan]]], shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>incoming shortwave radiation [W m^-2]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-0da34de3-bfe1-4c6f-bdfd-d713b52364b7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0da34de3-bfe1-4c6f-bdfd-d713b52364b7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3430c7e8-7c71-49f9-bcb2-1e5b1575eb88' class='xr-var-data-in' type='checkbox'><label for='data-3430c7e8-7c71-49f9-bcb2-1e5b1575eb88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>AORC_Contact :</span></dt><dd>aorc.info@noaa.gov</dd><dt><span>aorc_version :</span></dt><dd>v1.1</dd><dt><span>level :</span></dt><dd>surface</dd><dt><span>long_name :</span></dt><dd>Downward Short-Wave Rad. Flux</dd><dt><span>short_name :</span></dt><dd>DSWRF_surface</dd><dt><span>units :</span></dt><dd>W/m^2</dd><dt><span>_FillValue :</span></dt><dd>nan</dd></dl></div><div class='xr-var-data'><pre>array([[[         nan,          nan,          nan, ..., 203.52746326,
         203.86074155,          nan],
        [204.06250304, 203.86826562, 203.68504513, ..., 203.31827451,
         203.61590489,          nan],
        [203.90850339, 203.71363413, 203.54872553, ..., 203.3414665 ,
         203.70412531,          nan],
        ...,
        [         nan, 206.03030674, 205.91967235, ..., 205.56998821,
         205.75537814, 206.01362247],
        [         nan, 206.72910622, 206.61150919, ..., 206.21121133,
         206.34217607, 206.49227094],
        [         nan, 207.30743617, 207.07533473, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 294.57232092,
         294.54649641,          nan],
        [294.79583773, 294.79915689, 294.80084348, ..., 295.00279934,
         295.0825577 ,          nan],
        [295.17079339, 295.21364268, 295.24853735, ..., 295.42256857,
         295.46954324,          nan],
...
        [         nan, 305.72575035, 305.88691164, ..., 306.59186525,
         306.74627204, 306.94998082],
        [         nan, 306.39225118, 306.56833944, ..., 307.33693987,
         307.53384425, 307.65713503],
        [         nan, 306.90176494, 307.00762253, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 168.5108049 ,
         168.57401449,          nan],
        [168.40000251, 168.39612332, 168.35002198, ..., 168.32019285,
         168.3754381 ,          nan],
        [168.04178594, 168.05101374, 168.02684926, ..., 168.31296011,
         168.44778063,          nan],
        ...,
        [         nan, 169.09907391, 169.25455434, ..., 169.88349718,
         170.08588322, 170.2748666 ],
        [         nan, 169.44417723, 169.61043638, ..., 170.33390695,
         170.50220417, 170.63973606],
        [         nan, 169.71061163, 169.82735471, ...,          nan,
                  nan,          nan]]], shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>incoming longwave radiation [W m^-2]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-4a5f2412-1851-4a48-a341-0141d83392f4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a5f2412-1851-4a48-a341-0141d83392f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25124f2f-ae89-4192-b148-7622cb80cb24' class='xr-var-data-in' type='checkbox'><label for='data-25124f2f-ae89-4192-b148-7622cb80cb24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>AORC_Contact :</span></dt><dd>aorc.info@noaa.gov</dd><dt><span>aorc_version :</span></dt><dd>v1.1</dd><dt><span>level :</span></dt><dd>surface</dd><dt><span>long_name :</span></dt><dd>Downward Long-Wave Rad. Flux</dd><dt><span>short_name :</span></dt><dd>DLWRF_surface</dd><dt><span>units :</span></dt><dd>W/m^2</dd><dt><span>_FillValue :</span></dt><dd>nan</dd></dl></div><div class='xr-var-data'><pre>array([[[         nan,          nan,          nan, ..., 403.91186279,
         404.13659658,          nan],
        [396.95833925, 400.2139669 , 398.38920439, ..., 402.37578494,
         404.29503098,          nan],
        [393.96204179, 392.86595127, 396.61381013, ..., 401.56040359,
         403.24434445,          nan],
        ...,
        [         nan, 386.04885264, 390.37865388, ..., 398.90571749,
         401.17959133, 400.13795876],
        [         nan, 386.7008737 , 388.17442333, ..., 397.36704634,
         400.42441987, 400.16620292],
        [         nan, 387.30934631, 389.3662748 , ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 387.16758094,
         387.43593765,          nan],
        [380.25000567, 383.43379579, 381.70913509, ..., 385.46218959,
         387.3078604 ,          nan],
        [377.19679529, 376.19236498, 379.77552811, ..., 384.50237458,
         386.16883827,          nan],
...
        [         nan, 300.89288125, 304.59123151, ..., 311.39500914,
         313.29080793, 312.17583198],
        [         nan, 301.4370305 , 302.93928062, ..., 310.39428359,
         312.7046702 , 312.42895879],
        [         nan, 302.07541265, 303.94528856, ...,          nan,
                  nan,          nan]],

       [[         nan,          nan,          nan, ..., 353.59011138,
         353.77395986,          nan],
        [346.81667183, 349.45212651, 348.51813444, ..., 352.34645085,
         354.11383733,          nan],
        [344.64058988, 343.83673536, 347.38307767, ..., 351.9988595 ,
         353.63525658,          nan],
        ...,
        [         nan, 338.74493255, 343.0077063 , ..., 351.00469655,
         353.19885434, 351.92287923],
        [         nan, 339.47319297, 341.25894544, ..., 349.95970467,
         352.6262139 , 352.25430341],
        [         nan, 340.25900088, 342.4573533 , ...,          nan,
                  nan,          nan]]], shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vapor pressure air [Pa]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-23bdd7b5-a4cf-48bc-aae0-28ebfbe39b90' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-23bdd7b5-a4cf-48bc-aae0-28ebfbe39b90' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ea984a9-0171-4a25-8d2b-2744b08eb7cf' class='xr-var-data-in' type='checkbox'><label for='data-9ea984a9-0171-4a25-8d2b-2744b08eb7cf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[          nan,           nan,           nan, ...,
         2383.56647313, 2392.21191403,           nan],
        [2228.06227752, 2305.21690471, 2255.01544947, ...,
         2344.48374   , 2397.13073188,           nan],
        [2155.31528135, 2125.48297899, 2213.48531904, ...,
         2324.17879345, 2370.58841968,           nan],
        ...,
        [          nan, 1962.61743764, 2059.52294045, ...,
         2253.49246944, 2312.08026839, 2286.99965862],
        [          nan, 1975.92968019, 2007.42458803, ...,
         2213.76949035, 2290.713152  , 2287.83886614],
        [          nan, 1988.9463918 , 2035.19523912, ...,
                   nan,           nan,           nan]],

       [[          nan,           nan,           nan, ...,
         2432.41176182, 2442.20982899,           nan],
        [2274.44754329, 2354.87126044, 2304.00321363, ...,
         2390.50492046, 2443.14943199,           nan],
        [2198.64801891, 2170.64496343, 2259.17911877, ...,
         2366.7309098 , 2414.08624124,           nan],
...
         1366.86152012, 1407.11206242, 1384.33969378],
        [          nan, 1180.25144447, 1206.88108793, ...,
         1342.28853387, 1390.35614315, 1384.52098083],
        [          nan, 1188.35949995, 1222.99881622, ...,
                   nan,           nan,           nan]],

       [[          nan,           nan,           nan, ...,
         1663.32041271, 1669.51629868,           nan],
        [1531.81886695, 1583.53618368, 1563.28112273, ...,
         1635.23361121, 1675.60758824,           nan],
        [1486.59941625, 1470.10931355, 1538.85151089, ...,
         1624.25653258, 1661.21872981,           nan],
        ...,
        [          nan, 1350.44153859, 1428.27749062, ...,
         1579.26780632, 1623.50780988, 1598.56294016],
        [          nan, 1356.55916529, 1388.14903842, ...,
         1550.08950325, 1605.14578782, 1599.30193266],
        [          nan, 1366.33073298, 1406.58004827, ...,
                   nan,           nan,           nan]]],
      shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>wind speed [m s^-1]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-b41202b6-99ec-4f54-89fd-17f6ac476a2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b41202b6-99ec-4f54-89fd-17f6ac476a2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7aa4a4a2-2afc-4f6c-b0be-47c01e808a79' class='xr-var-data-in' type='checkbox'><label for='data-7aa4a4a2-2afc-4f6c-b0be-47c01e808a79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[       nan,        nan,        nan, ..., 1.05893012,
         1.11071307,        nan],
        [0.65643186, 0.72302982, 0.78600843, ..., 1.10649285,
         1.16613771,        nan],
        [0.69773119, 0.74178505, 0.84307802, ..., 1.13556667,
         1.19000492,        nan],
        ...,
        [       nan, 0.68165003, 0.74879887, ..., 1.01555435,
         1.07697703, 1.12847941],
        [       nan, 0.64919813, 0.72246172, ..., 0.98384886,
         1.03992785, 1.09917852],
        [       nan, 0.63128423, 0.70016868, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ..., 3.36503667,
         3.31561373,        nan],
        [3.69944164, 3.63683856, 3.57060462, ..., 3.38488987,
         3.33375772,        nan],
        [3.7061198 , 3.66641764, 3.60114343, ..., 3.40640913,
         3.36443246,        nan],
...
        [       nan, 2.52846967, 2.5489137 , ..., 2.64055117,
         2.66834708, 2.67395977],
        [       nan, 2.52365601, 2.54111745, ..., 2.63557175,
         2.66096904, 2.67464668],
        [       nan, 2.52484635, 2.54233749, ...,        nan,
                nan,        nan]],

       [[       nan,        nan,        nan, ..., 4.24371212,
         4.24256872,        nan],
        [4.12160009, 4.15323329, 4.18100043, ..., 4.27857971,
         4.28868998,        nan],
        [4.15737148, 4.17814111, 4.20425014, ..., 4.30131331,
         4.3076568 ,        nan],
        ...,
        [       nan, 4.12677637, 4.15262553, ..., 4.23555942,
         4.2433231 , 4.25134793],
        [       nan, 4.10142237, 4.12530026, ..., 4.2167949 ,
         4.22311159, 4.23660957],
        [       nan, 4.0769641 , 4.09795033, ...,        nan,
                nan,        nan]]], shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation total [m s^-1]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-bef16693-4717-4932-9e1f-cbb2e2a5831a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bef16693-4717-4932-9e1f-cbb2e2a5831a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d181ca14-e324-4755-b1bc-b19d280eee99' class='xr-var-data-in' type='checkbox'><label for='data-d181ca14-e324-4755-b1bc-b19d280eee99' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[           nan,            nan,            nan, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
        ...,
        [           nan, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [           nan, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [           nan, 0.00000000e+00, 0.00000000e+00, ...,
                    nan,            nan,            nan]],

       [[           nan,            nan,            nan, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
        [2.31481485e-09, 2.26592881e-09, 1.95143953e-09, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
        [1.38486530e-09, 1.24991407e-09, 1.10264560e-09, ...,
         0.00000000e+00, 0.00000000e+00,            nan],
...
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [           nan, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [           nan, 0.00000000e+00, 0.00000000e+00, ...,
                    nan,            nan,            nan]],

       [[           nan,            nan,            nan, ...,
         1.66157041e-08, 1.62037039e-08,            nan],
        [1.85185188e-08, 1.83931397e-08, 1.73325944e-08, ...,
         1.64207587e-08, 1.62037039e-08,            nan],
        [1.85185188e-08, 1.75334400e-08, 1.72643739e-08, ...,
         1.57902312e-08, 1.47693025e-08,            nan],
        ...,
        [           nan, 1.24620074e-08, 1.26202404e-08, ...,
         1.24445291e-08, 1.16910950e-08, 1.15740742e-08],
        [           nan, 1.08579275e-08, 1.05881439e-08, ...,
         1.06206037e-08, 1.12484095e-08, 1.15740742e-08],
        [           nan, 9.25925940e-09, 9.25925940e-09, ...,
                    nan,            nan,            nan]]],
      shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation rain [m s^-1]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-475b2eec-cc47-4b5e-86bf-4ac080b6835a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-475b2eec-cc47-4b5e-86bf-4ac080b6835a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-844204aa-a429-4a28-870f-921b7f71a282' class='xr-var-data-in' type='checkbox'><label for='data-844204aa-a429-4a28-870f-921b7f71a282' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        ...,
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00]],

       [[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [2.31481485e-09, 2.26592881e-09, 1.95143953e-09, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [1.38486530e-09, 1.24991407e-09, 1.10264560e-09, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
...
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00]],

       [[0.00000000e+00, 0.00000000e+00, 0.00000000e+00, ...,
         1.66157041e-08, 1.62037039e-08, 0.00000000e+00],
        [1.85185188e-08, 1.83931397e-08, 1.73325944e-08, ...,
         1.64207587e-08, 1.62037039e-08, 0.00000000e+00],
        [1.85185188e-08, 1.75334400e-08, 1.72643739e-08, ...,
         1.57902312e-08, 1.47693025e-08, 0.00000000e+00],
        ...,
        [0.00000000e+00, 1.24620074e-08, 1.26202404e-08, ...,
         1.24445291e-08, 1.16910950e-08, 1.15740742e-08],
        [0.00000000e+00, 1.08579275e-08, 1.05881439e-08, ...,
         1.06206037e-08, 1.12484095e-08, 1.15740742e-08],
        [0.00000000e+00, 9.25925940e-09, 9.25925940e-09, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00]]],
      shape=(1461, 9, 9))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitation snow [m SWE s^-1]</span></div><div class='xr-var-dims'>(time, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-434f09c7-9be4-408a-be14-9f6b179db492' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-434f09c7-9be4-408a-be14-9f6b179db492' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4d5cc6e9-6d09-44f9-a035-a09e3d7c3ac4' class='xr-var-data-in' type='checkbox'><label for='data-4d5cc6e9-6d09-44f9-a035-a09e3d7c3ac4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
...
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]],

       [[0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        ...,
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.],
        [0., 0., 0., ..., 0., 0., 0.]]], shape=(1461, 9, 9))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cb98e32e-b723-4546-8433-4174fe1e05a8' class='xr-section-summary-in' type='checkbox'  ><label for='section-cb98e32e-b723-4546-8433-4174fe1e05a8' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-39720ebd-9615-4c22-b046-0afe2f41d17d' class='xr-index-data-in' type='checkbox'/><label for='index-39720ebd-9615-4c22-b046-0afe2f41d17d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 1128418.497769327, 1129244.1579541988, 1130069.8181390704,
       1130895.4783239423,  1131721.138508814, 1132546.7986936858,
       1133372.4588785577, 1134198.1190634293, 1135023.7792483012],
      dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c753399a-5666-4275-9035-1bf06e7a4f2b' class='xr-index-data-in' type='checkbox'/><label for='index-c753399a-5666-4275-9035-1bf06e7a4f2b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1410426.8076556688,  1409601.147470797, 1408775.4872859253,
       1407949.8271010534, 1407124.1669161818,   1406298.50673131,
        1405472.846546438, 1404647.1863615664, 1403821.5261766945],
      dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-08818c65-f551-4ee8-b6eb-2654719003be' class='xr-index-data-in' type='checkbox'/><label for='index-08818c65-f551-4ee8-b6eb-2654719003be' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([2010-08-01 00:00:00, 2010-08-02 00:00:00, 2010-08-03 00:00:00,
             2010-08-04 00:00:00, 2010-08-05 00:00:00, 2010-08-06 00:00:00,
             2010-08-07 00:00:00, 2010-08-08 00:00:00, 2010-08-09 00:00:00,
             2010-08-10 00:00:00,
             ...
             2014-07-22 00:00:00, 2014-07-23 00:00:00, 2014-07-24 00:00:00,
             2014-07-25 00:00:00, 2014-07-26 00:00:00, 2014-07-27 00:00:00,
             2014-07-28 00:00:00, 2014-07-29 00:00:00, 2014-07-30 00:00:00,
             2014-07-31 00:00:00],
            dtype=&#x27;object&#x27;, length=1461, calendar=&#x27;standard&#x27;, freq=&#x27;D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3a76ab3d-8cdf-49b7-9eb7-ee2008e0e39c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3a76ab3d-8cdf-49b7-9eb7-ee2008e0e39c' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>name :</span></dt><dd>AORC v1.1</dd><dt><span>source :</span></dt><dd>NOAA AWS S3 Zarr</dd><dt><span>wind speed reference height [m] :</span></dt><dd>10.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot a few of the met data -- does it look reasonable?</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plotMetData</span><span class="p">(</span><span class="n">met</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;plot one pixel as a function of time&quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    
    <span class="n">met_data_single_pixel</span> <span class="o">=</span> <span class="n">met</span><span class="o">.</span><span class="n">isel</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">365</span><span class="p">),</span>
                                               <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                                               <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
    
    <span class="n">met_data_single_pixel</span><span class="p">[</span><span class="s1">&#39;precipitation rain [m s^-1]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;rain&#39;</span><span class="p">)</span>
    <span class="n">met_data_single_pixel</span><span class="p">[</span><span class="s1">&#39;precipitation snow [m SWE s^-1]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;snow&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;precip [m s^-1]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">met_data_single_pixel</span><span class="p">[</span><span class="s1">&#39;incoming shortwave radiation [W m^-2]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;qSW_in&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;incoming shortwave radiation [W m^-2]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">plotMetData</span><span class="p">(</span><span class="n">met_data_transient</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/443c8c0b8255a1607d128ef2fa085ced02a56b78a600ae8e8cba1061ee1c1c95.png" src="../_images/443c8c0b8255a1607d128ef2fa085ced02a56b78a600ae8e8cba1061ee1c1c95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write transient data to disk</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_aorc-</span><span class="si">{</span><span class="n">start</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">end</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s1">.h5&#39;</span><span class="p">)</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;meteorology_transient&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeDatasetToHDF5</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">met_data_transient</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:54,519 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_aorc-2010-2014.h5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the typical year</span>
<span class="c1"># note that we have to do this only on no-leap data to line up the days</span>
<span class="c1">#</span>
<span class="c1"># also, we do this on the original variables and then re-compute ATS quantities</span>
<span class="n">ndays</span> <span class="o">=</span> <span class="n">met_data_warped</span><span class="p">[</span><span class="s1">&#39;APCP_surface&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;nyears = &#39;</span><span class="p">,</span> <span class="n">ndays</span> <span class="o">//</span> <span class="mi">365</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n days leftover = &#39;</span><span class="p">,</span> <span class="n">ndays</span> <span class="o">%</span> <span class="mi">365</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;note, that leftover day(s) are leap day(s).&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nyears =  4
n days leftover =  1
note, that leftover day(s) are leap day(s).
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cannot compute a typical year for leap year -- need to align days-of-the-year</span>
<span class="c1"># remove leap day (Dec 31 of leap years)</span>
<span class="n">met_data_noleap</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">filterLeapDay</span><span class="p">(</span><span class="n">met_data_warped</span><span class="p">)</span>
<span class="n">met_data_noleap</span>

<span class="c1"># then compute a &quot;typical&quot; year</span>
<span class="n">met_data_typical</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">computeAverageYear</span><span class="p">(</span><span class="n">met_data_noleap</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="n">nyears_cyclic_steadystate</span><span class="p">)</span>

<span class="c1"># and lastly convert to ATS</span>
<span class="n">met_data_typical_ats</span> <span class="o">=</span> <span class="n">watershed_workflow</span><span class="o">.</span><span class="n">meteorology</span><span class="o">.</span><span class="n">convertAORCToATS</span><span class="p">(</span><span class="n">met_data_typical</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:55,346 - root - INFO: Converting AORC to ATS met input
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot a few of the met data -- does it look reasonable?</span>
<span class="n">plotMetData</span><span class="p">(</span><span class="n">met_data_typical_ats</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/37bcadefdf70e0c4ecb15b955a9f91943b4a7add8b08389cc0a315bcf88dc735.png" src="../_images/37bcadefdf70e0c4ecb15b955a9f91943b4a7add8b08389cc0a315bcf88dc735.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write cyclic steadystate data to disk</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">toOutput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_daymet-CyclicSteadystate.h5&#39;</span><span class="p">)</span>
<span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;meteorology_cyclic_steadystate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
<span class="n">watershed_workflow</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">writeDatasetToHDF5</span><span class="p">(</span>
    <span class="n">filename</span><span class="p">,</span>
    <span class="n">met_data_typical_ats</span><span class="p">,</span>
    <span class="n">met_data_typical_ats</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:55,464 - root - INFO: Writing HDF5 file: /home/ecoon/code/watershed_workflow/repos/master/examples/Coweeta/output_data/Coweeta_daymet-CyclicSteadystate.h5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the average precip rate for steadystate solution</span>
<span class="n">precip_mean</span> <span class="o">=</span> <span class="p">(</span><span class="n">met_data_transient</span><span class="p">[</span><span class="s1">&#39;precipitation rain [m s^-1]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="o">+</span> <span class="n">met_data_transient</span><span class="p">[</span><span class="s1">&#39;precipitation snow [m SWE s^-1]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mean precip value = </span><span class="si">{</span><span class="n">precip_mean</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:55,976 - root - INFO: Mean precip value = 5.502343508705227e-08
</pre></div>
</div>
</div>
</div>
</section>
<section id="write-ats-input-files">
<h2>Write ATS input files<a class="headerlink" href="#write-ats-input-files" title="Link to this heading">#</a></h2>
<p>Now we have the mesh file written and all of the forcing datasets (meteorology, LAI) written.  It remains to write ATS XML files that will be the runs.</p>
<p>There are three runs done:</p>
<ul class="simple">
<li><p>steadystate: forces a surface + subsurface only problem with constant, uniform precip until true steadystate</p></li>
<li><p>cyclic steadystate: forces with a typical year of averaged data</p></li>
<li><p>transient: runs with real daily data from start to end</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that each of these are defined as functions so we can reuse them for all three input files.</span>

<span class="c1"># add the subsurface and surface domains</span>
<span class="c1">#</span>
<span class="c1"># Note this also adds a &quot;computational domain&quot; region to the region list, and a vis spec </span>
<span class="c1"># for &quot;domain&quot;</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_domains</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">surface_region</span><span class="o">=</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span> <span class="n">snow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">canopy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_domain</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> 
                                 <span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;domain&#39;</span><span class="p">,</span> 
                                 <span class="n">dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
                                 <span class="n">mesh_type</span><span class="o">=</span><span class="s1">&#39;read mesh file&#39;</span><span class="p">,</span>
                                 <span class="n">mesh_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span><span class="n">mesh</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">surface_region</span><span class="p">:</span>
        <span class="n">main_list</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">][</span><span class="s1">&#39;domain&#39;</span><span class="p">][</span><span class="s1">&#39;build columns from set&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">surface_region</span>    
    
        <span class="c1"># Note this also adds a &quot;surface domain&quot; region to the region list and a vis spec for </span>
        <span class="c1"># &quot;surface&quot;</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_domain</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span>
                                <span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span>
                                <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">mesh_type</span><span class="o">=</span><span class="s1">&#39;surface&#39;</span><span class="p">,</span>
                                <span class="n">mesh_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;surface sideset name&#39;</span><span class="p">:</span><span class="s1">&#39;surface&#39;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">snow</span><span class="p">:</span>
        <span class="c1"># Add the snow and canopy domains, which are aliases to the surface</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_domain</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span>
                                <span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;snow&#39;</span><span class="p">,</span>
                                <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">mesh_type</span><span class="o">=</span><span class="s1">&#39;aliased&#39;</span><span class="p">,</span>
                                <span class="n">mesh_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="s1">&#39;surface&#39;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">canopy</span><span class="p">:</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_domain</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span>
                                <span class="n">domain_name</span><span class="o">=</span><span class="s1">&#39;canopy&#39;</span><span class="p">,</span>
                                <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                                <span class="n">mesh_type</span><span class="o">=</span><span class="s1">&#39;aliased&#39;</span><span class="p">,</span>
                                <span class="n">mesh_args</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;target&#39;</span><span class="p">:</span><span class="s1">&#39;surface&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_land_cover</span><span class="p">(</span><span class="n">main_list</span><span class="p">):</span>
    <span class="c1"># next write a land-cover section for each NLCD type</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">nlcd_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nlcd_indices</span><span class="p">,</span> <span class="n">nlcd_labels</span><span class="p">):</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">set_land_cover_default_constants</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">nlcd_name</span><span class="p">)</span>

    <span class="n">land_cover_list</span> <span class="o">=</span> <span class="n">main_list</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">][</span><span class="s1">&#39;model parameters&#39;</span><span class="p">][</span><span class="s1">&#39;land cover types&#39;</span><span class="p">]</span>
    <span class="c1"># update some defaults for</span>
    <span class="c1"># [&#39;Other&#39;, &#39;Deciduous Forest&#39;]</span>
    <span class="c1"># note, these are from the CLM Technical Note v4.5</span>
    <span class="c1">#</span>
    <span class="c1"># Rooting depth curves from CLM TN 4.5 table 8.3</span>
    <span class="c1">#</span>
    <span class="c1"># Note, the mafic potential values are likely pretty bad for the types of van Genuchten </span>
    <span class="c1"># curves we are using (ETC -- add paper citation about this topic).  Likely they need</span>
    <span class="c1"># to be modified.  Note that these values are in [mm] from CLM TN 4.5 table 8.1, so the </span>
    <span class="c1"># factor of 10 converts to [Pa]</span>
    <span class="c1">#</span>
    <span class="c1"># Note, albedo of canopy taken from CLM TN 4.5 table 3.1</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;rooting profile alpha [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;rooting profile beta [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;rooting depth max [m]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;capillary pressure at fully closed stomata [Pa]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">224000</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;capillary pressure at fully open stomata [Pa]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35000</span> <span class="o">*</span> <span class="mf">.10</span>
    <span class="n">land_cover_list</span><span class="p">[</span><span class="s1">&#39;Deciduous Forest&#39;</span><span class="p">][</span><span class="s1">&#39;albedo of canopy [-]&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add soil sets: note we need a way to name the set, so we use, e.g. SSURGO-MUKEY.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">soil_set_name</span><span class="p">(</span><span class="n">ats_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">subsurface_props_used</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ats_id</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">add_soil_properties</span><span class="p">(</span><span class="n">main_list</span><span class="p">):</span>
    <span class="c1"># add soil material ID regions, porosity, permeability, and WRMs</span>
    <span class="k">for</span> <span class="n">ats_id</span> <span class="ow">in</span> <span class="n">subsurface_props_used</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">subsurface_props_used</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ats_id</span><span class="p">]</span>
        <span class="n">set_name</span> <span class="o">=</span> <span class="n">soil_set_name</span><span class="p">(</span><span class="n">ats_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">props</span><span class="p">[</span><span class="s1">&#39;van Genuchten n [-]&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
            <span class="n">smoothing_interval</span> <span class="o">=</span> <span class="mf">0.01</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">smoothing_interval</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_soil_type</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">set_name</span><span class="p">,</span> <span class="n">ats_id</span><span class="p">,</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">],</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;porosity [-]&#39;</span><span class="p">]),</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;permeability [m^2]&#39;</span><span class="p">]),</span> <span class="mf">1.e-7</span><span class="p">,</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;van Genuchten alpha [Pa^-1]&#39;</span><span class="p">]),</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;van Genuchten n [-]&#39;</span><span class="p">]),</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;residual saturation [-]&#39;</span><span class="p">]),</span>
                                            <span class="nb">float</span><span class="p">(</span><span class="n">smoothing_interval</span><span class="p">))</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get an ATS &quot;main&quot; input spec list -- note, this is a dummy and is not used to write any files yet</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_main</span><span class="p">(</span><span class="n">steadystate</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">main_list</span> <span class="o">=</span> <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">get_main</span><span class="p">()</span>

    <span class="c1"># add the mesh and all domains</span>
    <span class="n">mesh</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;mesh&#39;</span><span class="p">])</span>
    <span class="n">add_domains</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">mesh</span><span class="p">)</span>

    <span class="c1"># add labeled sets</span>
    <span class="k">for</span> <span class="n">ls</span> <span class="ow">in</span> <span class="n">m3</span><span class="o">.</span><span class="n">labeled_sets</span><span class="p">:</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_region_labeled_set</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">setid</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">ls</span><span class="o">.</span><span class="n">entity</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ss</span> <span class="ow">in</span> <span class="n">m3</span><span class="o">.</span><span class="n">side_sets</span><span class="p">:</span>
        <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_region_labeled_set</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ss</span><span class="o">.</span><span class="n">setid</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;FACE&#39;</span><span class="p">)</span>
    
    <span class="c1"># add land cover</span>
    <span class="n">add_land_cover</span><span class="p">(</span><span class="n">main_list</span><span class="p">)</span>

    <span class="c1"># add soil properties</span>
    <span class="n">add_soil_properties</span><span class="p">(</span><span class="n">main_list</span><span class="p">)</span>
        
    <span class="c1"># add observations for each subcatchment</span>
    <span class="k">if</span> <span class="n">steadystate</span><span class="p">:</span>
        <span class="n">time_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;cycles start period stop&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">time_args</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_observations_water_balance</span><span class="p">(</span><span class="n">main_list</span><span class="p">,</span> <span class="s2">&quot;computational domain&quot;</span><span class="p">,</span> 
                                                        <span class="s2">&quot;surface domain&quot;</span><span class="p">,</span> <span class="s2">&quot;external sides&quot;</span><span class="p">,</span>
                                                        <span class="n">time_args</span><span class="o">=</span><span class="n">time_args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">main_list</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">populate_basic_properties</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">main_xml</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function updates an xml object with the above properties for mesh, regions, soil props, and lc props&quot;&quot;&quot;</span>
    <span class="c1"># find and replace the mesh list</span>
    <span class="n">xml</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span> <span class="n">asearch</span><span class="o">.</span><span class="n">child_by_name</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="s1">&#39;mesh&#39;</span><span class="p">))</span>

    <span class="c1"># find and replace the regions list</span>
    <span class="n">xml</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;regions&#39;</span><span class="p">,</span> <span class="n">asearch</span><span class="o">.</span><span class="n">child_by_name</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="s1">&#39;regions&#39;</span><span class="p">))</span>

    <span class="c1"># update the observations list</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">el</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span> <span class="k">if</span> <span class="n">el</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;observations&#39;</span><span class="p">)</span>
    <span class="n">xml</span><span class="p">[</span><span class="n">obs</span><span class="p">]</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">child_by_name</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="s1">&#39;observations&#39;</span><span class="p">)</span>

    <span class="c1"># update all model parameters lists</span>
    <span class="n">xml_parlist</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;model parameters&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">parlist</span> <span class="ow">in</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;model parameters&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xml_parlist</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parlist</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">parlist</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">aerrors</span><span class="o">.</span><span class="n">MissingXMLError</span><span class="p">:</span>
            <span class="n">xml_parlist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parlist</span><span class="p">)</span>

    <span class="c1"># update all evaluator lists</span>
    <span class="n">xml_elist</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;evaluators&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">elist</span> <span class="ow">in</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;evaluators&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xml_elist</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">elist</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span> <span class="n">elist</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">aerrors</span><span class="o">.</span><span class="n">MissingXMLError</span><span class="p">:</span>
            <span class="n">xml_elist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elist</span><span class="p">)</span>    
    
    <span class="c1"># find and replace land cover</span>
    <span class="n">mp_list</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;model parameters&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">lc_list</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">main_xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;model parameters&#39;</span><span class="p">,</span> <span class="s1">&#39;land cover types&#39;</span><span class="p">],</span> <span class="n">no_skip</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mp_list</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;land cover types&#39;</span><span class="p">,</span> <span class="n">lc_list</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">aerrors</span><span class="o">.</span><span class="n">MissingXMLError</span><span class="p">:</span>
        <span class="n">mp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lc_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the first file, we load a spinup template and write the needed quantities into that file, saving it to the appropriate run directory.  Note there is no DayMet or land cover or LAI properties needed for this run.  The only property that is needed is the domain-averaged, mean annual rainfall rate.  We then take off some for ET (note too wet spins up faster than too dry, so don’t take off too much…).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">write_spinup_steadystate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">precip_mean</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># create the main list</span>
    <span class="n">main</span> <span class="o">=</span> <span class="n">get_main</span><span class="p">()</span>

    <span class="c1"># set precip to 0.6 * the mean precip value</span>
    <span class="n">precip</span> <span class="o">=</span> <span class="n">main</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">][</span><span class="s1">&#39;evaluators&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append_empty</span><span class="p">(</span><span class="s1">&#39;surface-precipitation&#39;</span><span class="p">)</span>
    <span class="n">precip</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="s1">&#39;independent variable constant&#39;</span><span class="p">,</span> <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">known_specs</span><span class="p">[</span><span class="s1">&#39;evaluator-independent-variable-constant-spec&#39;</span><span class="p">])</span>
    <span class="n">precip</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">precip_mean</span> <span class="o">*</span> <span class="mf">.6</span><span class="p">)</span>

    
    <span class="c1"># load the template file</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;steadystate&#39;</span>
    <span class="n">xml</span> <span class="o">=</span> <span class="n">aio</span><span class="o">.</span><span class="n">fromFile</span><span class="p">(</span><span class="n">toInput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">-template.xml&#39;</span><span class="p">))</span>
    
    <span class="c1"># update the template xml with the main xml generated here</span>
    <span class="n">main_xml</span> <span class="o">=</span> <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
    <span class="n">populate_basic_properties</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">main_xml</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># write to disk</span>
    <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_xml_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toWorkingDir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">.xml&#39;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_xml_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">aio</span><span class="o">.</span><span class="n">toFile</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

    <span class="c1"># create a run directory</span>
    <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_rundir_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toWorkingDir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">rundir</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_rundir_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">rundir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For the second file, we load a transient run template.  This file needs the basics, plus DayMet and LAI as the “typical year data”.  Also we set the run directory that will be used for the steadystate run.</p>
<p>For the third file, we load a transient run template as well.  This file needs the basics, DayMet with the actual data, and we choose for this run to use the MODIS typical year.  MODIS is only available for 2002 on, so if we didn’t need 1980-2002 we could use the real data, but for this run we want a longer record.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">write_transient</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">cyclic_steadystate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># make a unique name based on options</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Writing transient: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cyclic_steadystate</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;cyclic_steadystate&#39;</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="s1">&#39;steadystate&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;transient&#39;</span>
        <span class="n">previous</span> <span class="o">=</span> <span class="s1">&#39;cyclic_steadystate&#39;</span>

    <span class="n">main</span> <span class="o">=</span> <span class="n">get_main</span><span class="p">()</span>

    <span class="c1"># add the DayMet evaluators</span>
    <span class="k">if</span> <span class="n">cyclic_steadystate</span><span class="p">:</span>
        <span class="n">daymet_filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;meteorology_cyclic_steadystate&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">daymet_filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;meteorology_transient&#39;</span><span class="p">]</span>
    <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_daymet_box_evaluators</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">daymet_filename</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>

    <span class="c1"># add the LAI filenames</span>
    <span class="k">if</span> <span class="n">cyclic_steadystate</span><span class="p">:</span>
        <span class="n">lai_filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_cyclic_steadystate&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lai_filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="s1">&#39;nlcd_lai_transient&#39;</span><span class="p">]</span>
    <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">add_lai_point_evaluators</span><span class="p">(</span><span class="n">main</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">lai_filename</span><span class="p">),</span> <span class="nb">list</span><span class="p">(</span><span class="n">nlcd_labels_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
    
    <span class="c1"># load the template file</span>
    <span class="n">template_filename</span> <span class="o">=</span> <span class="n">toInput</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">-template.xml&#39;</span><span class="p">)</span>
    <span class="n">xml</span> <span class="o">=</span> <span class="n">aio</span><span class="o">.</span><span class="n">fromFile</span><span class="p">(</span><span class="n">template_filename</span><span class="p">)</span>

    <span class="c1"># update the template xml with the main xml generated here</span>
    <span class="n">main_xml</span> <span class="o">=</span> <span class="n">ats_input_spec</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">main</span><span class="p">)</span>
    <span class="n">populate_basic_properties</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">main_xml</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
    <span class="c1"># update the start and end time -- would be nice to set these in main, but it would be </span>
    <span class="c1"># confusing as to when to copy them in populate_basic_properties and when not to do so.</span>
    <span class="n">start_day</span> <span class="o">=</span> <span class="mi">274</span>
    <span class="k">if</span> <span class="n">cyclic_steadystate</span><span class="p">:</span>
        <span class="n">end_day</span> <span class="o">=</span> <span class="mi">274</span> <span class="o">+</span> <span class="p">(</span><span class="n">nyears_cyclic_steadystate</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">365</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="n">end_day</span> <span class="o">=</span> <span class="mi">274</span> <span class="o">+</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">days</span> 
        
    <span class="n">par</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cycle driver&#39;</span><span class="p">,</span> <span class="s1">&#39;start time&#39;</span><span class="p">])</span>
    <span class="n">par</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">start_day</span><span class="p">)</span>

    <span class="n">par</span> <span class="o">=</span> <span class="n">asearch</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;cycle driver&#39;</span><span class="p">,</span> <span class="s1">&#39;end time&#39;</span><span class="p">])</span>
    <span class="n">par</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">end_day</span><span class="p">)</span>
    
    <span class="c1"># update the restart filenames</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">asearch</span><span class="o">.</span><span class="n">findall_path</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;initial conditions&#39;</span><span class="p">,</span> <span class="s1">&#39;restart file&#39;</span><span class="p">]):</span>
        <span class="n">var</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_rundir_</span><span class="si">{</span><span class="n">previous</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="s1">&#39;checkpoint_final.h5&#39;</span><span class="p">))</span>
   
    <span class="c1"># write to disk and make a directory for running the run</span>
    <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_xml_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toWorkingDir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">.xml&#39;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_xml_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

    <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_rundir_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">toWorkingDir</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">rundir</span> <span class="o">=</span> <span class="n">output_filenames</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ats_rundir_</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

    <span class="n">aio</span><span class="o">.</span><span class="n">toFile</span><span class="p">(</span><span class="n">xml</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">rundir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">write_spinup_steadystate</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">precip_mean</span><span class="p">)</span>
<span class="n">write_transient</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">write_transient</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/ecoon/code/ats/ats_input_spec/repos/master/ats_input_spec/io.py:43: UserWarning: Creating an incomplete XML object, missing entries!
  warnings.warn(&#39;Creating an incomplete XML object, missing entries!&#39;)
2025-08-29 17:34:56,105 - root - INFO: Writing transient: Coweeta
2025-08-29 17:34:56,123 - root - INFO: Writing transient: Coweeta
</pre></div>
</div>
</div>
</div>
</section>
<section id="completion-and-summary">
<h2>Completion and Summary<a class="headerlink" href="#completion-and-summary" title="Link to this heading">#</a></h2>
<p>After this is complete, the following should work:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">ww</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">Coweeta</span><span class="o">/</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">steadystate</span>
<span class="n">mpiexec</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="n">ats</span> <span class="o">../</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">steadystate</span><span class="o">.</span><span class="n">xml</span> <span class="o">&amp;&gt;</span> <span class="n">out</span><span class="o">.</span><span class="n">log</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">cyclic_steadystate</span>
<span class="n">mpiexec</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="n">ats</span> <span class="o">../</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">cyclic_steadystate</span><span class="o">.</span><span class="n">xml</span> <span class="o">&amp;&gt;</span> <span class="n">out</span><span class="o">.</span><span class="n">log</span>
<span class="n">cd</span> <span class="o">../</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">transient</span>
<span class="n">mpiexec</span> <span class="o">-</span><span class="n">n</span> <span class="mi">4</span> <span class="n">ats</span> <span class="o">../</span><span class="n">Coweeta</span><span class="o">-</span><span class="n">transient</span><span class="o">.</span><span class="n">xml</span> <span class="o">&amp;&gt;</span> <span class="n">out</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the following files were generated during this run:</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;role&quot;</span><span class="si">:</span><span class="s1">&lt;35</span><span class="si">}</span><span class="s1">: filename&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">34</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">output_filenames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">vs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">splitPathFull</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">vs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Coweeta&#39;</span><span class="p">:</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">v2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="n">vs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">:</span><span class="s1">&lt;35</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">v2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>role                               : filename
---------------------------------- :  --------------------------------------------------
modis_lai_transient                : output_data/Coweeta_LAI_MODIS_transient.h5
modis_lai_cyclic_steadystate       : output_data/Coweeta_LAI_MODIS_CyclicSteadystate.h5
nlcd_lai_cyclic_steadystate        : output_data/Coweeta_LAI_NLCD_CyclicSteadystate.h5
nlcd_lai_transient                 : output_data/Coweeta_LAI_NLCD_2010_2014.h5
subsurface_properties              : output_data/Coweeta_subsurface_properties.csv
mesh                               : output_data/Coweeta.exo
meteorology_transient              : output_data/Coweeta_aorc-2010-2014.h5
meteorology_cyclic_steadystate     : output_data/Coweeta_daymet-CyclicSteadystate.h5
ats_xml_steadystate                : Coweeta-steadystate.xml
ats_rundir_steadystate             : Coweeta-steadystate
ats_xml_cyclic_steadystate         : Coweeta-cyclic_steadystate.xml
ats_rundir_cyclic_steadystate      : Coweeta-cyclic_steadystate
ats_xml_transient                  : Coweeta-transient.xml
ats_rundir_transient               : Coweeta-transient
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;this workflow is a total success!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2025-08-29 17:34:56,168 - root - INFO: this workflow is a total success!
</pre></div>
</div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="coweeta_stream_aligned_mesh.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Mixed-Element Mesh for the Coweeta Watershed</p>
      </div>
    </a>
    <a class="right-next"
       href="../install.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Installation and Setup</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2019-202X, UT Battelle, Ethan Coon.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>