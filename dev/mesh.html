
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Meshing &#8212; Watershed Workflow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.dataTables.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/custom_theme.css?v=a03f4c85" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/jquery.js?v=5d32c60e"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'mesh';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/environmental-modeling-workflows/watershed-workflow/master/docs/source/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v2.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <script src="https://cdn.datatables.net/2.0.8/js/dataTables.js"></script>
    <script src="_static/main.js?v=b10558fa"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Manipulation" href="data.html" />
    <link rel="prev" title="Data Structures and Shape Manipulation" href="geometry.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Watershed Workflow</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="concepts.html">
    Concepts
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Documentation
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="gallery.html">
    Gallery
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="intro.html">
    Introduction
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="concepts.html">
    Concepts
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="api.html">
    API Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="gallery.html">
    Gallery
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><!-- This will display the version of the docs -->
Version dev</div>
        <div class="sidebar-primary-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="hilev.html">High Level API</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources.html">Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry and Shape Manipulation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Meshes</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilities.html">Utilities</a></li>
</ul>
</div>
</nav></div>
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-watershed_workflow.mesh">Mesh</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.LabeledSet"><code class="docutils literal notranslate"><span class="pre">LabeledSet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.LabeledSet.validate"><code class="docutils literal notranslate"><span class="pre">LabeledSet.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D"><code class="docutils literal notranslate"><span class="pre">Mesh2D</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.boundary_edges"><code class="docutils literal notranslate"><span class="pre">Mesh2D.boundary_edges</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.cell_edges"><code class="docutils literal notranslate"><span class="pre">Mesh2D.cell_edges()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.centroids"><code class="docutils literal notranslate"><span class="pre">Mesh2D.centroids</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.checkHandedness"><code class="docutils literal notranslate"><span class="pre">Mesh2D.checkHandedness()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.clearGeometryCache"><code class="docutils literal notranslate"><span class="pre">Mesh2D.clearGeometryCache()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.computeCentroid"><code class="docutils literal notranslate"><span class="pre">Mesh2D.computeCentroid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.conn"><code class="docutils literal notranslate"><span class="pre">Mesh2D.conn</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.dim"><code class="docutils literal notranslate"><span class="pre">Mesh2D.dim</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.edge_hash"><code class="docutils literal notranslate"><span class="pre">Mesh2D.edge_hash()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.from_Transect"><code class="docutils literal notranslate"><span class="pre">Mesh2D.from_Transect()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.getNextAvailableLabeledSetID"><code class="docutils literal notranslate"><span class="pre">Mesh2D.getNextAvailableLabeledSetID()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.num_cells"><code class="docutils literal notranslate"><span class="pre">Mesh2D.num_cells</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.num_edges"><code class="docutils literal notranslate"><span class="pre">Mesh2D.num_edges</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.num_vertices"><code class="docutils literal notranslate"><span class="pre">Mesh2D.num_vertices</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.plot"><code class="docutils literal notranslate"><span class="pre">Mesh2D.plot()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.read_VTK"><code class="docutils literal notranslate"><span class="pre">Mesh2D.read_VTK()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.read_VTK_Simplices"><code class="docutils literal notranslate"><span class="pre">Mesh2D.read_VTK_Simplices()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.read_VTK_Unstructured"><code class="docutils literal notranslate"><span class="pre">Mesh2D.read_VTK_Unstructured()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.to_dual"><code class="docutils literal notranslate"><span class="pre">Mesh2D.to_dual()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.transform"><code class="docutils literal notranslate"><span class="pre">Mesh2D.transform()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh2D.writeVTK"><code class="docutils literal notranslate"><span class="pre">Mesh2D.writeVTK()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D"><code class="docutils literal notranslate"><span class="pre">Mesh3D</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.extruded_Mesh2D"><code class="docutils literal notranslate"><span class="pre">Mesh3D.extruded_Mesh2D()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.getNextAvailableLabeledSetID"><code class="docutils literal notranslate"><span class="pre">Mesh3D.getNextAvailableLabeledSetID()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.summarizeExtrusion"><code class="docutils literal notranslate"><span class="pre">Mesh3D.summarizeExtrusion()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.validate"><code class="docutils literal notranslate"><span class="pre">Mesh3D.validate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.writeExodus"><code class="docutils literal notranslate"><span class="pre">Mesh3D.writeExodus()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.Mesh3D.writeVTK"><code class="docutils literal notranslate"><span class="pre">Mesh3D.writeVTK()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.SideSet"><code class="docutils literal notranslate"><span class="pre">SideSet</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.SideSet.validate"><code class="docutils literal notranslate"><span class="pre">SideSet.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.cache"><code class="docutils literal notranslate"><span class="pre">cache()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.computeTelescopeFactor"><code class="docutils literal notranslate"><span class="pre">computeTelescopeFactor()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.createSubmesh"><code class="docutils literal notranslate"><span class="pre">createSubmesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.mergeMeshes"><code class="docutils literal notranslate"><span class="pre">mergeMeshes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.mergeTwoMeshes"><code class="docutils literal notranslate"><span class="pre">mergeTwoMeshes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.mesh.optimizeDzs"><code class="docutils literal notranslate"><span class="pre">optimizeDzs()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-watershed_workflow.river_mesh">River-aligned Mesh</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.adjustHUCsToRiverMesh"><code class="docutils literal notranslate"><span class="pre">adjustHUCsToRiverMesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.computeLine"><code class="docutils literal notranslate"><span class="pre">computeLine()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.createRiverMesh"><code class="docutils literal notranslate"><span class="pre">createRiverMesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.createRiversMesh"><code class="docutils literal notranslate"><span class="pre">createRiversMesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.createWidthFunction"><code class="docutils literal notranslate"><span class="pre">createWidthFunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.findIntersection"><code class="docutils literal notranslate"><span class="pre">findIntersection()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.fixConvexity"><code class="docutils literal notranslate"><span class="pre">fixConvexity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.projectJunction"><code class="docutils literal notranslate"><span class="pre">projectJunction()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.projectOne"><code class="docutils literal notranslate"><span class="pre">projectOne()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.projectTwo"><code class="docutils literal notranslate"><span class="pre">projectTwo()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.river_mesh.translateLinePerpendicular"><code class="docutils literal notranslate"><span class="pre">translateLinePerpendicular()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-watershed_workflow.triangulation">Triangulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.Nodes"><code class="docutils literal notranslate"><span class="pre">Nodes</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.NodesEdges"><code class="docutils literal notranslate"><span class="pre">NodesEdges</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.NodesEdges.add"><code class="docutils literal notranslate"><span class="pre">NodesEdges.add()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.NodesEdges.check"><code class="docutils literal notranslate"><span class="pre">NodesEdges.check()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.connectOnewayTrip"><code class="docutils literal notranslate"><span class="pre">connectOnewayTrip()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.connectRoundTrip"><code class="docutils literal notranslate"><span class="pre">connectRoundTrip()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.orient"><code class="docutils literal notranslate"><span class="pre">orient()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.refineByMaxArea"><code class="docutils literal notranslate"><span class="pre">refineByMaxArea()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.refineByMaxEdgeLength"><code class="docutils literal notranslate"><span class="pre">refineByMaxEdgeLength()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.refineByPolygons"><code class="docutils literal notranslate"><span class="pre">refineByPolygons()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.refineByRiverDistance"><code class="docutils literal notranslate"><span class="pre">refineByRiverDistance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.triangulation.triangulate"><code class="docutils literal notranslate"><span class="pre">triangulate()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-watershed_workflow.condition">Condition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.burnInRiver"><code class="docutils literal notranslate"><span class="pre">burnInRiver()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.conditionRiverMesh"><code class="docutils literal notranslate"><span class="pre">conditionRiverMesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.conditionRiverMeshes"><code class="docutils literal notranslate"><span class="pre">conditionRiverMeshes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.distributeProfileToMesh"><code class="docutils literal notranslate"><span class="pre">distributeProfileToMesh()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.enforceBankIntegrity"><code class="docutils literal notranslate"><span class="pre">enforceBankIntegrity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.enforceLocalMonotonicity"><code class="docutils literal notranslate"><span class="pre">enforceLocalMonotonicity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.enforceMonotonicity"><code class="docutils literal notranslate"><span class="pre">enforceMonotonicity()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.fillPits"><code class="docutils literal notranslate"><span class="pre">fillPits()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.fillPits1"><code class="docutils literal notranslate"><span class="pre">fillPits1()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.fillPits2"><code class="docutils literal notranslate"><span class="pre">fillPits2()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.fillPits3"><code class="docutils literal notranslate"><span class="pre">fillPits3()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.fillPitsDual"><code class="docutils literal notranslate"><span class="pre">fillPitsDual()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.identifyLocalMinima"><code class="docutils literal notranslate"><span class="pre">identifyLocalMinima()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.setProfileByDEM"><code class="docutils literal notranslate"><span class="pre">setProfileByDEM()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.condition.smoothProfile"><code class="docutils literal notranslate"><span class="pre">smoothProfile()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-watershed_workflow.regions">Regions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addPolygonalRegions"><code class="docutils literal notranslate"><span class="pre">addPolygonalRegions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addReachIDRegions"><code class="docutils literal notranslate"><span class="pre">addReachIDRegions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addRiverCorridorRegions"><code class="docutils literal notranslate"><span class="pre">addRiverCorridorRegions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addStreamOrderRegions"><code class="docutils literal notranslate"><span class="pre">addStreamOrderRegions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addSurfaceRegions"><code class="docutils literal notranslate"><span class="pre">addSurfaceRegions()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed_workflow.regions.addWatershedAndOutletRegions"><code class="docutils literal notranslate"><span class="pre">addWatershedAndOutletRegions()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="api.html" class="nav-link">API Documentation</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Meshing</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="meshing">
<h1>Meshing<a class="headerlink" href="#meshing" title="Link to this heading">#</a></h1>
<section id="module-watershed_workflow.mesh">
<span id="mesh"></span><h2>Mesh<a class="headerlink" href="#module-watershed_workflow.mesh" title="Link to this heading">#</a></h2>
<p>Tools for turning data into meshes, then writing them to file.</p>
<p>Works with and assumes all polyhedra cells (and polygon faces).</p>
<p>Requires building a reasonably recent version of Exodus to get
the associated exodus.py wrappers in python3.</p>
<p>Note that this is typically done in your standard ATS installation,
assuming you have built your Amanzi TPLs with shared libraries (the
default through bootstrap).</p>
<p>In that case, simply ensure that ${AMANZI_TPLS_DIR}/SEACAS/lib is in
your PYTHONPATH.</p>
<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.mesh.LabeledSet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">LabeledSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ent_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_extrude</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#LabeledSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.LabeledSet" title="Link to this definition">#</a></dt>
<dd><p>A generic collection of entities.</p>
<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.LabeledSet.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_tuple</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#LabeledSet.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.LabeledSet.validate" title="Link to this definition">#</a></dt>
<dd><p>Validate the labeled set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – Expected size for validation.</p></li>
<li><p><strong>is_tuple</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether entities are tuples (edges). Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If validation fails.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">Mesh2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeled_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#watershed_workflow.mesh.LabeledSet" title="watershed_workflow.mesh.LabeledSet"><span class="pre">LabeledSet</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CRS</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_handedness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D" title="Link to this definition">#</a></dt>
<dd><p>A 2D mesh class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>NCOORDS</em><em>,</em><em>NDIMS</em><em>)</em>) – Array of coordinates of the 2D mesh.</p></li>
<li><p><strong>conn</strong> (<em>list</em><em>(</em><em>lists</em><em>)</em>) – List of lists of indices into coords that form the cells.</p></li>
<li><p><strong>labeled_sets</strong> (<em>list</em><em>(</em><a class="reference internal" href="#watershed_workflow.mesh.LabeledSet" title="watershed_workflow.mesh.LabeledSet"><em>LabeledSet</em></a><em>)</em><em>, </em><em>optional</em>) – List of labeled sets to add to the mesh.</p></li>
<li><p><strong>crs</strong> (<em>CRS</em>) – Keep this as a property for future reference.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional=0.01</em>) – A small measure of length between coords.</p></li>
<li><p><strong>check_handedness</strong> (<em>bool</em><em>, </em><em>optional=True</em>) – If true, ensure all cells are oriented so that right-hand rule
ordering of the vertices points up.</p></li>
<li><p><strong>validate</strong> (<em>bool</em><em>, </em><em>optional=False</em>) – If true, validate coordinates and connections
post-construction.</p></li>
<li><p><strong>Note</strong> (<em>(</em><em>coords</em><em>, </em><em>conn</em><em>) </em><em>may be output provided by a</em>)</p></li>
<li><p><strong>call.</strong> (<em>watershed_workflow.triangulation.triangulate</em><em>(</em><em>)</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.boundary_edges">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary_edges</span></span><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.boundary_edges" title="Link to this definition">#</a></dt>
<dd><p>Return edges in the boundary of the mesh, ordered around the boundary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.cell_edges">
<span class="sig-name descname"><span class="pre">cell_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.cell_edges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.cell_edges" title="Link to this definition">#</a></dt>
<dd><p>Generator for edges of a cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>conn</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – Cell connectivity (vertex indices).</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Tuple[int, int]</em> – Edge as a tuple of vertex indices.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.centroids">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">centroids</span></span><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.centroids" title="Link to this definition">#</a></dt>
<dd><p>Calculate surface mesh centroids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.checkHandedness">
<span class="sig-name descname"><span class="pre">checkHandedness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.checkHandedness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.checkHandedness" title="Link to this definition">#</a></dt>
<dd><p>Ensures all cells are oriented via the right-hand-rule, i.e. in the +z direction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.clearGeometryCache">
<span class="sig-name descname"><span class="pre">clearGeometryCache</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.clearGeometryCache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.clearGeometryCache" title="Link to this definition">#</a></dt>
<dd><p>If coordinates are changed, any computed, cached geometry must be
recomputed.  It is the USER’s responsibility to call this
function if any coords are changed!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.computeCentroid">
<span class="sig-name descname"><span class="pre">computeCentroid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.computeCentroid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.computeCentroid" title="Link to this definition">#</a></dt>
<dd><p>Computes, based on coords, the centroid of a cell with ID c.</p>
<p>Note this ALWAYS recomputes the value, not using the cache.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.conn">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conn</span></span><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.conn" title="Link to this definition">#</a></dt>
<dd><p>Note that conn is immutable because changing this breaks all the
other properties, which may be cached.  To change topology, one must construct a new mesh!</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.dim">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.dim" title="Link to this definition">#</a></dt>
<dd><p>Spatial dimension of the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of spatial dimensions.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.edge_hash">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.edge_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.edge_hash" title="Link to this definition">#</a></dt>
<dd><p>Hashes edges in a direction-independent way.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – First vertex index.</p></li>
<li><p><strong>j</strong> (<em>int</em>) – Second vertex index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Sorted tuple of vertex indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[int, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.from_Transect">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_Transect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.from_Transect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.from_Transect" title="Link to this definition">#</a></dt>
<dd><p>Creates a 2D surface strip mesh from transect data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.getNextAvailableLabeledSetID">
<span class="sig-name descname"><span class="pre">getNextAvailableLabeledSetID</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.getNextAvailableLabeledSetID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.getNextAvailableLabeledSetID" title="Link to this definition">#</a></dt>
<dd><p>Returns next available LS id.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.num_cells">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_cells</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.num_cells" title="Link to this definition">#</a></dt>
<dd><p>Number of cells in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of cells.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.num_edges">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_edges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.num_edges" title="Link to this definition">#</a></dt>
<dd><p>Number of edges in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of edges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.num_vertices">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_vertices</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.num_vertices" title="Link to this definition">#</a></dt>
<dd><p>Number of vertices in the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of vertices.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">facecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">PolyCollection</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.plot" title="Link to this definition">#</a></dt>
<dd><p>Plot the flattened 2D mesh.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.read_VTK">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_VTK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.read_VTK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.read_VTK" title="Link to this definition">#</a></dt>
<dd><p>Constructor from a VTK file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.read_VTK_Simplices">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_VTK_Simplices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.read_VTK_Simplices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.read_VTK_Simplices" title="Link to this definition">#</a></dt>
<dd><p>Constructor from an structured VTK file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.read_VTK_Unstructured">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_VTK_Unstructured</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.read_VTK_Unstructured"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.read_VTK_Unstructured" title="Link to this definition">#</a></dt>
<dd><p>Constructor from an unstructured VTK file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.to_dual">
<span class="sig-name descname"><span class="pre">to_dual</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.to_dual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.to_dual" title="Link to this definition">#</a></dt>
<dd><p>Creates a 2D surface mesh from a primal 2D triangular surface mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>dual_vertices</strong> (<em>np.ndarray</em>)</p></li>
<li><p><strong>dual_conn</strong> (<em>list(lists)</em>) – The vertices and cell_to_vertex_conn of a 2D, polygonal, nearly Voronoi
mesh that is the truncated dual of self.  Here we say nearly because
the boundary triangles (see note below) are not Voronoi.</p></li>
<li><p><strong>dual_from_primal_mapping</strong> (<em>np.array( (len(dual_conn),), ‘i’)</em>) – Mapping from a dual cell to the primal vertex it is based on.
Without the boundary, this would be simply
arange(0,len(dual_conn)), but beacuse we added triangles on the
boundary, this mapping is useful.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Vertices of the dual are on circumcenters of the primal triangles.</p></li>
<li><p>Centers of the dual are numbered by vertices of the primal mesh, modulo
the boundary.</p></li>
<li><p>At the boundary, the truncated dual polygon may be non-convex.  To
avoid this issue, we triangulate boundary polygons.</p></li>
</ul>
<p>We do not simply construct a mesh because likely the user needs to
elevate, generate material IDs, labeled sets, etc, prior to mesh
construction.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.transform" title="Link to this definition">#</a></dt>
<dd><p>Transform a 2D mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 3x3 transformation matrix. Default is identity.</p></li>
<li><p><strong>shift</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – 3-element translation vector. Default is zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh2D.writeVTK">
<span class="sig-name descname"><span class="pre">writeVTK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh2D.writeVTK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh2D.writeVTK" title="Link to this definition">#</a></dt>
<dd><p>Writes to VTK.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Output VTK filename.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">Mesh3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face_to_vertex_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_to_face_conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labeled_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#watershed_workflow.mesh.LabeledSet" title="watershed_workflow.mesh.LabeledSet"><span class="pre">LabeledSet</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#watershed_workflow.mesh.SideSet" title="watershed_workflow.mesh.SideSet"><span class="pre">SideSet</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">material_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">NOTHING</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">CRS</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D" title="Link to this definition">#</a></dt>
<dd><p>A 3D mesh class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>np.ndarray</em><em>(</em><em>NCOORDS</em><em>,</em><em>3</em><em>)</em>) – Array of coordinates of the 3D mesh.</p></li>
<li><p><strong>face_to_vertex_conn</strong> (<em>list</em><em>(</em><em>lists</em><em>)</em>) – List of lists of indices into coords that form the faces.</p></li>
<li><p><strong>cell_to_face_conn</strong> (<em>list</em><em>(</em><em>lists</em><em>)</em>) – List of lists of indices into face_to_vertex_conn that form the
cells.</p></li>
<li><p><strong>side_sets</strong> (<em>list</em><em>(</em><a class="reference internal" href="#watershed_workflow.mesh.SideSet" title="watershed_workflow.mesh.SideSet"><em>SideSet</em></a><em>)</em><em>, </em><em>optional</em>) – List of side sets to add to the mesh.</p></li>
<li><p><strong>labeled_sets</strong> (<em>list</em><em>(</em><a class="reference internal" href="#watershed_workflow.mesh.LabeledSet" title="watershed_workflow.mesh.LabeledSet"><em>LabeledSet</em></a><em>)</em><em>, </em><em>optional</em>) – List of labeled sets to add to the mesh.</p></li>
<li><p><strong>material_ids</strong> (<em>np.array</em><em>(</em><em>(</em><em>len</em><em>(</em><em>cell_to_face_conn</em><em>)</em><em>,</em><em>)</em><em>,</em><em>'i'</em><em>)</em><em>, </em><em>optional</em>) – Array of length num_cells that specifies material IDs</p></li>
<li><p><strong>crs</strong> (<em>CRS</em>) – Keep the coordinate system for reference.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional=0.01</em>) – A small measure of length between coords.</p></li>
<li><p><strong>(</strong><strong>coords</strong> (<em>Note that</em>)</p></li>
<li><p><strong>a</strong> (<em>conn</em><em>) </em><em>may be output provided by</em>)</p></li>
<li><p><strong>call.</strong> (<em>watershed_workflow.triangulation.triangulate</em><em>(</em><em>)</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.extruded_Mesh2D">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extruded_Mesh2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh2D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncells_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_ids</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.extruded_Mesh2D"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.extruded_Mesh2D" title="Link to this definition">#</a></dt>
<dd><p>Uniformly extrude a 2D mesh to make a 3D mesh.</p>
<p>Layers of potentially multiple sets of cells are extruded
downward in the vertical.  The cell dz is uniform horizontally
and vertically through the layer in all but the ‘snapped’
case, where it is uniform vertically but not horizontally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh2D</strong> (<a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><em>Mesh2D</em></a>) – The 2D mesh to extrude</p></li>
<li><p><strong>layer_types</strong> (<em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em>) – One of [‘snapped’, ‘function’, ‘vertex’, ‘cell’,] or a list of
these strings, describing the extrusion method for each
layer.  If only a single string is supplied, all layers are
of this type.  See layer_data below.</p></li>
<li><p><strong>layer_data</strong> (<em>list</em><em>[</em><em>data</em><em>]</em>) – <p>Data required, one for each layer.  The data is specific to
the layer type:</p>
<ul>
<li><p>’constant’ : float, layer thickness</p></li>
<li><p>’snapped’ : float, the bottom z-coordinate of the layer.
Cells are extruded uniformly to whatever thickness
required to match this bottom coordinate.</p></li>
<li><p>’function’ : function, layer_thickness = func(x,y)</p></li>
<li><p>’vertex’ : np.array((mesh2D.num_vertices,), float) layer
thickness for each vertex</p></li>
<li><p>’cell’ : np.array((mesh2D.num_cells,), float)
interpolates nodal layer thickness from neighboring cell
thicknesses</p></li>
</ul>
</p></li>
<li><p><strong>ncells_per_layer</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>]</em>) – Either a single integer (same number of cells in all layers)
or a list of number of cells in each layer</p></li>
<li><p><strong>mat_ids</strong> (<em>int</em><em>, </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>np.ndarray</em><em>(</em><em>(</em><em>num_layers</em><em>, </em><em>mesh2D.num_cells</em><em>)</em><em>, </em><em>dtype=int</em><em>)</em>) – Material ID for each cell in each layer.  If an int, all
cells in all layers share thesame material ID.  If a list or
1D array, one material ID per layer.  If a 2D array,
provides all material IDs explicitly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extruded, 3D mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#watershed_workflow.mesh.Mesh3D" title="watershed_workflow.mesh.Mesh3D">Mesh3D</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.getNextAvailableLabeledSetID">
<span class="sig-name descname"><span class="pre">getNextAvailableLabeledSetID</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.getNextAvailableLabeledSetID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.getNextAvailableLabeledSetID" title="Link to this definition">#</a></dt>
<dd><p>Returns next available LS id.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.summarizeExtrusion">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">summarizeExtrusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncells_per_layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface_cell_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.summarizeExtrusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.summarizeExtrusion" title="Link to this definition">#</a></dt>
<dd><p>Summarizes extruded data by printing info to log file.</p>
<p>This is useful in rapidly debugging and understanding the layering before
you do the extrusion process.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.validate" title="Link to this definition">#</a></dt>
<dd><p>Checks the validity of the mesh, or throws an AssertionError.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.writeExodus">
<span class="sig-name descname"><span class="pre">writeExodus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">face_block_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'one</span> <span class="pre">block'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.writeExodus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.writeExodus" title="Link to this definition">#</a></dt>
<dd><p>Write the 3D mesh to ExodusII using arbitrary polyhedra spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Output Exodus filename.</p></li>
<li><p><strong>face_block_mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Face block mode. Default is “one block”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.Mesh3D.writeVTK">
<span class="sig-name descname"><span class="pre">writeVTK</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#Mesh3D.writeVTK"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.Mesh3D.writeVTK" title="Link to this definition">#</a></dt>
<dd><p>Writes to VTK.</p>
<p>Note, this just writes the topology/geometry information, for
WEDGE type meshes (extruded triangles).  No labeled sets are
written.  Prefer to use write_exodus() for a fully featured
mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Output VTK filename.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.mesh.SideSet">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">SideSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">setid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#SideSet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.SideSet" title="Link to this definition">#</a></dt>
<dd><p>A collection of faces in cells.</p>
<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.mesh.SideSet.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_faces</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#SideSet.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.SideSet.validate" title="Link to this definition">#</a></dt>
<dd><p>Validate the side set against cell faces.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cell_faces</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em>) – List of cell face connections.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If validation fails.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.cache">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">cache</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#cache"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.cache" title="Link to this definition">#</a></dt>
<dd><p>A caching decorator for instance methods.</p>
<p>This decorator caches the result of a method call in an instance attribute.
Note: Only works with __dict__ classes, not slotted classes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>func</strong> (<em>Callable</em><em>[</em><em>[</em><em>Any</em><em>]</em><em>, </em><em>Any</em><em>]</em>) – The function to cache.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The wrapped function with caching.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Any], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.computeTelescopeFactor">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">computeTelescopeFactor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_dz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#computeTelescopeFactor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.computeTelescopeFactor" title="Link to this definition">#</a></dt>
<dd><p>Calculates a telescoping factor to fill a given layer.</p>
<p>Calculates a constant geometric factor, such that a layer of thickness
layer_dz is perfectly filled by ncells in the vertical, where the top cell
is dz in thickness and each successive cell grows by a factor of that
factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncells</strong> (<em>int</em>) – Number of cells (in the vertical) needed.</p></li>
<li><p><strong>dz</strong> (<em>float</em>) – Top cell’s thickness in the vertical.</p></li>
<li><p><strong>layer_dz</strong> (<em>float</em>) – Thickness of the total layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The telescoping factor.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.createSubmesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">createSubmesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">shp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">BaseGeometry</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#createSubmesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.createSubmesh" title="Link to this definition">#</a></dt>
<dd><p>Given a shape that contains some cells of m2, create the submesh.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.mergeMeshes">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">mergeMeshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">meshes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#mergeMeshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.mergeMeshes" title="Link to this definition">#</a></dt>
<dd><p>Combines multiple 2D meshes into a single mesh.</p>
<p>It is assumed that the meshes to be combined have common vertices
on the shared edge (no steiner points). labeledsets should be added
after merging the mesh. Option of merging pre-existing labeledsets
in the to-be-merged meshes will be added soon</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>meshes</strong> (<em>list</em><em>(</em><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><em>mesh.Mesh2D</em></a><em>)</em>) – The list of meshes to be merged</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>combined mesh</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D">mesh.Mesh2D</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.mergeTwoMeshes">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">mergeTwoMeshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#mergeTwoMeshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.mergeTwoMeshes" title="Link to this definition">#</a></dt>
<dd><p>merge two meshes (mesh.Mesh2D objects)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.mesh.optimizeDzs">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.mesh.</span></span><span class="sig-name descname"><span class="pre">optimizeDzs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dz_begin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dz_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_cells</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_thickness</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_dz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_increasing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/mesh.html#optimizeDzs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.mesh.optimizeDzs" title="Link to this definition">#</a></dt>
<dd><p>Tries to optimize dzs</p>
</dd></dl>

</section>
<section id="module-watershed_workflow.river_mesh">
<span id="river-aligned-mesh"></span><h2>River-aligned Mesh<a class="headerlink" href="#module-watershed_workflow.river_mesh" title="Link to this heading">#</a></h2>
<p>creates river mesh using quad, pentagon and hexagon elements</p>
<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.adjustHUCsToRiverMesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">adjustHUCsToRiverMesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hucs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><span class="pre">SplitHUCs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#adjustHUCsToRiverMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.adjustHUCsToRiverMesh" title="Link to this definition">#</a></dt>
<dd><p>Adjust HUC segments that touch reach endpoints to match the corridor coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hucs</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><em>SplitHUCs</em></a>) – Split HUCs object to adjust.</p></li>
<li><p><strong>river</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a>) – River network with mesh coordinates.</p></li>
<li><p><strong>coords</strong> (<em>np.ndarray</em>) – Array of mesh coordinates.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.computeLine">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">computeLine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#computeLine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.computeLine" title="Link to this definition">#</a></dt>
<dd><p>Compute line coefficients (Ax + By + C = 0) for a line defined by two points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p1</strong> (<em>np.ndarray</em>) – First point coordinates.</p></li>
<li><p><strong>p2</strong> (<em>np.ndarray</em>) – Second point coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Line coefficients (A, B, C) such that Ax + By + C = 0.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.createRiverMesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">createRiverMesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">computeWidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elems_gid_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#createRiverMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.createRiverMesh" title="Link to this definition">#</a></dt>
<dd><p>Returns list of elems and river corridor polygons for a given list of river trees</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>rivers: list(River object)</dt><dd><p>List of river tree along which river meshes are to be created</p>
</dd>
<dt>widths: float or dict or callable or boolean</dt><dd><p>Width of the quads, either a float or a dictionary providing a
{StreamOrder : width} mapping.
Or a function (callable) that computer width using node properties
Or boolean, where True means, width for each reach is explicitely provided properties as “width”</p>
</dd>
<dt>enforce_convexity: boolean</dt><dd><p>If true, enforce convexity of the pentagons/hexagons at the
junctions.</p>
</dd>
<dt>ax<span class="classifier">matplotlib Axes object, optional</span></dt><dd><p>For debugging – plots troublesome reaches as quad elements are
generated to find tricky areas.</p>
</dd>
<dt>label<span class="classifier">bool, optional = True</span></dt><dd><p>If true and ax is provided, animates the debugging plot with
reach ID labels as the user hovers over the plot.  Requires a
widget backend for matplotlib.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>corrs</strong> (<em>list(shapely.geometry.Polygon)</em>) – List of river corridor polygons, one per river, storing the
coordinates used in elems.</p></li>
<li><p><strong>elems</strong> (<em>list(list)</em>) – List of river elements, each element a list of indices into
corr.coords.</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.createRiversMesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">createRiversMesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hucs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><span class="pre">SplitHUCs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computeWidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Point</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">GeoDataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#createRiversMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.createRiversMesh" title="Link to this definition">#</a></dt>
<dd><p>Create meshes for each river and merge them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hucs</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><em>SplitHUCs</em></a>) – Split HUCs object for mesh adjustment.</p></li>
<li><p><strong>rivers</strong> (<em>List</em><em>[</em><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a><em>]</em>) – List of river networks to mesh.</p></li>
<li><p><strong>computeWidth</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a><em>]</em><em>, </em><em>float</em><em>]</em>) – Function to compute river width.</p></li>
<li><p><strong>ax</strong> (<em>matplotlib.axes.Axes</em><em>, </em><em>optional</em>) – Axes for debugging plots, by default None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing coordinates, elements, corridors, hole points, and intersections dataframe.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, List[List[int]], List[shapely.geometry.Polygon], List[shapely.geometry.Point], gpd.GeoDataFrame | None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.createWidthFunction">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">createWidthFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#createWidthFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.createWidthFunction" title="Link to this definition">#</a></dt>
<dd><p>Create a width function from various argument types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>arg</strong> (<em>Dict</em><em>[</em><em>int</em><em>, </em><em>float</em><em>] </em><em>| </em><em>Callable</em><em>[</em><em>[</em><em>int</em><em>]</em><em>, </em><em>float</em><em>] </em><em>| </em><em>float</em>) – Width specification - can be a constant, dictionary mapping stream order to width,
or callable function.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function that computes width for a given reach.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[int], float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.findIntersection">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">findIntersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#findIntersection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.findIntersection" title="Link to this definition">#</a></dt>
<dd><p>Find the intersection point of two lines given by coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line1</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – First line coefficients (A, B, C).</p></li>
<li><p><strong>line2</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – Second line coefficients (A, B, C).</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print debug information, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intersection point coordinates, or None if lines are parallel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.fixConvexity">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">fixConvexity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computeWidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#fixConvexity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.fixConvexity" title="Link to this definition">#</a></dt>
<dd><p>Snap element coordinates onto the convex hull while respecting upstream stream width.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reach</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a>) – River reach containing the element.</p></li>
<li><p><strong>e_coords</strong> (<em>np.ndarray</em>) – Element coordinates to fix.</p></li>
<li><p><strong>computeWidth</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a><em>]</em><em>, </em><em>float</em><em>]</em>) – Function to compute river width.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fixed element coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.projectJunction">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">projectJunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">child_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computeWidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#projectJunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.projectJunction" title="Link to this definition">#</a></dt>
<dd><p>Find points around the junction between reach and its children.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reach</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a>) – Parent reach containing the junction.</p></li>
<li><p><strong>child_idx</strong> (<em>int</em>) – Index of the child reach at the junction.</p></li>
<li><p><strong>computeWidth</strong> (<em>Callable</em><em>[</em><em>[</em><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><em>River</em></a><em>]</em><em>, </em><em>float</em><em>]</em>) – Function to compute river width.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print debug information, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Junction point coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.projectOne">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">projectOne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#projectOne"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.projectOne" title="Link to this definition">#</a></dt>
<dd><p>Find a point p_out that is width away from p and such that p_up –&gt; p is right-perpendicular to p –&gt; p_out.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_up</strong> (<em>np.ndarray</em>) – Upstream point coordinates.</p></li>
<li><p><strong>p</strong> (<em>np.ndarray</em>) – Reference point coordinates.</p></li>
<li><p><strong>width</strong> (<em>float</em>) – Distance to project perpendicular to the line.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected point coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.projectTwo">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">projectTwo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_up</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_dn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#projectTwo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.projectTwo" title="Link to this definition">#</a></dt>
<dd><p>Find a point that is perpendicular to the linestring p_up –&gt; p –&gt; p_dn.</p>
<p>Projects by intersecting two lines, one parallel to p_up –&gt; p and width1 away,
and one parallel to p –&gt; p_dn and width2 away.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_up</strong> (<em>np.ndarray</em>) – Upstream point coordinates.</p></li>
<li><p><strong>p</strong> (<em>np.ndarray</em>) – Middle point coordinates.</p></li>
<li><p><strong>p_dn</strong> (<em>np.ndarray</em>) – Downstream point coordinates.</p></li>
<li><p><strong>width1</strong> (<em>float</em>) – Width for upstream segment.</p></li>
<li><p><strong>width2</strong> (<em>float</em>) – Width for downstream segment.</p></li>
<li><p><strong>debug</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print debug information, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Projected point coordinates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.river_mesh.translateLinePerpendicular">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.river_mesh.</span></span><span class="sig-name descname"><span class="pre">translateLinePerpendicular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/river_mesh.html#translateLinePerpendicular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.river_mesh.translateLinePerpendicular" title="Link to this definition">#</a></dt>
<dd><p>Translate a line by a specified distance in the direction perpendicular to the line.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>line</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – Tuple of line coefficients (A, B, C).</p></li>
<li><p><strong>distance</strong> (<em>float</em>) – Scalar distance to translate the line.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of new line coefficients (A, B, C).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[float, float, float]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-watershed_workflow.triangulation">
<span id="triangulation"></span><h2>Triangulation<a class="headerlink" href="#module-watershed_workflow.triangulation" title="Link to this heading">#</a></h2>
<p>Triangulates polygons</p>
<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.Nodes">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">Nodes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#Nodes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.Nodes" title="Link to this definition">#</a></dt>
<dd><p>A collection of nodes that are indexed in the order they are added.</p>
<p>Note this uses round() for an efficient solution, which is
potentially fragile if numbers were not generated consistently.
In this use case, however, it should be safe – numbers were
originally rounded (in watershed_workflow.config), and then any function which
inserted new points or moved points were always careful to ensure
that all duplicates were always assigned the identical values –
i.e. all math was done BEFORE assignment.  So duplicates have
identical representations in floating point.  This suggests we
shouldn’t have to round here at all, but we do anyway to keep
things cleaner.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.NodesEdges">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">NodesEdges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">objlist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">LineString</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Polygon</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#NodesEdges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.NodesEdges" title="Link to this definition">#</a></dt>
<dd><p>A collection of nodes and edges.</p>
<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.NodesEdges.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LineString</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Polygon</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#NodesEdges.add"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.NodesEdges.add" title="Link to this definition">#</a></dt>
<dd><p>Adds nodes and edges from obj into collection.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.NodesEdges.check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#NodesEdges.check"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.NodesEdges.check" title="Link to this definition">#</a></dt>
<dd><p>Checks consistency of the internal representation.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.connectOnewayTrip">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">connectOnewayTrip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#connectOnewayTrip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.connectOnewayTrip" title="Link to this definition">#</a></dt>
<dd><p>Connect indices in edges in a oneway fashion</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.connectRoundTrip">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">connectRoundTrip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#connectRoundTrip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.connectRoundTrip" title="Link to this definition">#</a></dt>
<dd><p>Connect indices in edges in a round-trip fashion</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.orient">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">orient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#orient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.orient" title="Link to this definition">#</a></dt>
<dd><p>Orient an edge consistently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>e</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – Edge as tuple of two vertex indices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Oriented edge or None if vertices are identical.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[Tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.refineByMaxArea">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">refineByMaxArea</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_area</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#refineByMaxArea"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.refineByMaxArea" title="Link to this definition">#</a></dt>
<dd><p>Returns a refinement function based on max area, for use with Triangle.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.refineByMaxEdgeLength">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">refineByMaxEdgeLength</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#refineByMaxEdgeLength"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.refineByMaxEdgeLength" title="Link to this definition">#</a></dt>
<dd><p>Returns a refinement function based on max edge length, for use with Triangle.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.refineByPolygons">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">refineByPolygons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polygons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#refineByPolygons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.refineByPolygons" title="Link to this definition">#</a></dt>
<dd><p>Returns a graded refinement function based upon polygon area limits, for use with Triangle.</p>
<p>Triangle area must be smaller than the area limit for the polygon when the triangle
centroid is within the polygon.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.refineByRiverDistance">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">refineByRiverDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">near_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">near_area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">away_distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">away_area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#refineByRiverDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.refineByRiverDistance" title="Link to this definition">#</a></dt>
<dd><p>Returns a graded refinement function based upon a distance function from rivers, for use with Triangle.</p>
<p>Triangle area must be smaller than near_area when the triangle
centroid is within near_distance from the river network.
Area must be smaller than away_area when the triangle
centroid is at least away_distance from the river network.
Area must be smaller than a linear interpolant between
near_area and away_area when between
near_distance and away_distance from the river
network.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.triangulation.triangulate">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.triangulation.</span></span><span class="sig-name descname"><span class="pre">triangulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hucs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><span class="pre">SplitHUCs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">internal_boundaries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">LineString</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hole_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Point</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/triangulation.html#triangulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.triangulation.triangulate" title="Link to this definition">#</a></dt>
<dd><p>Triangulates HUCs and rivers.</p>
<p>Note, refinement of a given triangle is done if any of the provided
criteria is met.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hucs</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><em>SplitHUCs</em></a>) – A split-form HUC object from, e.g., get_split_form_hucs()</p></li>
<li><p><strong>internal_boundaries</strong> (<em>list</em><em>, </em><em>optional</em>) – List of shapely objects or RiverTrees or other iterable
collections of coordinates used as internal boundaries that
must be included in the mesh.</p></li>
<li><p><strong>hole_points</strong> (<em>list</em><em>(</em><em>shapely.Point</em><em>)</em><em>, </em><em>optional</em>) – List of points inside the polygons to be left as holes/voids (excluded from mesh).</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>optional</em>) – Set tolerance for minimum distance between two nodes. The unit
is the same as that of the watershed’s CRS. The default is 1.</p></li>
<li><p><strong>meshpy.triangle.build</strong><strong>(</strong><strong>)</strong> (<em>Additional keyword arguments include all options for</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-watershed_workflow.condition">
<span id="condition"></span><h2>Condition<a class="headerlink" href="#module-watershed_workflow.condition" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.burnInRiver">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">burnInRiver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_burn_in_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#burnInRiver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.burnInRiver" title="Link to this definition">#</a></dt>
<dd><p>Reduce reach elevations by a float or function.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.conditionRiverMesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">conditionRiverMesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_parent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bank_integrity_elevation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">depress_headwaters_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network_burn_in_depth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_depressions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#conditionRiverMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.conditionRiverMesh" title="Link to this definition">#</a></dt>
<dd><p>Condition, IN PLACE, the elevations of stream-corridor elements
to ensure connectivity throgh culverts, skips ponds, maintain
monotonicity, or otherwise enforce depths of constructed channels.</p>
<blockquote>
<div><dl class="simple">
<dt>m2: watershed_workflow.mesh.Mesh2D object</dt><dd><p>2D mesh with 3D coordinates.</p>
</dd>
<dt>river: watershed_workflow.river_tree.River object</dt><dd><p>River tree with reach[‘elems’] added for quads</p>
</dd>
<dt>smooth: boolean, optional</dt><dd><p>If true, smooth the profile of each reach using a gaussian
filter (mainly to pass through railroads and avoid reservoirs).</p>
</dd>
<dt>lower: boolean, optional</dt><dd><p>If true, lower the smoothed bed profile to match the lower
points on the raw bed profile. This is useful particularly for
narrow ag. ditches where NHDPLus flowlines often do not
coincide with the DEM depressions and so stream-elements
intermitently fall into them.</p>
</dd>
<dt>bank_integrity_elevation: float, optional</dt><dd><p>Where the river is passing right next to the reservoir or
NHDline is misplaced into the reservoir, banks may fall into
the reservoir. If true, this will enforce that the bank vertex
is at a higher elevation than the stream bed elevation.</p>
</dd>
<dt>depress_headwaters_by: float, optional</dt><dd><p>If the depression is not captured well in the DEM, the
river-mesh elements (streambed) headwater reaches may be
lowered by this number.  The effect is propogated downstream
only up to where it is needed to maintain topographic gradients
on the network scale in the network sweep step.</p>
</dd>
<dt>network_burn_in_depth: float, dict, or function</dt><dd><p>Like depress_headwaters_by, this also lowers river-mesh elements
by this value, but this variant lowers all reaches.  The depth
may be provided as a float (uniform lowering), dictionary
{stream order : depth to depress by}, or as a function of
drainage area.</p>
</dd>
<dt>known_depressions: list, optional</dt><dd><p>If provided, a list of IDs to not be burned in via the network
sweep.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.conditionRiverMeshes">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">conditionRiverMeshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#conditionRiverMeshes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.conditionRiverMeshes" title="Link to this definition">#</a></dt>
<dd><p>For multiple rivers, condition, IN PLACE, the elevations of
stream-corridor elements to ensure connectivity throgh culverts,
skips ponds, maintain monotonicity, or otherwise enforce depths of
constructed channels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.distributeProfileToMesh">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">distributeProfileToMesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#distributeProfileToMesh"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.distributeProfileToMesh" title="Link to this definition">#</a></dt>
<dd><p>Take reach profile elevations and move them out to the mesh vertices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.enforceBankIntegrity">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">enforceBankIntegrity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bank_integrity_elevation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#enforceBankIntegrity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.enforceBankIntegrity" title="Link to this definition">#</a></dt>
<dd><p>Forces banks at least bank_integrity_elevation higher than the channel elevation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.enforceLocalMonotonicity">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">enforceLocalMonotonicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">moving</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'downstream'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'upstream'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'downstream'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#enforceLocalMonotonicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.enforceLocalMonotonicity" title="Link to this definition">#</a></dt>
<dd><p>Ensures that the streambed-profile elevations are monotonically
increasing as we move upstream, or decreasing as we move
downstream.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.enforceMonotonicity">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">enforceMonotonicity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">depress_headwaters_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">known_depressions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#enforceMonotonicity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.enforceMonotonicity" title="Link to this definition">#</a></dt>
<dd><p>Sweep the river network from each headwater reach (leaf node)
to the watershed outlet (root node), removing aritificial
obstructions in the river mesh and enforcing depths of constructed
channels.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.fillPits">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">fillPits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outletID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#fillPits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.fillPits" title="Link to this definition">#</a></dt>
<dd><p>Conditions a mesh, IN PLACE, by removing pits.</p>
<p>Starts at outlet and works through all coordinates in the mesh,
ensuring that there is a path to all vertices of the mesh from the
outlet that monotonically increases in elevation.</p>
<dl class="simple">
<dt>Available algorithms (likely all should be equivalent):</dt><dd><p>1: original, 2-pass algorithm
2: refactored single-pass algorithm based on sorted lists
3: boundary marching method.  Should be the fastest.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m2</strong> (<em>mesh.Mesh2D object</em>) – The mesh to condition.</p></li>
<li><p><strong>outletID</strong> (<em>int</em><em>, </em><em>optional</em>) – If provided, the ID of the point to start conditioning from.  If
not provided, will use the boundary vertex with minimal elevation.</p></li>
<li><p><strong>algorithm</strong> (<em>int</em>) – See above, defaults to 3.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.fillPits1">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">fillPits1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Point</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outletID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#fillPits1"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.fillPits1" title="Link to this definition">#</a></dt>
<dd><p>This is the origional, 2-pass algorithm, and is likely inefficient.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.fillPits2">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">fillPits2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Point</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outletID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#fillPits2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.fillPits2" title="Link to this definition">#</a></dt>
<dd><p>This is a refactored, single pass algorithm that leverages a sorted list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.fillPits3">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">fillPits3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_Point</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outletID</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#fillPits3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.fillPits3" title="Link to this definition">#</a></dt>
<dd><p>This algorithm is based on a boundary marching method</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.fillPitsDual">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">fillPitsDual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_waterbody</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlet_edge</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#fillPitsDual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.fillPitsDual" title="Link to this definition">#</a></dt>
<dd><p>Conditions the dual of the mesh, IN PLACE, by filling pits.</p>
<p>This ensures the property that, starting with an outlet cell,
there is a path to every cell by way of faces that is
monotonically increasing in elevation (except in cells which are a
part of waterbodies).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m2</strong> (<em>mesh.Mesh2D object</em>) – The mesh to condition.</p></li>
<li><p><strong>is_waterbody</strong> (<em>np.ndarray</em><em>(</em><em>int</em><em>, </em><em>shape=ncells</em><em>)</em><em>, </em><em>optional</em>) – A boolean/integer mask of length m2.num_cells, with True
values indicating that the given cell is a part of a waterbody
that may be a depression.  This is important for
reservoirs/lakes/etc where bathymetry is known and pits are
physical.</p></li>
<li><p><strong>outlet_edge</strong> (<em>(</em><em>int</em><em>,</em><em>int</em><em>)</em><em>, </em><em>optional</em>) – If provided, the point to start conditioning from.  If not
provided, will use the edge on the boundary of m2 with the
lowest elevation.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional=1e-3</em>) – A small vertical displacement for soft tolerances.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.identifyLocalMinima">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">identifyLocalMinima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#identifyLocalMinima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.identifyLocalMinima" title="Link to this definition">#</a></dt>
<dd><p>For all cells, identify if their centroid elevation is lower than
the elevation of all neighbors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>m2</strong> (<em>mesh.Mesh2D object</em>) – The mesh to check.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of 0s and 1s, where 1 indicates a local minima.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.setProfileByDEM">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">setProfileByDEM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#setProfileByDEM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.setProfileByDEM" title="Link to this definition">#</a></dt>
<dd><p>Set the z-coordinate of the reach linestring from a DEM dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.condition.smoothProfile">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.condition.</span></span><span class="sig-name descname"><span class="pre">smoothProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lower</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/condition.html#smoothProfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.condition.smoothProfile" title="Link to this definition">#</a></dt>
<dd><p>Applies gaussian filter smoothing to the bed-profile obtained from DEM.</p>
<p>This option becomes important in ag. watersheds when NHDPLus is
inconsistent with the depression in the DEM.</p>
</dd></dl>

</section>
<section id="module-watershed_workflow.regions">
<span id="regions"></span><h2>Regions<a class="headerlink" href="#module-watershed_workflow.regions" title="Link to this heading">#</a></h2>
<p>This namespace hosts functions to add labelsets to define regions</p>
<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addPolygonalRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addPolygonalRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">polygons</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><span class="pre">SplitHUCs</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Polygon</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addPolygonalRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addPolygonalRegions" title="Link to this definition">#</a></dt>
<dd><p>Label m2 with region(s) for each polygon.</p>
<p>Always adds a surface region; if volume also adds a volume region
for extrusion in 3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m2</strong> (<a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><em>mesh.Mesh2D</em></a>) – The mesh to label.</p></li>
<li><p><strong>polygons</strong> (<a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><em>SplitHUCs</em></a><em> | </em><em>List</em><em>[</em><em>shapely.Polygon</em><em>]</em>) – The polygons covering each watershed.</p></li>
<li><p><strong>volume</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, also add the volumetric region below the polygon that
will be extruded in a 3D mesh eventually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>partitions</strong> – A list of length polygons, each entry of which is the list of
cell indices in that polygon.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addReachIDRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addReachIDRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">river</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addReachIDRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addReachIDRegions" title="Link to this definition">#</a></dt>
<dd><p>Add labeled sets to m2 for reaches of each stream order .</p>
<section id="id1">
<h3>Parameters:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>m2: Mesh2D</dt><dd><p>2D mesh elevated on DEMs</p>
</dd>
<dt>river: watershed_workflow.river_tree.RiverTree</dt><dd><p>List of rivers used to create the river corridors.</p>
</dd>
<dt>reaches: list(str)</dt><dd><p>list of NHDID IDs to be labeled.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addRiverCorridorRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addRiverCorridorRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addRiverCorridorRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addRiverCorridorRegions" title="Link to this definition">#</a></dt>
<dd><p>Add labeled sets to m2 for each river corridor.</p>
<section id="id2">
<h3>Parameters:<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>m2: Mesh2D</dt><dd><p>2D mesh elevated on DEMs</p>
</dd>
<dt>rivers: list(watershed_workflow.river_tree.RiverTree)</dt><dd><p>List of rivers used to create the river corridors.</p>
</dd>
<dt>labels: list(str), optional</dt><dd><p>List of names, one per river.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addStreamOrderRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addStreamOrderRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">rivers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="geometry.html#watershed_workflow.river_tree.River" title="watershed_workflow.river_tree.River"><span class="pre">River</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addStreamOrderRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addStreamOrderRegions" title="Link to this definition">#</a></dt>
<dd><p>Add labeled sets to m2 for reaches of each stream order .</p>
<section id="id3">
<h3>Parameters:<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>m2: Mesh2D</dt><dd><p>2D mesh elevated on DEMs</p>
</dd>
<dt>rivers<span class="classifier">List[watershed_workflow.river_tree.River]</span></dt><dd><p>River used to create the river corridors.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addSurfaceRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addSurfaceRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'land_cover'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addSurfaceRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addSurfaceRegions" title="Link to this definition">#</a></dt>
<dd><p>Add labeled sets to a mesh – one per unique color.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m2</strong> (<a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><em>mesh.Mesh2D</em></a>) – The mesh to label.</p></li>
<li><p><strong>names</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary mapping colors to color name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="watershed_workflow.regions.addWatershedAndOutletRegions">
<span class="sig-prename descclassname"><span class="pre">watershed_workflow.regions.</span></span><span class="sig-name descname"><span class="pre">addWatershedAndOutletRegions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><span class="pre">Mesh2D</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">hucs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><span class="pre">SplitHUCs</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlet_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exterior_outlet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/watershed_workflow/regions.html#addWatershedAndOutletRegions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#watershed_workflow.regions.addWatershedAndOutletRegions" title="Link to this definition">#</a></dt>
<dd><p>Add four labeled sets to m2 for each polygon:</p>
<ul class="simple">
<li><p>cells in the polygon, to be extruded</p></li>
<li><p>cells in the polygon, to be kept as faces upon extrusion</p></li>
<li><p>boundary of the polygon (edges, kept as faces)</p></li>
<li><p>outlet of the polygon (edges, kept as faces, within outlet width
of the outlet)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m2</strong> (<a class="reference internal" href="#watershed_workflow.mesh.Mesh2D" title="watershed_workflow.mesh.Mesh2D"><em>mesh.Mesh2D</em></a>) – The mesh to label.</p></li>
<li><p><strong>hucs</strong> (<em>iterable</em><em>[</em><em>shapely.Polygon</em><em>] or </em><a class="reference internal" href="geometry.html#watershed_workflow.split_hucs.SplitHUCs" title="watershed_workflow.split_hucs.SplitHUCs"><em>SplitHUCs</em></a>) – Watershed polygons.</p></li>
<li><p><strong>outlet_width</strong> (<em>float</em><em>, </em><em>optional</em>) – How wide should the outlet region be?  Note this should include
not just the river width, but more realistically the best
resolved floodplain, or 1-2 face-widths, whichever is bigger.</p></li>
<li><p><strong>exterior_outlet</strong> (<em>bool</em><em>, </em><em>optional</em>) – If true, find the outlet point that intersects the boundary and
include regions around that outlet as well.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="geometry.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Structures and Shape Manipulation</p>
      </div>
    </a>
    <a class="right-next"
       href="data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Manipulation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2019-202X, UT Battelle, Ethan Coon.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>